/*
Jmat.js

Copyright (c) 2011-2015, Lode Vandevenne
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
function Jmat(){}Jmat.add=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.add(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.add(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.add(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.add(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.sub=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.sub(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.sub(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.sub(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.sub(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.mul=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.mul(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.matrixIn_(t)?Jmat.Matrix.mulc(Jmat.Matrix.cast(t),Jmat.Complex.cast(a)):Jmat.matrixIn_(a)?Jmat.Matrix.mulc(Jmat.Matrix.cast(a),Jmat.Complex.cast(t)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.mul(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.mul(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.mul(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.div=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.div(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.matrixIn_(t)?Jmat.Matrix.divc(Jmat.Matrix.cast(t),Jmat.Complex.cast(a)):Jmat.matrixIn_(a)?Jmat.Matrix.divc(Jmat.Matrix.cast(a),Jmat.Complex.cast(t)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.div(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.div(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.div(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.eq=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.eq(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.matrixIn_(t)||Jmat.matrixIn_(a)?!1:Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.eq(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.eq(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.eq(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.near=function(t,a,r){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.near(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a),Jmat.Real.caststrict(r)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.near(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a),Jmat.Real.caststrict(r)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.eq(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.near(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Real.caststrict(r))},Jmat.relnear=function(t,a,r){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.relnear(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a),Jmat.Real.caststrict(r)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.relnear(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a),Jmat.Real.caststrict(r)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.eq(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.relnear(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Real.caststrict(r))},Jmat.isNaN=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.isNaN(Jmat.Matrix.cast(t)):Jmat.Complex.isNaN(Jmat.Complex.cast(t))},Jmat.pow=function(t,a){return Jmat.matrixIn_(t)?Jmat.Matrix.powc(Jmat.Matrix.cast(t),Jmat.Complex.cast(a)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.pow(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.Complex.pow(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.sqrt=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.sqrt(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.sqrt(Jmat.Quaternion.cast(t)):Jmat.bigIntIn_(t)?Jmat.BigInt.sqrt(Jmat.BigInt.cast(t)):Jmat.Complex.sqrt(Jmat.Complex.cast(t))},Jmat.exp=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.exp(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.exp(Jmat.Quaternion.cast(t)):Jmat.Complex.exp(Jmat.Complex.cast(t))},Jmat.log=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.log(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.log(Jmat.Quaternion.cast(t)):Jmat.Complex.log(Jmat.Complex.cast(t))},Jmat.log1p=function(t){return Jmat.Complex.log1p(Jmat.Complex.cast(t))},Jmat.expm1=function(t){return Jmat.Complex.expm1(Jmat.Complex.cast(t))},Jmat.logy=function(t,a){return Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.logy(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.Complex.logy(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.log2=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.log2(Jmat.Quaternion.cast(t)):Jmat.Complex.log2(Jmat.Complex.cast(t))},Jmat.log10=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.log10(Jmat.Quaternion.cast(t)):Jmat.Complex.log10(Jmat.Complex.cast(t))},Jmat.lambertw=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.lambertw(Jmat.Quaternion.cast(t)):Jmat.Complex.lambertw(Jmat.Complex.cast(t))},Jmat.lambertwm=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.lambertwm(Jmat.Quaternion.cast(t)):Jmat.Complex.lambertwm(Jmat.Complex.cast(t))},Jmat.lambertwb=function(t,a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.lambertwb(t,Jmat.Quaternion.cast(a)):Jmat.Complex.lambertwb(Jmat.Real.caststrict(t),Jmat.Complex.cast(a))},Jmat.tetration=function(t,a){return Jmat.Complex.tetration(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.x=function(t){return Jmat.Complex.cast(t)},Jmat.neg=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.neg(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.neg(Jmat.Quaternion.cast(t)):Jmat.Complex.neg(Jmat.Complex.cast(t))},Jmat.inv=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.inv(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.inv(Jmat.Quaternion.cast(t)):Jmat.Complex.inv(Jmat.Complex.cast(t))},Jmat.conj=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.conj(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.conj(Jmat.Quaternion.cast(t)):Jmat.Complex.conj(Jmat.Complex.cast(t))},Jmat.sin=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.sin(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.zin(Jmat.Quaternion.cast(t)):Jmat.Complex.sin(Jmat.Complex.cast(t))},Jmat.cos=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.cos(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.cos(Jmat.Quaternion.cast(t)):Jmat.Complex.cos(Jmat.Complex.cast(t))},Jmat.tan=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.tan(Jmat.Quaternion.cast(t)):Jmat.Complex.tan(Jmat.Complex.cast(t))},Jmat.asin=function(t){return Jmat.Complex.asin(Jmat.Complex.cast(t))},Jmat.acos=function(t){return Jmat.Complex.acos(Jmat.Complex.cast(t))},Jmat.atan=function(t){return Jmat.Complex.atan(Jmat.Complex.cast(t))},Jmat.atan2=function(t,a){return Jmat.Complex.atan2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.sinc=function(t){return Jmat.Complex.sinc(Jmat.Complex.cast(t))},Jmat.sinh=function(t){return Jmat.Complex.sinh(Jmat.Complex.cast(t))},Jmat.cosh=function(t){return Jmat.Complex.cosh(Jmat.Complex.cast(t))},Jmat.tanh=function(t){return Jmat.Complex.tanh(Jmat.Complex.cast(t))},Jmat.asinh=function(t){return Jmat.Complex.asinh(Jmat.Complex.cast(t))},Jmat.acosh=function(t){return Jmat.Complex.acosh(Jmat.Complex.cast(t))},Jmat.atanh=function(t){return Jmat.Complex.atanh(Jmat.Complex.cast(t))},Jmat.gamma=function(t){return Jmat.Complex.gamma(Jmat.Complex.cast(t))},Jmat.factorial=function(t){return Jmat.Complex.factorial(Jmat.Complex.cast(t))},Jmat.digamma=function(t){return Jmat.Complex.digamma(Jmat.Complex.cast(t))},Jmat.trigamma=function(t){return Jmat.Complex.trigamma(Jmat.Complex.cast(t))},Jmat.polygamma=function(t,a){return Jmat.Complex.polygamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.loggamma=function(t){return Jmat.Complex.loggamma(Jmat.Complex.cast(t))},Jmat.gamma_inv=function(t){return Jmat.Complex.gamma_inv(Jmat.Complex.cast(t))},Jmat.incgamma_lower=function(t,a){return Jmat.Complex.incgamma_lower(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.incgamma_upper=function(t,a){return Jmat.Complex.incgamma_upper(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.gamma_p=function(t,a){return Jmat.Complex.gamma_p(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.gamma_q=function(t,a){return Jmat.Complex.gamma_q(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.gamma_p_inv=function(t,a){return Jmat.Complex.gamma_p_inv(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.beta=function(t,a){return Jmat.Complex.beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.incbeta=function(t,a,r){return Jmat.Complex.incbeta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.beta_i=function(t,a,r){return Jmat.Complex.beta_i(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.beta_i_inv=function(t,a,r){return Jmat.Complex.beta_i_inv(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.re=function(t){return Jmat.Complex(Jmat.Complex.cast(t).re)},Jmat.im=function(t){return Jmat.Complex(Jmat.Complex.cast(t).im)},Jmat.abs=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.abs(Jmat.Quaternion.cast(t)):Jmat.Complex.abs(Jmat.Complex.cast(t))},Jmat.arg=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.qrg(Jmat.Quaternion.cast(t)):Jmat.Complex.arg(Jmat.Complex.cast(t))},Jmat.sign=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.sign(Jmat.Quaternion.cast(t)):Jmat.Complex.sign(Jmat.Complex.cast(t))},Jmat.csgn=function(t){return Jmat.Complex.csgn(Jmat.Complex.cast(t))},Jmat.floor=function(t){return Jmat.Complex.floor(Jmat.Complex.cast(t))},Jmat.ceil=function(t){return Jmat.Complex.ceil(Jmat.Complex.cast(t))},Jmat.round=function(t){return Jmat.Complex.round(Jmat.Complex.cast(t))},Jmat.trunc=function(t){return Jmat.Complex.trunc(Jmat.Complex.cast(t))},Jmat.frac=function(t){return Jmat.Complex.frac(Jmat.Complex.cast(t))},Jmat.fracn=function(t){return Jmat.Complex.fracn(Jmat.Complex.cast(t))},Jmat.rotate=function(t,a){return Jmat.Complex.rotate(Jmat.Complex.cast(t),Jmat.Real.caststrict(a))},Jmat.decompose=function(t,a){return Jmat.Complex.decompose(Jmat.Complex.cast(t),Jmat.Real.cast(a))},Jmat.lerp=function(t,a,r){return Jmat.Complex.lerp(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.besselj=function(t,a){return Jmat.Complex.besselj(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.bessely=function(t,a){return Jmat.Complex.bessely(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.besseli=function(t,a){return Jmat.Complex.besseli(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.besselk=function(t,a){return Jmat.Complex.besselk(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hankelh1=function(t,a){return Jmat.Complex.hankelh1(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hankelh2=function(t,a){return Jmat.Complex.hankelh2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.airy=function(t){return Jmat.Complex.airy(Jmat.Complex.cast(t))},Jmat.bairy=function(t){return Jmat.Complex.bairy(Jmat.Complex.cast(t))},Jmat.airy_deriv=function(t){return Jmat.Complex.airy_deriv(Jmat.Complex.cast(t))},Jmat.bairy_deriv=function(t){return Jmat.Complex.bairy_deriv(Jmat.Complex.cast(t))},Jmat.theta1=function(t,a){return Jmat.Complex.theta1(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.theta2=function(t,a){return Jmat.Complex.theta2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.theta3=function(t,a){return Jmat.Complex.theta3(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.theta4=function(t,a){return Jmat.Complex.theta4(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.zeta=function(t){return Jmat.Complex.zeta(Jmat.Complex.cast(t))},Jmat.eta=function(t){return Jmat.Complex.eta(Jmat.Complex.cast(t))},Jmat.lambda=function(t){return Jmat.Complex.lambda(Jmat.Complex.cast(t))},Jmat.dilog=function(t){return Jmat.Complex.dilog(Jmat.Complex.cast(t))},Jmat.trilog=function(t){return Jmat.Complex.trilog(Jmat.Complex.cast(t))},Jmat.polylog=function(t,a){return Jmat.Complex.polylog(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hurwitzzeta=function(t,a){return Jmat.Complex.hurwitzzeta(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hypergeometric0F1=function(t,a){return Jmat.Complex.hypergeometric0F1(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hypergeometric1F1=function(t,a,r){return Jmat.Complex.hypergeometric1F1(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.hypergeometric2F1=function(t,a,r,m){return Jmat.Complex.hypergeometric2F1(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r),Jmat.Complex.cast(m))},Jmat.hypergeometric=function(t,a,r){for(var m=[],e=0;e<t.length;e++)m[e]=Jmat.Complex.cast(t[e]);for(var n=[],e=0;e<a.length;e++)n[e]=Jmat.Complex.cast(a[e]);return Jmat.Complex.hypergeometric(m,n,Jmat.Complex.cast(r))},Jmat.erf=function(t){return Jmat.Complex.erf(Jmat.Complex.cast(t))},Jmat.erfc=function(t){return Jmat.Complex.erfc(Jmat.Complex.cast(t))},Jmat.erfcx=function(t){return Jmat.Complex.erfcx(Jmat.Complex.cast(t))},Jmat.erf_inv=function(t){return Jmat.Complex.erf_inv(Jmat.Complex.cast(t))},Jmat.erfc_inv=function(t){return Jmat.Complex.erfc_inv(Jmat.Complex.cast(t))},Jmat.erfi=function(t){return void 0==t.re?Jmat.Complex(Jmat.Real.erfi(t)):Jmat.Complex.erfi(Jmat.Complex.cast(t))},Jmat.dawson=function(t){return void 0==t.re?Jmat.Complex(Jmat.Real.dawson(t)):Jmat.Complex.dawson(Jmat.Complex.cast(t))},Jmat.faddeeva=function(t){return Jmat.Complex.faddeeva(Jmat.Complex.cast(t))},Jmat.pdf_uniform=function(t,a,r){return Jmat.Complex.pdf_uniform(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_uniform=function(t,a,r){return Jmat.Complex.cdf_uniform(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_uniform=function(t,a,r){return Jmat.Complex.qf_uniform(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_standardnormal=function(t){return Jmat.Complex.pdf_standardnormal(Jmat.Complex.cast(t))},Jmat.cdf_standardnormal=function(t){return Jmat.Complex.cdf_standardnormal(Jmat.Complex.cast(t))},Jmat.qf_standardnormal=function(t){return Jmat.Complex.qf_standardnormal(Jmat.Complex.cast(t))},Jmat.pdf_normal=function(t,a,r){return Jmat.Complex.pdf_normal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_normal=function(t,a,r){return Jmat.Complex.cdf_normal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_normal=function(t,a,r){return Jmat.Complex.qf_normal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_lognormal=function(t,a,r){return Jmat.Complex.pdf_lognormal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_lognormal=function(t,a,r){return Jmat.Complex.cdf_lognormal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_lognormal=function(t,a,r){return Jmat.Complex.qf_lognormal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_cauchy=function(t,a,r){return Jmat.Complex.pdf_cauchy(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_cauchy=function(t,a,r){return Jmat.Complex.cdf_cauchy(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_cauchy=function(t,a,r){return Jmat.Complex.qf_cauchy(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_studentt=function(t,a){return Jmat.Complex.pdf_studentt(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.cdf_studentt=function(t,a){return Jmat.Complex.cdf_studentt(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.qf_studentt=function(t,a){return Jmat.Complex.qf_studentt(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.pdf_chi_square=function(t,a){return Jmat.Complex.pdf_chi_square(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.cdf_chi_square=function(t,a){return Jmat.Complex.cdf_chi_square(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.qf_chi_square=function(t,a){return Jmat.Complex.qf_chi_square(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.pdf_logistic=function(t,a,r){return Jmat.Complex.pdf_logistic(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_logistic=function(t,a,r){return Jmat.Complex.cdf_logistic(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_logistic=function(t,a,r){return Jmat.Complex.qf_logistic(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_gamma=function(t,a,r){return Jmat.Complex.pdf_gamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_gamma=function(t,a,r){return Jmat.Complex.cdf_gamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_gamma=function(t,a,r){return Jmat.Complex.qf_gamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_beta=function(t,a,r){return Jmat.Complex.pdf_beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_beta=function(t,a,r){return Jmat.Complex.cdf_beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_beta=function(t,a,r){return Jmat.Complex.qf_beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_fisher=function(t,a,r){return Jmat.Complex.pdf_fisher(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_fisher=function(t,a,r){return Jmat.Complex.cdf_fisher(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_fisher=function(t,a,r){return Jmat.Complex.qf_fisher(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_weibull=function(t,a,r){return Jmat.Complex.pdf_weibull(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_weibull=function(t,a,r){return Jmat.Complex.cdf_weibull(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_weibull=function(t,a,r){return Jmat.Complex.qf_weibull(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_exponential=function(t,a){return Jmat.Complex.pdf_exponential(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.cdf_exponential=function(t,a){return Jmat.Complex.cdf_exponential(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.qf_exponential=function(t,a){return Jmat.Complex.qf_exponential(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.pdf_laplace=function(t,a,r){return Jmat.Complex.pdf_laplace(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_laplace=function(t,a,r){return Jmat.Complex.cdf_laplace(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_laplace=function(t,a,r){return Jmat.Complex.qf_laplace(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.permutation=function(t,a){return Jmat.Complex.permutation(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.binomial=function(t,a){return Jmat.Complex.binomial(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.stirling2=function(t,a){return Jmat.Complex.stirling2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.agm=function(t,a){return Jmat.Complex.agm(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.ghm=function(t,a){return Jmat.Complex.ghm(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.isPrime=function(t){return Jmat.Complex.isPrime(Jmat.Complex.cast(t))},Jmat.smallestPrimeFactor=function(t){return Jmat.Complex(Jmat.Real.smallestPrimeFactor(Jmat.Real.cast(t)))},Jmat.factorize=function(t){for(var a=Jmat.Real.factorize(Jmat.Real.caststrict(t)),r=0;r<a.length;r++)a[r]=Jmat.Complex(a[r]);return a},Jmat.eulerTotient=function(t){return Jmat.Complex(Jmat.Real.eulerTotient(Jmat.Real.caststrict(t)))},Jmat.primeCount=function(t){return Jmat.Complex(Jmat.Real.primeCount(Jmat.Real.caststrict(t)))},Jmat.nearestPrime=function(t){return Jmat.Complex(Jmat.Real.nearestPrime(Jmat.Real.cast(t)))},Jmat.nextPrime=function(t){return Jmat.Complex(Jmat.Real.nextPrime(Jmat.Real.cast(t)))},Jmat.previousPrime=function(t){return Jmat.Complex(Jmat.Real.previousPrime(Jmat.Real.cast(t)))},Jmat.gcd=function(t,a){return Jmat.Complex(Jmat.Real.gcd(Jmat.Real.caststrict(t),Jmat.Real.caststrict(a)))},Jmat.lcm=function(t,a){return Jmat.Complex(Jmat.Real.lcm(Jmat.Real.caststrict(t),Jmat.Real.caststrict(a)))},Jmat.dms=function(t){return Jmat.Complex(Jmat.Real.dms(Jmat.Real.caststrict(t)))},Jmat.dd=function(t){return Jmat.Complex(Jmat.Real.dd(Jmat.Real.caststrict(t)))},Jmat.bitneg=function(t){return Jmat.Complex.bitneg(Jmat.Complex.cast(t))},Jmat.bitand=function(t,a){return Jmat.Complex.bitand(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.bitor=function(t,a){return Jmat.Complex.bitor(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.bitxor=function(t,a){return Jmat.Complex.bitxor(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.lshift=function(t,a){return Jmat.Complex.lshift(Jmat.Complex.cast(t),Jmat.Real.caststrict(a))},Jmat.rshift=function(t,a){return Jmat.Complex.rshift(Jmat.Complex.cast(t),Jmat.Real.caststrict(a))},Jmat.mod=function(t,a){return Jmat.Complex.mod(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.rem=function(t,a){return Jmat.Complex.rem(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.wrap=function(t,a,r){return Jmat.Complex.wrap(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.clamp=function(t,a,r){return Jmat.Complex.clamp(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.minkowski=function(t){return Jmat.Complex.minkowski(Jmat.Complex.cast(t))},Jmat.eig=function(t){return Jmat.Matrix.eig(Jmat.Matrix.cast(t))},Jmat.pseudoinverse=function(t){return Jmat.Matrix.pseudoinverse(Jmat.Matrix.cast(t))},Jmat.determinant=function(t){return Jmat.Matrix.determinant(Jmat.Matrix.cast(t))},Jmat.transpose=function(t){return Jmat.Matrix.transpose(Jmat.Matrix.cast(t))},Jmat.transjugate=function(t){return Jmat.Matrix.transjugate(Jmat.Matrix.cast(t))},Jmat.trace=function(t){return Jmat.Matrix.trace(Jmat.Matrix.cast(t))},Jmat.rank=function(t){return Jmat.Matrix.rank(Jmat.Matrix.cast(t))},Jmat.adj=function(t){return Jmat.Matrix.adj(Jmat.Matrix.cast(t))},Jmat.fft=function(t){return Jmat.Matrix.fft(Jmat.Matrix.cast(t))},Jmat.ifft=function(t){return Jmat.Matrix.ifft(Jmat.Matrix.cast(t))},Jmat.solve=function(t,a){return Jmat.Matrix.solve(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a))},Jmat.dot=function(t,a){return Jmat.Matrix.dot(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a))},Jmat.cross=function(t,a){return Jmat.Matrix.cross(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a))},Jmat.minor=function(t,a,r){return Jmat.Matrix.minor(Jmat.Matrix.cast(t),Jmat.Real.caststrict(a),Jmat.Real.caststrict(r))},Jmat.cofactor=function(t,a,r){return Jmat.Matrix.cofactor(Jmat.Matrix.cast(t),Jmat.Real.caststrict(a),Jmat.Real.caststrict(r))},Jmat.submatrix=function(t,a,r,m,e){return Jmat.Matrix.submatrix(Jmat.Matrix.cast(t),Jmat.Real.caststrict(a),Jmat.Real.caststrict(r),Jmat.Real.caststrict(m),Jmat.Real.caststrict(e))},Jmat.svd=function(t){return Jmat.Matrix.svd(Jmat.Matrix.cast(t))},Jmat.evd=function(t){return Jmat.Matrix.evd(Jmat.Matrix.cast(t))},Jmat.qr=function(t){return Jmat.Matrix.qr(Jmat.Matrix.cast(t))},Jmat.norm=function(t){return Jmat.Matrix.norm(Jmat.Matrix.cast(t))},Jmat.norm2=function(t){return Jmat.Matrix.norm2(Jmat.Matrix.cast(t))},Jmat.maxcolnorm=function(t){return Jmat.Matrix.maxcolnorm(Jmat.Matrix.cast(t))},Jmat.maxrownorm=function(t){return Jmat.Matrix.maxrownorm(Jmat.Matrix.cast(t))},Jmat.differentiate=function(t,a){return Jmat.Complex.differentiate(Jmat.Complex.cast(t),a)},Jmat.integrate=function(t,a,r,m){return Jmat.Complex.integrate(Jmat.Complex.cast(t),Jmat.Complex.cast(a),r,Jmat.Real.caststrict(m))},Jmat.rootfind_newton=function(t,a,r,m){return Jmat.Complex.rootfind_newton(t,a,Jmat.Complex.cast(r),Jmat.Real.caststrict(m))},Jmat.rootfind_newton_noderiv=function(t,a,r){return Jmat.Complex.rootfind_newton_noderiv(t,Jmat.Complex.cast(a),Jmat.Real.caststrict(r))},Jmat.matrixIn_=function(t){return t?"string"==typeof t?t.length<2?!1:"["==t[0]?!0:"-"==t[0]?!1:t.charCodeAt(0)>=48&&t.charCodeAt(0)<=57?!1:-1!=t.indexOf("["):t&&(t instanceof Jmat.Matrix||void 0!=t.length):!1},Jmat.quaternionIn_=function(t){return t?"string"==typeof t&&(t.indexOf("j")>=0||t.indexOf("k")>=0)?!0:t&&t instanceof Jmat.Quaternion:!1},Jmat.bigIntIn_=function(t){return t?"string"==typeof t&&t.length>16&&-1==t.indexOf(".")&&-1==t.indexOf("e")&&-1==t.indexOf("E")?!0:t&&t instanceof Jmat.BigInt:!1},Jmat.toString=function(t){if(!t)return""+t;var a="";if("object"==typeof t&&Array.isArray(t)){a+="[";for(var r=0;r<t.length;r++)a+=Jmat.toString(t[r])+(r+1==t.length?"":", ");return a+="]"}if(t.constructor==Object){a+="{";var m=!1;for(var e in t)e&&t[e]&&(m&&(a+=", "),a+=e+": ",a+=Jmat.toString(t[e]),m=!0);return a+="}"}return a=t.toString?t.toString():""+t},Jmat.Real=function(){},Jmat.Real.cast=function(t){return t&&void 0!=t.re?t.re:void 0==t?0:t},Jmat.Real.caststrict=function(t){return t&&void 0!=t.re?0==t.im?t.re:NaN:void 0==t?0:t},Jmat.Real.SQRT2=Math.sqrt(2),Jmat.Real.SQRTPI=Math.sqrt(Math.PI),Jmat.Real.EM=.5772156649015329,Jmat.Real.APERY=1.2020569,Jmat.Real.BIGGESTJSINT=9007199254740992,Jmat.Real.isInt=function(t){return t==Math.floor(t)},Jmat.Real.isPositiveInt=function(t){return t==Math.floor(t)&&t>0},Jmat.Real.isNegativeInt=function(t){return t==Math.floor(t)&&0>t},Jmat.Real.isPositiveIntOrZero=function(t){return t==Math.floor(t)&&t>=0},Jmat.Real.isNegativeIntOrZero=function(t){return t==Math.floor(t)&&0>=t},Jmat.Real.isOdd=function(t){return 1==Math.abs(t%2)},Jmat.Real.isEven=function(t){return t%2==0},Jmat.Real.isPOT=function(t){return 0!=t&&0==(t&t-1)},Jmat.Real.isInfOrNaN=function(t){return t==1/0||t==-(1/0)||isNaN(t)},Jmat.Real.dist=function(t,a){return Math.abs(t-a)},Jmat.Real.mod=function(t,a){return t-Math.floor(t/a)*a},Jmat.Real.rem=function(t,a){return t%a},Jmat.Real.wrap=function(t,a,r){if(a==r)return a;var m=Math.min(a,r),e=Math.max(a,r);return m+Jmat.Real.mod(t-m,e-m)},Jmat.Real.clamp=function(t,a,r){var m=Math.min(a,r),e=Math.max(a,r);return Math.max(m,Math.min(e,t))},Jmat.Real.idiv=function(t,a){return Math.floor(t/a)},Jmat.Real.gamma=function(t){if(t==1/0)return 1/0;if(Jmat.Real.useFactorialLoop_(t-1))return Jmat.Real.factorial(t-1);if(.5==t)return Jmat.Real.SQRTPI;var a=function(t){if(0>=t&&t==Math.round(t))return 1/0;if(.5>t)return Math.PI/(Math.sin(Math.PI*t)*a(1-t));var r=7,m=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];t-=1;for(var e=m[0],n=1;r+2>n;n++)e+=m[n]/(t+n);var i=t+r+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,t+.5)*Math.exp(-i)*e};return a(t)},Jmat.Real.factorialmem_=[1],Jmat.Real.useFactorialLoop_=function(t){return Jmat.Real.isPositiveIntOrZero(t)&&200>t},Jmat.Real.factorial=function(t){if(!Jmat.Real.useFactorialLoop_(t))return Jmat.Real.gamma(t+1);if(Jmat.Real.factorialmem_[t])return Jmat.Real.factorialmem_[t];for(var a=Jmat.Real.factorialmem_[Jmat.Real.factorialmem_.length-1],r=Jmat.Real.factorialmem_.length;t>=r;r++)a*=r,Jmat.Real.factorialmem_[r]=a;return a},Jmat.Real.isPowerOf=function(t,a){var r=Jmat.Real;if(t==a)return 1;if(0>=a)return 0;if(0>=t)return 0;if(1==t)return 0;if(a>t)return 0;if(r.isPOT(t)&&r.isPOT(a)){var m=r.ilog2(t),e=r.ilog2(a);return m%e==0?m/e:0}if(r.isPOT(t)!=r.isPOT(a))return 0;if(r.isEven(t)!=r.isEven(a))return 0;for(var n=a,i=[],o=a,l=1;t>n;){if(i.push(o),n*=o,l*=2,n==t)return l;o*=o}if(n==1/0)return 0;for(;i.length>0;){var u=i.pop();if(n>t?(n/=u,l-=1<<i.length):(n*=u,l+=1<<i.length),n==t)return l}return 0},Jmat.Real.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],Jmat.Real.isPrimeInit_=function(t){if(t==1/0||t!=t)return NaN;if(t!=Math.round(t))return 0;if(2>t)return 0;if(t>Jmat.Real.BIGGESTJSINT)return NaN;for(var a=0;a<Jmat.Real.firstPrimes_.length;a++){if(t==Jmat.Real.firstPrimes_[a])return 1;if(t%Jmat.Real.firstPrimes_[a]==0)return 0}return-1},Jmat.Real.isPrimeSlow_=function(t){var a=Jmat.Real.isPrimeInit_(t);if(-1!=a)return a;var r=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1],m=Math.ceil(Math.sqrt(t))+6;for(r=6*Math.floor(r/6);m>r;){if(t%(r-1)==0||t%(r+1)==0)return 0;r+=6}return 1},Jmat.Real.isPrimeMillerRabin_=function(t){var a=Jmat.Real.isPrimeInit_(t);if(-1!=a)return a;var r;r=1373653>t?[2,3]:9080191>t?[31,73]:4759123141>t?[2,7,61]:1122004669633>t?[2,13,23,1662803]:2152302898747>t?[2,3,5,7,11]:3474749660383>t?[2,3,5,7,11,13]:341550071728321>t?[2,3,5,7,11,13,17]:0xd655278977733>t?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022];for(var m=Math.floor(t/2),e=1;!(1&m);)m=Math.floor(m/2),++e;for(var n=function(t,a,r){return t+a<Jmat.Real.BIGGESTJSINT?(t+a)%r:t+a>r?(t-r+a)%r:(t%r+a%r)%r},i=function(t,a,r){if(t*a<Jmat.Real.BIGGESTJSINT)return t*a%r;for(var m=0,e=t%r;a>0;)1&a&&(m=n(m,e,r)),e=n(e,e,r),a=Math.floor(a/2);return m%r},o=function(t,a,r){for(var m=1;a>0;)1&a&&(m=i(m,t,r)),t=i(t,t,r),a=Math.floor(a/2);return m},l=function(t,a,r,m){for(var e=o(m,r,t);a;){var n=i(e,e,t);if(1==n&&1!=e&&e!=t-1)return!1;e=n,a--}return 1==n},u=0;u<r.length;u++)if(!l(t,e,m,r[u]))return 0;return 1},Jmat.Real.isPrime=function(t){return 15e5>t?Jmat.Real.isPrimeSlow_(t):Jmat.Real.isPrimeMillerRabin_(t)},Jmat.Real.eratosthenes=function(t){if(2>t)return[];for(var a=[2],r=[],m=Math.floor(Math.sqrt(t)),e=Math.ceil(t/2),n=0;e>n;n++)r[n]=!0;for(var i=3;m>=i;i+=2){var n=Math.floor(i/2);if(r[n])for(var o=n+i;e>o;o+=i)r[o]=!1}for(var n=1;t>=n;n++)r[n]&&a.push(2*n+1);return a},Jmat.Real.smallestPrimeFactor=function(t){if(t==1/0||t!=t)return NaN;if(t!=Math.round(t))return NaN;if(1>t)return NaN;if(t>Jmat.Real.BIGGESTJSINT)return NaN;if(1==t)return 1;for(var a=0;a<Jmat.Real.firstPrimes_.length;a++){if(t==Jmat.Real.firstPrimes_[a])return t;if(t%Jmat.Real.firstPrimes_[a]==0)return Jmat.Real.firstPrimes_[a]}var r=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1],m=Math.ceil(Math.sqrt(t));for(r=6*Math.floor(r/6);m>r;){if(t%(r-1)==0)return r-1;if(t%(r+1)==0)return r+1;r+=6}return t},Jmat.Real.factorize=function(t){if(t>Jmat.Real.BIGGESTJSINT)return void 0;for(var t=Math.round(t),a=[];!(1>t);){var r=Jmat.Real.smallestPrimeFactor(t);if(a.push(r),t==r)break;t=Math.round(t/r)}return a},Jmat.Real.primeCount=function(t){var a=[0,2,3,5,7,11,13,17],r=function(t){if(t<a.length)return a[t];for(var r=a[a.length-1]+2,m=a.length-1;;){if(Jmat.Real.isPrime(r)&&(a.push(r),m++,m==t))return r;r+=2}},m={},e=function(t,a){if(0==a)return Math.floor(t);if(1==a)return Math.floor((t+1)/2);if(m[t]&&void 0!=m[t][a])return m[t][a];var n=e(t,a-1)-e(Math.floor(t/r(a)),a-1);return m[t]||(m[t]={}),m[t][a]=n,n},n={},i=function(t){if(t>1e9)return NaN;if(2>t)return 0;if(3>t)return 1;if(5>t)return 2;var a=Math.floor(t);if(n[a])return n[a];for(var m=Math.floor(i(Math.pow(t,.25))),o=Math.floor(i(Math.sqrt(t))),l=Math.floor(i(Math.pow(t,1/3))),u=e(a,m)+Math.floor((o+m-2)*(o-m+1)/2),J=m+1;o>=J;J++){var p=a/r(J);if(u-=i(p),l>=J)for(var s=i(Math.sqrt(p)),x=J;s>=x;x++)u-=i(p/r(x))-x+1}return n[a]=u,u};return i(t)},Jmat.Real.nearestPrime=function(t){var a=Math.round(t);if(7>a)return 2>=a?2:4>=a?3:5;if(a==1/0||a!=a)return NaN;if(a>=9007199254740881)return NaN;if(Jmat.Real.isPrime(a))return a;for(var r=a%6,m=6-r,e=0,n=0;;){if(Jmat.Real.isPrime(a-e-r+1)?n=a-e-r+1:Jmat.Real.isPrime(a-e-r-1)&&(n=a-e-r-1),(!n||a-n>e+m-1)&&Jmat.Real.isPrime(a+e+m-1)?n=a+e+m-1:(!n||a-n>e+m+1)&&Jmat.Real.isPrime(a+e+m+1)&&(n=a+e+m+1),n)return n;e+=6}},Jmat.Real.nextPrime=function(t){var a=Math.floor(t);if(2>a)return 2;if(3>a)return 3;if(a==1/0||a!=a)return NaN;if(a>=9007199254740881)return NaN;var r=a%6,m=2;for(0==r||5==r?(a+=0==r?1:2,m=4):a+=5-r;;){if(Jmat.Real.isPrime(a))return a;a+=m,m^=6}},Jmat.Real.previousPrime=function(t){var a=Math.ceil(t);if(2>=a)return NaN;if(3>=a)return 2;if(5>=a)return 3;if(7>=a)return 5;if(a==1/0||a!=a)return NaN;if(a>Jmat.Real.BIGGESTJSINT)return NaN;var r=a%6,m=2;for(0==r||1==r?(a-=r+1,m=4):a-=r-1;;){if(Jmat.Real.isPrime(a))return a;a-=m,m^=6}},Jmat.Real.eulerTotient=function(t){
if(0>=t)return NaN;for(var a=Math.floor(t),r=Jmat.Real.factorize(a),m=-1,e=a,n=0;n<r.length;n++)if(m!=r[n]){if(1==r[n])break;m=r[n],e*=1-1/r[n]}return e},Jmat.Real.pascal_triangle_cache_=[[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1],[1,7,21,35,35,21,7,1]],Jmat.Real.pascal_triangle=function(t,a){if(0>t||0>a||a>t)return NaN;if(t>180)return NaN;for(var r=Jmat.Real.pascal_triangle_cache_;r.length<=t;){var m=r.length,e=m+1;r[m]=[];for(var n=0;e>n;n++)r[m][n]=0==n||n==e-1?1:r[m-1][n-1]+r[m-1][n]}return r[t][a]},Jmat.Real.gcd=function(t,a){if(!Jmat.Real.isInt(t)||!Jmat.Real.isInt(a))return NaN;for(;;){if(0==a)return Math.abs(t);var r=Jmat.Real.mod(t,a);t=a,a=r}},Jmat.Real.lcm=function(t,a){return Math.abs(t*a)/Jmat.Real.gcd(t,a)},Jmat.Real.decompose=function(t,a){a||(a=1e5);var r=0>t;r&&(t=-t);var m=Math.floor(t),e=t-m;if(0==e)return[t,1];for(var n,i=0,o=1,l=1,u=1;a>=o&&a>=u;){var J=(i+l)/(o+u);if(e==J){n=a>=o+u?[i+l,o+u]:u>o?[l,u]:[i,o];break}e>J?(i+=l,o+=u):(l=i+l,u=o+u)}return n||(n=o>a?[l,u]:[i,o]),n[0]+=m*n[1],r&&(n[0]=-n[0]),n},Jmat.Real.decomposeSemiFast=function(t,a){var r=1e3;if(r>a)return Jmat.Real.decompose(t,a);var m=Jmat.Real.decompose(t,r),e=m[0]/m[1];if(e==t)return m;var n=Jmat.Real.decomposeFast(t,r),i=n[0]/n[1];return Math.abs(t-e)<Math.abs(t-i)?m:n},Jmat.Real.decomposeFast=function(t,a){a||(a=1e5);var r=a-1;if(r>=t&&t>=-r&&(-1/r>t||t>1/r)){var m=0>t;m&&(t=-t);var e=Math.floor(t),n=t-e,i=a;n=Math.floor(n*i);var o=Jmat.Real.gcd(n,i);return i/=o,n/=o,n+=e*i,m&&(n=-n),[n,i]}return[t,1]},Jmat.Real.near=function(t,a,r){return t>=a-r&&a+r>=t},Jmat.Real.relnear=function(t,a,r){if(t==a)return!0;if(0==t||0==a)return!1;if(0>t!=0>a)return!1;t=Math.abs(t),a=Math.abs(a);var m=t>a?t/a:a/t;return 1+r>m},Jmat.Real.frac=function(t){return t-Math.floor(t)},Jmat.Real.fracn=function(t){return t>0?t-Math.floor(t):-(-t-Math.floor(-t))},Jmat.Real.lambertw=function(t){if(isNaN(t))return NaN;if(t==1/0||t==-(1/0))return 1/0;if(t>=-1/Math.E&&703>=t){for(var a=10>t?0:Math.log(t)-Math.log(Math.log(t)),r=Math.max(30,t>0?10+Math.floor(t):30),m=0;r>m;m++){var e=Math.exp(a);a-=(a*e-t)/(e+a*e)}return a}if(t>0)for(var n=1,i=0,o=Math.log(t)-Math.log(Math.log(t));;){if(0==n||.5*n==n||o+n==o)return o;var l=o*Math.exp(o);if(Jmat.Real.near(l,t,1e-15))return o;l>t?(o-=n,-1==i&&(n*=.5),i=1):(o+=n,1==i&&(n*=.5),i=-1)}return NaN},Jmat.Real.tetration=function(t,a){if(0==a)return 1;if(1==a)return t;if(2==a)return Math.pow(t,t);if(t>=2&&a>5)return 1/0;if(0==t&&Jmat.Real.isPositiveInt(a))return Jmat.Complex.isEven(a)?1:0;if(a==1/0&&t>0){var r=Math.log(t);return Jmat.Real.lambertw(-r)/-r}var m=function(t,a,r,m){for(var e,n=a,i=0;r>i;i++){if(n=m?Jmat.Real.logy(n,t):Math.pow(t,n),isNaN(n))return n;if(n==1/0)return n;if(n==e)return n;if(e=n,i>1e3)return NaN}return n};if(Jmat.Real.isPositiveInt(a))return m(t,t,a-1,!1);if(a>-1&&0>=a)return 1+a;if(a>0){var e=a-Math.floor(a);return m(t,e,Math.ceil(a),!1)}if(-1>=a){var e=a-Math.floor(a);return m(t,e,-Math.ceil(a),!0)}return NaN},Jmat.Real.logy=function(t,a){return Math.log(t)/Math.log(a)},Jmat.Real.clz32=Math.clz32||function(t){for(var a=0;t>0;)t=Math.floor(t/2),a++;return 32-a},Jmat.Real.log2=Math.log2||function(t){return Math.log(t)/Math.LN2},Jmat.Real.ilog2=function(t){return 0>=t?NaN:2147483648>t?31-Jmat.Real.clz32(t):Math.floor(Jmat.Real.log2(Math.floor(t)+.5))},Jmat.Real.getNumBits=function(t){return Jmat.Real.ilog2(Math.abs(t))+1},Jmat.Real.log10=Math.log10||function(t){return Math.log(t)/Math.LN10},Jmat.Real.root=function(t,a){return Math.pow(t,1/a)},Jmat.Real.dawson=function(t){var a=t*t,r=a*a,m=r*a,e=m*a,n=e*a,i=n*a,o=.1049934947,l=.0424060604,u=.0072644182,J=.0005064034,p=.0001789971,s=.7715471019,x=.2909738639,f=.0694555761,c=.0140005442,C=.0008327945,d=1+o*a+l*r+u*m+J*e+p*n,g=1+s*a+x*r+f*m+c*e+C*n+2*p*i;return d/g*t},Jmat.Real.erfi=function(t){var a=!1;0>t&&(t=-t,a=!0);var r=0,m=1/Jmat.Real.SQRTPI;if(.5>=t){var e=t*t*t,n=e*t*t,i=n*t*t,o=2*t+2/3*e+.2*n+1/21*i;r=m*o}else if(t>=5){var l=1/t,u=l*l*l,J=u*l*l,p=J*l*l,s=Math.exp(t*t),o=l+.5*u+.75*J+15/8*p;r=m*s*o}else r=2/Jmat.Real.SQRTPI*Math.exp(t*t)*Jmat.Real.dawson(t);return a&&(r=-r),r},Jmat.Real.erf=function(t){var a=0>t;if(a&&(t=-t),0==t)return 0;var r=1/(1+.3275911*t),m=r*(.254829592+r*(-.284496736+r*(1.421413741+r*(-1.453152027+1.061405429*r)))),e=1-m*Math.exp(-(t*t));return a&&(e=-e),e},Jmat.Real.erfc=function(t){var a=0>t;a&&(t=-t);var r;if(.5>=t){var m=t*t,e=t*m,n=e*m,i=n*m;r=1-2/Jmat.Real.SQRTPI*(t-e/3+n/10+i/42)}else if(t>=5){var m=t*t,o=m*m,l=o*m,u=l*m;r=Math.exp(-(t*t))/(t*Jmat.Real.SQRTPI)*(1-.5/m+.75/o-15/8/l+6.5625/u)}else{var J=1/(1+.3275911*t),p=J*(.254829592+J*(-.284496736+J*(1.421413741+J*(-1.453152027+1.061405429*J))));r=p*Math.exp(-(t*t))}return a&&(r=2-r),r},Jmat.Real.minkowski=function(t){if(t!=t)return NaN;var a,r,m=Math.floor(t),e=1,n=m+1,i=1,o=1,l=m;if(m>t||0>m!=0>=n)return t;for(;(o/=2,l+o!=l)&&(a=m+n,0>a==0>m)&&(r=e+i,!(0>r));)a/r>t?(n=a,i=r):(l+=o,m=a,e=r);return l+o},Jmat.Real.dms=function(t){var a=0>t;a&&(t=-t);var r=Math.floor(t),m=Math.floor(60*t-60*r),e=Math.floor(3600*t-3600*r-60*m),n=r+m/100+e/1e4;return a&&(n=-n),n},Jmat.Real.dd=function(t){var a=0>t;a&&(t=-t);var r=Math.floor(t),m=Math.floor(100*t-100*r),e=Math.floor(1e4*t-1e4*r-100*m),n=r+m/60+e/3600;return a&&(n=-n),n},Jmat.Real.round=function(t){var a=Math.floor(t),r=t-a;return.5==r?a%2==0?a:a+1:.5>r?a:a+1},Jmat.Real.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)},Jmat.Real.lerp=function(t,a,r){return(1-r)*t+r*a},Jmat.Real.sinh=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2},Jmat.Real.cosh=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2},Jmat.Real.tanh=Math.tanh||function(t){return(Math.exp(2*t)-1)/(Math.exp(2*t)+1)},Jmat.Real.asinh=Math.asinh||function(t){return t==-(1/0)?t:Math.log(t+Math.sqrt(t*t+1))},Jmat.Real.acosh=Math.acosh||function(t){return Math.log(t+Math.sqrt(t*t-1))},Jmat.Real.atanh=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},Jmat.Real.abs=Math.abs,Jmat.Real.floor=Math.floor,Jmat.Real.ceil=Math.ceil,Jmat.Real.min=Math.min,Jmat.Real.max=Math.max,Jmat.Real.exp=Math.exp,Jmat.Real.log=Math.log,Jmat.Real.sqrt=Math.sqrt,Jmat.Real.pow=Math.pow,Jmat.Real.sin=Math.sin,Jmat.Real.cos=Math.cos,Jmat.Real.tan=Math.tan,Jmat.Real.asin=Math.asin,Jmat.Real.acos=Math.acos,Jmat.Real.atan=Math.atan,Jmat.Real.atan2=Math.atan2,Jmat.Real.isLeapYear=function(t){return t%400==0||t%4==0&&t%100!=0},Jmat.Real.montharray_=[-1,31,28,31,30,31,30,31,31,30,31,30,31],Jmat.Real.monthLength=function(t,a){return a&&2==t?29:Jmat.Real.montharray_[t]},Jmat.Real.numDaysSince0=function(t,a,r){var m=Jmat.Real,e=0==t?0:m.idiv(t-1,4)-m.idiv(t-1,100)+m.idiv(t-1,400)+1,n=365*t+e,i=a>2?Jmat.Real.isLeapYear(t)?1:2:0,o=a>8&&a%2==1?1:0,l=30*(a-1)+m.idiv(a,2)-i+o;return n+l+r-1},Jmat.Real.daysSince0ToDate=function(t){var a=Math.floor(t/365.2425),r=Jmat.Real.isLeapYear(a);t-=Jmat.Real.numDaysSince0(a,1,1);for(var m=0,e=1;12>=e;e++){m++;var n=Jmat.Real.monthLength(e,r);if(!(t>=n))break;t-=n}return[a,m,t+1]},Jmat.Real.dayOfWeek=function(t,a,r){var m=Jmat.Real;return r+=3>a?t--:t-2,(m.idiv(23*a,9)+r+4+m.idiv(t,4)-m.idiv(t,100)+m.idiv(t,400))%7},Jmat.Complex=function(t,a){return this instanceof Jmat.Complex?(this.re=t,void(this.im=a)):Jmat.Complex.make(t,a)},Jmat.Complex.make=function(t,a){return void 0==t?new Jmat.Complex(0,0):"number"==typeof t?new Jmat.Complex(t,void 0==a?0:a):"string"==typeof t?Jmat.Complex.parse(t):new Jmat.Complex(t.re,t.im)},Jmat.Complex.newr=function(t){return new Jmat.Complex(t,0)},Jmat.Complex.newi=function(t){return new Jmat.Complex(0,t)},Jmat.Complex.polar=function(t,a){return new Jmat.Complex(t*Math.cos(a),t*Math.sin(a))},Jmat.Complex.cast=function(t){return t&&void 0!=t.re?t:void 0==t?Jmat.Complex(0):Jmat.Complex(t)},Jmat.Complex.copy=function(t){return new Jmat.Complex(t.re,t.im)},Jmat.Complex.formatFloat_=function(t,a){var r=Math.pow(10,a||0);return String(Math.round(t*r)/r)},Jmat.Complex.toString=function(t,a){if(!t)return 0==t?"invalid0":""+t;var r=a?Jmat.Complex.formatFloat_(t.re,a):""+t.re,m=a?Jmat.Complex.formatFloat_(t.im,a):""+t.im;return 0==t.im||"0"==m?""+r:0==t.re?""+m+"i":t.im<0?""+r+m+"i":""+r+"+"+m+"i"},Jmat.Complex.prototype.toString=function(t){return Jmat.Complex.toString(this,t)},Jmat.Complex.parse=function(t){var a=t.indexOf("i");if(-1==a)return Jmat.Complex(parseFloat(t));if("i"==t)return Jmat.Complex(0,1);t=t.substr(0,a),t=t.replace(/ /g,""),("+"==t[a-1]||"-"==t[a-1])&&(t+="1");for(var r=1;r<t.length;r++)if(("+"==t[r]||"-"==t[r])&&"e"!=t[r-1]&&"E"!=t[r-1])return Jmat.Complex(parseFloat(t.substr(0,r)),parseFloat(t.substr(r)));return Jmat.Complex(0,parseFloat(t))},Jmat.Complex.ZERO=Jmat.Complex(0),Jmat.Complex.ONE=Jmat.Complex(1),Jmat.Complex.TWO=Jmat.Complex(2),Jmat.Complex.I=Jmat.Complex.newi(1),Jmat.Complex.PI=Jmat.Complex(Math.PI),Jmat.Complex.E=Jmat.Complex(Math.E),Jmat.Complex.SQRT2=Jmat.Complex(Math.sqrt(2)),Jmat.Complex.SQRTPI=Jmat.Complex(Math.sqrt(Math.PI)),Jmat.Complex.INVSQRT2PI=Jmat.Complex(1/Math.sqrt(2*Math.PI)),Jmat.Complex.EM=Jmat.Complex(Jmat.Real.EM),Jmat.Complex.APERY=Jmat.Complex(Jmat.Real.APERY),Jmat.Complex.real=function(t){return Jmat.Complex(t.re)},Jmat.Complex.prototype.real=function(){return Jmat.Complex(this.re)},Jmat.Complex.imag=function(t){return Jmat.Complex(t.im)},Jmat.Complex.prototype.imag=function(){return Jmat.Complex(this.im)},Jmat.Complex.add=function(t,a){return new Jmat.Complex(t.re+a.re,t.im+a.im)},Jmat.Complex.prototype.add=function(t){return new Jmat.Complex(this.re+t.re,this.im+t.im)},Jmat.Complex.sub=function(t,a){return new Jmat.Complex(t.re-a.re,t.im-a.im)},Jmat.Complex.prototype.sub=function(t){return new Jmat.Complex(this.re-t.re,this.im-t.im)},Jmat.Complex.mul=function(t,a){if(0==t.im&&0==a.im)return new Jmat.Complex(t.re*a.re,0);var r=t.re*a.re-t.im*a.im,m=t.im*a.re+t.re*a.im;return new Jmat.Complex(r,m)},Jmat.Complex.prototype.mul=function(t){return Jmat.Complex.mul(this,t)},Jmat.Complex.div=function(t,a){if(0==t.im&&0==a.im)return new Jmat.Complex(t.re/a.re,0);if(Jmat.Complex.isInf(t)&&!Jmat.Complex.isInfOrNaN(a))return t;var r=a.re*a.re+a.im*a.im;if((r==1/0||r==-(1/0))&&!Jmat.Complex.isInfOrNaN(t))return Jmat.Complex(0);if(0==r&&!Jmat.Complex.isInfOrNaN(t)&&(0!=t.re||0!=t.im))return new Jmat.Complex(0==t.re?0:t.re<0?-(1/0):1/0,0==t.im?0:t.im<0?-(1/0):1/0);var m=(t.re*a.re+t.im*a.im)/r,e=(t.im*a.re-t.re*a.im)/r;return new Jmat.Complex(m,e)},Jmat.Complex.prototype.div=function(t){return Jmat.Complex.div(this,t)},Jmat.Complex.addr=function(t,a){return new Jmat.Complex(t.re+a,t.im)},Jmat.Complex.prototype.addr=function(t){return new Jmat.Complex(this.re+t,this.im)},Jmat.Complex.subr=function(t,a){return new Jmat.Complex(t.re-a,t.im)},Jmat.Complex.prototype.subr=function(t){return new Jmat.Complex(this.re-t,this.im)},Jmat.Complex.rsub=function(t,a){return new Jmat.Complex(t-a.re,-a.im)},Jmat.Complex.prototype.rsub=function(t){return new Jmat.Complex(t-this.re,-this.im)},Jmat.Complex.mulr=function(t,a){return new Jmat.Complex(t.re*a,t.im*a)},Jmat.Complex.prototype.mulr=function(t){return new Jmat.Complex(this.re*t,this.im*t)},Jmat.Complex.muli=function(t,a){return new Jmat.Complex(-t.im*a,t.re*a)},Jmat.Complex.prototype.muli=function(t){return new Jmat.Complex(-this.im*t,this.re*t)},Jmat.Complex.divr=function(t,a){return new Jmat.Complex(t.re/a,t.im/a)},Jmat.Complex.prototype.divr=function(t){return new Jmat.Complex(this.re/t,this.im/t)},Jmat.Complex.rdiv=function(t,a){return new Jmat.Complex.div(Jmat.Complex(t),a)},Jmat.Complex.prototype.rdiv=function(t){return Jmat.Complex.div(Jmat.Complex(t),this)},Jmat.Complex.divi=function(t,a){return new Jmat.Complex(t.im/a,-t.re/a)},Jmat.Complex.prototype.divi=function(t){return new Jmat.Complex(this.im/t,-this.re/t)},Jmat.Complex.rotate=function(t,a){return 0==a?t:Jmat.Complex.polar(t.abs(),t.arg()+a)},Jmat.Complex.nextroot=function(t,a){var r=Jmat.Complex.rotate(t,2*Math.PI/a);return Jmat.Real.near(r.im,0,1e-14)&&(r.im=0),r},Jmat.Complex.mod=function(t,a){return 0!=t.im||0!=a.im?t.sub(Jmat.Complex.floor(t.div(a)).mul(a)):Jmat.Complex(Jmat.Real.mod(t.re,a.re))},Jmat.Complex.rem=function(t,a){return 0!=t.im||0!=a.im?t.sub(Jmat.Complex.trunc(t.div(a)).mul(a)):Jmat.Complex(t.re%a.re)},Jmat.Complex.wrap=function(t,a,r){return new Jmat.Complex(Jmat.Real.wrap(t.re,a.re,r.re),Jmat.Real.wrap(t.im,a.im,r.im))},Jmat.Complex.clamp=function(t,a,r){return new Jmat.Complex(Jmat.Real.clamp(t.re,a.re,r.re),Jmat.Real.clamp(t.im,a.im,r.im))},Jmat.Complex.bitneg=function(t){var a=Jmat.Complex(0);return a.re=~t.re,a.im=-t.im,a},Jmat.Complex.bitand=function(t,a){var r=Jmat.Complex(0);return r.re=t.re&a.re,r.im=t.im&a.im,r},Jmat.Complex.bitor=function(t,a){var r=Jmat.Complex(0);return r.re=t.re|a.re,r.im=t.im|a.im,r},Jmat.Complex.bitxor=function(t,a){var r=Jmat.Complex(0);return r.re=t.re^a.re,r.im=t.im^a.im,r},Jmat.Complex.lshift=function(t,a){var r=Jmat.Complex(0);return r.re=t.re<<a.re,r.im=t.im<<a.im,r},Jmat.Complex.rshift=function(t,a){var r=Jmat.Complex(0);return r.re=t.re>>a.re,r.im=t.im>>a.im,r},Jmat.Complex.neg=function(t){return Jmat.Complex(-t.re,-t.im)},Jmat.Complex.prototype.neg=function(){return Jmat.Complex(-this.re,-this.im)},Jmat.Complex.sign=function(t){return 0==t.im?0==t.re?Jmat.Complex(0):t.re<0?Jmat.Complex(-1):Jmat.Complex(1):t.divr(t.abs())},Jmat.Complex.csgn=function(t){return Jmat.Real.near(t.re,0,1e-15)?0==t.im?Jmat.Complex(0):t.im<0?Jmat.Complex(-1):Jmat.Complex(1):0==t.re?Jmat.Complex(0):t.re<0?Jmat.Complex(-1):Jmat.Complex(1)},Jmat.Complex.conj=function(t){return Jmat.Complex(t.re,-t.im)},Jmat.Complex.prototype.conj=function(){return Jmat.Complex(this.re,-this.im)},Jmat.Complex.eq=function(t,a){return t&&a?t.re==a.re&&t.im==a.im:t==a},Jmat.Complex.prototype.eq=function(t){return t&&this.re==t.re&&this.im==t.im},Jmat.Complex.eqr=function(t,a){return t.re==a&&0==t.im},Jmat.Complex.prototype.eqr=function(t){return this.re==t&&0==this.im},Jmat.Complex.powr=function(t,a){return Jmat.Complex.pow(t,Jmat.Complex(a))},Jmat.Complex.prototype.powr=function(t){return Jmat.Complex.pow(this,Jmat.Complex(t))},Jmat.Complex.inv=function(t){return Jmat.Complex.ONE.div(t)},Jmat.Complex.prototype.inv=function(){return Jmat.Complex.ONE.div(this)},Jmat.Complex.inc=function(t){return new Jmat.Complex(t.re+1,t.im)},Jmat.Complex.prototype.inc=function(){return new Jmat.Complex(this.re+1,this.im)},Jmat.Complex.dec=function(t){return new Jmat.Complex(t.re-1,t.im)},Jmat.Complex.prototype.dec=function(){return new Jmat.Complex(this.re-1,this.im)},Jmat.Complex.abs=function(t){return Jmat.Complex(t.abs())},Jmat.Complex.prototype.abs=function(){if(0==this.im)return Math.abs(this.re);if(0==this.re)return Math.abs(this.im);if(this.re==1/0||this.re==-(1/0)||this.im==1/0||this.im==-(1/0))return 1/0;var t=function(t){return t*t},a=Math.abs(this.re),r=Math.abs(this.im);return a>r?a*Math.sqrt(1+t(this.im/this.re)):0==this.im?0:r*Math.sqrt(1+t(this.re/this.im))},Jmat.Complex.abssq=function(t){return Jmat.Complex(t.re*t.re+t.im*t.im)},Jmat.Complex.prototype.abssq=function(){return this.re*this.re+this.im*this.im},Jmat.Complex.arg=function(t){return Jmat.Complex(t.arg())},Jmat.Complex.prototype.arg=function(){return 0==this.im?this.re<0?Math.PI:0:Math.atan2(this.im,this.re)},Jmat.Complex.arg1=function(t){var a=t.arg();return 0>a&&(a+=2*Math.PI),a/=2*Math.PI,0>a&&(a=0),a>1&&(a=1),a},Jmat.Complex.isReal=function(t){return 0==t.im},Jmat.Complex.isImaginary=function(t){return 0==t.re},Jmat.Complex.isInt=function(t){return 0==t.im&&Jmat.Real.isInt(t.re)},Jmat.Complex.isGaussian=function(t){return Jmat.Real.isInt(t.re)&&Jmat.Real.isInt(t.im)},Jmat.Complex.isNaN=function(t){return!t||isNaN(t.re)||isNaN(t.im)},Jmat.Complex.isInf=function(t){return Math.abs(t.re)==1/0||Math.abs(t.im)==1/0},Jmat.Complex.isInfOrNaN=function(t){return!t||Jmat.Real.isInfOrNaN(t.re)||Jmat.Real.isInfOrNaN(t.im)},Jmat.Complex.isPositive=function(t){return t.re>0&&0==t.im},Jmat.Complex.isNegative=function(t){return t.re<0&&0==t.im},Jmat.Complex.isPositiveOrZero=function(t){return t.re>=0&&0==t.im},Jmat.Complex.isNegativeOrZero=function(t){return t.re<=0&&0==t.im},Jmat.Complex.isPositiveInt=function(t){return Jmat.Complex.isInt(t)&&t.re>0},Jmat.Complex.isNegativeInt=function(t){return Jmat.Complex.isInt(t)&&t.re<0},Jmat.Complex.isPositiveIntOrZero=function(t){return Jmat.Complex.isInt(t)&&t.re>=0},Jmat.Complex.isNegativeIntOrZero=function(t){return Jmat.Complex.isInt(t)&&t.re<=0},Jmat.Complex.isOdd=function(t){return Jmat.Complex.isInt(t)&&1==Math.abs(t.re%2)},Jmat.Complex.isEven=function(t){return Jmat.Complex.isInt(t)&&t.re%2==0},Jmat.Complex.pow=function(t,a){if(Jmat.Complex.isReal(t)&&Jmat.Complex.isReal(a)&&(t.re>=0||a.re==1/0||a.re==-(1/0)||Jmat.Real.isInt(a.re)))return Jmat.Complex(Math.pow(t.re,a.re));var r=t.abs(),m=t.arg(),e=Math.pow(r,a.re)*Math.exp(-a.im*m);isNaN(e)&&(e=Math.pow(1,a.re/r)*Math.exp(-a.im*m/r),e=0>e?-(1/0):e>0?1/0:NaN);var n=a.im*Math.log(r)+a.re*m;return Jmat.Complex(e*Math.cos(n),e*Math.sin(n))},Jmat.Complex.prototype.pow=function(t){return Jmat.Complex.pow(this,t)},Jmat.Complex.sin=function(t){if(0==t.im)return Jmat.Complex(Math.sin(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.exp(a),m=Jmat.Complex.inv(r);return r.sub(m).div(Jmat.Complex(0,2))},Jmat.Complex.sinc=function(t){return t.eqr(0)?Jmat.Complex(1):Jmat.Complex.sin(t).div(t)},Jmat.Complex.cos=function(t){if(0==t.im)return Jmat.Complex(Math.cos(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.exp(a),m=Jmat.Complex.inv(r);return r.add(m).mulr(.5)},Jmat.Complex.tan=function(t){if(0==t.im)return Jmat.Complex(Math.tan(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.exp(a),m=Jmat.Complex.inv(r);return r.sub(m).div(Jmat.Complex(0,2)).div(r.add(m).mulr(.5))},Jmat.Complex.asin=function(t){if(0==t.im&&t.re>=-1&&t.re<=1)return Jmat.Complex(Math.asin(t.re));var a=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(t.mul(t))),r=Jmat.Complex.log(Jmat.Complex(-t.im,t.re).add(a));return Jmat.Complex(r.im,-r.re)},Jmat.Complex.acos=function(t){if(0==t.im&&t.re>=-1&&t.re<=1)return Jmat.Complex(Math.acos(t.re));var a=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(t.mul(t))).mul(Jmat.Complex.I),r=Jmat.Complex.log(t.add(a));return Jmat.Complex(r.im,-r.re)},Jmat.Complex.atan=function(t){if(0==t.im)return Jmat.Complex(Math.atan(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.ONE.sub(a).div(a.inc()),m=Jmat.Complex.log(r);return Jmat.Complex(-.5*m.im,.5*m.re)},Jmat.Complex.atan2=function(t,a){if(Jmat.Complex.isReal(t)&&Jmat.Complex.isReal(a)){var r=Jmat.Complex(0);return r.re=Math.atan2(t.re,a.re),r}return a.eqr(0)?Jmat.Complex(Math.PI/2):Jmat.Complex.atan(Jmat.Complex.sqrt(t.mul(t).add(a.mul(a))).sub(t).div(a)).mulr(2)},Jmat.Complex.sinh=function(t){var a=Jmat.Complex.exp(t),r=Jmat.Complex.inv(a);return a.sub(r).divr(2)},Jmat.Complex.cosh=function(t){var a=Jmat.Complex.exp(t),r=Jmat.Complex.inv(a);return a.add(r).divr(2)},Jmat.Complex.tanh=function(t){var a=Jmat.Complex.exp(t),r=Jmat.Complex.inv(a);return a.sub(r).div(a.add(r))},Jmat.Complex.asinh=function(t){return Jmat.Complex.log(t.add(Jmat.Complex.sqrt(t.mul(t).addr(1))))},Jmat.Complex.acosh=function(t){return Jmat.Complex.log(t.add(Jmat.Complex.sqrt(t.subr(1)).mul(Jmat.Complex.sqrt(t.addr(1)))))},Jmat.Complex.atanh=function(t){return Jmat.Complex.log(t.addr(1).div(t.rsub(1))).mulr(.5)},Jmat.Complex.logsin=function(t){if(t.im>-10&&t.im<10)return Jmat.Complex.log(Jmat.Complex.sin(t));var a=Jmat.Complex(.69314718056,1.570796326795),r=Jmat.Complex(Jmat.Real.wrap(t.re,-Math.PI/2,3*Math.PI/2),t.im);return t.im>0?Jmat.Complex.newi(Jmat.Complex.PI).sub(Jmat.Complex.I.mul(r)).sub(a):Jmat.Complex.I.mul(r).sub(a)},Jmat.Complex.logcos=function(t){return Jmat.Complex.logsin(t.rsub(Math.PI/2))},Jmat.Complex.floor=function(t){var a=Jmat.Complex(0);return a.re=Math.floor(t.re),a.im=Math.floor(t.im),a},Jmat.Complex.ceil=function(t){var a=Jmat.Complex(0);return a.re=Math.ceil(t.re),a.im=Math.ceil(t.im),a},Jmat.Complex.round=function(t){var a=Jmat.Complex(0);return a.re=Jmat.Real.round(t.re),a.im=Jmat.Real.round(t.im),a},Jmat.Complex.trunc=function(t){var a=Jmat.Complex(0);return a.re=t.re<0?Math.ceil(t.re):Math.floor(t.re),a.im=t.im<0?Math.ceil(t.im):Math.floor(t.im),a},Jmat.Complex.frac=function(t){return Jmat.Complex(Jmat.Real.frac(t.re),Jmat.Real.frac(t.im))},Jmat.Complex.fracn=function(t){return Jmat.Complex(Jmat.Real.fracn(t.re),Jmat.Real.fracn(t.im))},Jmat.Complex.lerp=function(t,a,r){return r.rsub(1).mul(t).add(r.mul(a))},Jmat.Complex.exp=function(t){if(0==t.im)return Jmat.Complex(Math.exp(t.re));var a=Math.exp(t.re);return new Jmat.Complex(a*Math.cos(t.im),a*Math.sin(t.im))},Jmat.Complex.expm1=function(t){return t.abssq()<1e-5?t.add(t.mul(t).divr(2)).add(t.mul(t).mul(t).divr(6)):Jmat.Complex.exp(t).subr(1)},Jmat.Complex.log=function(t){return t.eqr(-(1/0))?Jmat.Complex(1/0):Jmat.Complex.isReal(t)&&t.re>=0?Jmat.Complex(Math.log(t.re)):Jmat.Complex(Math.log(t.abs()),t.arg())},Jmat.Complex.log1p=function(t){return t.abssq()<1e-8?t.mulr(-.5).addr(1).mul(t):Jmat.Complex.log(t.addr(1))},Jmat.Complex.logy=function(t,a){return Jmat.Complex.log(t).div(Jmat.Complex.log(a))},Jmat.Complex.logr=function(t,a){return Jmat.Complex.log(t).divr(Math.log(a))},Jmat.Complex.log2=function(t){return Jmat.Complex.log(t).divr(Math.LN2)},Jmat.Complex.log10=function(t){return Jmat.Complex.log(t).divr(Math.LN10)},Jmat.Complex.sqrt=function(t){if(Jmat.Complex.isReal(t)){var a=Jmat.Complex(0);return t.re>=0||t.re!=t.re?a.re=Math.sqrt(t.re):a.im=Math.sqrt(-t.re),a}return t.pow(Jmat.Complex(.5))},Jmat.Complex.root=function(t,a){return t.pow(Jmat.Complex(Jmat.Complex.inv(a)))},Jmat.Complex.rootr=function(t,a){return t.pow(Jmat.Complex(1/a))},Jmat.Complex.toInt=function(t){return Math.round(t.re)},Jmat.Complex.infNormalize=function(t){return Jmat.Complex.isNaN(t)?Jmat.Complex(NaN):t.re==1/0?t.im==1/0?Jmat.Complex(1,1):t.im==-(1/0)?Jmat.Complex(1,-1):Jmat.Complex(1,0):t.re==-(1/0)?t.im==1/0?Jmat.Complex(-1,1):t.im==-(1/0)?Jmat.Complex(-1,-1):Jmat.Complex(-1,0):t.im==1/0?t.re==1/0?Jmat.Complex(1,1):t.re==-(1/0)?Jmat.Complex(-1,1):Jmat.Complex(0,1):t.im==-(1/0)?t.re==1/0?Jmat.Complex(1,-1):t.re==-(1/0)?Jmat.Complex(-1,-1):Jmat.Complex(0,-1):t.divr(t.abs())},Jmat.Complex.calcCache_=function(t,a,r,m){if(m){for(var e=0;m>e;e++)if(t.eq(r[2*e+1]))return r[2*e+2];var n=r[0]||0;n++,n>=m&&(n=0);var i=a(t);return r[2*n+1]=t,r[2*n+2]=i,r[0]=n,i}if(t.eq(r[0]))return r[1];var i=a(t);return r[0]=t,r[1]=i,i},Jmat.Complex.gamma=function(t){if(t.re==1/0)return Jmat.Complex(1/0);if(Jmat.Complex.isNegativeIntOrZero(t))return Jmat.Complex(1/0,1/0);if(0==t.im)return Jmat.Complex(Jmat.Real.gamma(t.re));var a=function(t){if(t.re<.5){var r=Jmat.Complex.PI.div(Jmat.Complex.sin(Jmat.Complex.PI.mul(t))).div(a(Jmat.Complex.ONE.sub(t)));return Jmat.Complex.isNaN(r)&&(r=Jmat.Complex(0)),r}var m=7,e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];t=t.subr(1);for(var n=Jmat.Complex(e[0]),i=1;m+2>i;i++)n=n.add(Jmat.Complex(e[i]).div(t.addr(i)));var o=t.addr(m+.5),l=Math.sqrt(2*Math.PI),u=o.pow(t.addr(.5)),J=Jmat.Complex.exp(o.neg()),r=u.mul(J).mul(n).mulr(l);return r};return a(t)},Jmat.Complex.factorial=function(t){return Jmat.Complex.gamma(Jmat.Complex.inc(t))},Jmat.Complex.loggamma=function(t){if(t.re<0){if(0==t.im&&t.re==Math.floor(t.re))return Jmat.Complex(NaN);var a=Jmat.Complex.log(Jmat.Complex.PI.div(Jmat.Complex.sin(Jmat.Complex.PI.mul(t))));return Jmat.Complex.isInfOrNaN(a)&&(a=Jmat.Complex.log(Jmat.Complex.newi(2*Math.PI)).sub(Jmat.Complex.newi(-Math.PI).mul(t.im>0?t:t.neg()))),a.sub(Jmat.Complex.loggamma(Jmat.Complex.ONE.sub(t)))}if(t.im<1&&t.im>-1&&t.re<1&&t.re>=0)return Jmat.Complex.log(Jmat.Complex.gamma(t));var r=Jmat.Complex(.918938533205);return r=r.add(Jmat.Complex.subr(t,.5).mul(Jmat.Complex.log(t))),r=r.sub(t),r=r.add(t.mulr(12).inv()),r=r.sub(Jmat.Complex.powr(t,3).mulr(360).inv()),r=r.add(Jmat.Complex.powr(t,5).mulr(1260).inv()),r=r.sub(Jmat.Complex.powr(t,7).mulr(1680).inv()),r=r.add(Jmat.Complex.powr(t,9).mulr(1188).inv())},Jmat.Complex.gamma_inv=function(t){if(Jmat.Complex.isPositive(t)&&a>.85){var a=t.re,r=.036533814484900416,m=Math.log((a+r)/Math.sqrt(2*Math.PI));return Jmat.Complex(m/Jmat.Real.lambertw(m/Math.E)+.5)}var e=Jmat.Complex.finvert_newton(t,Jmat.Complex.gamma,function(t){return Jmat.Complex.gamma(t).mul(Jmat.Complex.digamma(t))});return Jmat.Complex.near(Jmat.Complex.gamma(e),t,.01)?e:Jmat.Complex(NaN)},Jmat.Complex.digamma=function(t){var a=Jmat.Real.frac(t.re);if(.001>a||a>.999||a>.499&&.501>a){if(t.re<-98)return Jmat.Complex.loggamma(t.addr(3e-4)).sub(Jmat.Complex.loggamma(t.addr(1e-4))).divr(2e-4);var r=Jmat.Complex.gamma(t.addr(1e-4)).sub(Jmat.Complex.gamma(t.subr(1e-4))).divr(2e-4).div(Jmat.Complex.gamma(t));return Jmat.Complex.isInfOrNaN(r)&&!Jmat.Complex.isInf(t)&&0!=t.im?Jmat.Complex.loggamma(t.addr(3e-4)).sub(Jmat.Complex.loggamma(t.addr(1e-4))).divr(2e-4):r}return Jmat.Complex.loggamma(t.addr(1e-4)).sub(Jmat.Complex.loggamma(t.subr(1e-4))).divr(2e-4)},Jmat.Complex.trigamma=function(t){var a=Jmat.Real.frac(t.re);if(.001>a||a>.999||a>.499&&.501>a){var r=Jmat.Complex.gamma(t.addr(-2e-4)),m=Jmat.Complex.gamma(t.addr(-1e-4)),e=Jmat.Complex.gamma(t),n=Jmat.Complex.gamma(t.addr(1e-4)),i=Jmat.Complex.gamma(t.addr(2e-4)),o=r.sub(e).divr(2e-4).div(m),l=e.sub(i).divr(2e-4).div(n);return o.sub(l).divr(2e-4)}var r=Jmat.Complex.loggamma(t.addr(-2e-4)),m=Jmat.Complex.loggamma(t),e=Jmat.Complex.loggamma(t.addr(2e-4)),o=r.sub(m).divr(2e-4),l=m.sub(e).divr(2e-4);return o.sub(l).divr(2e-4)},Jmat.Complex.polygamma=function(t,a){if(t.eqr(0))return Jmat.Complex.digamma(a);if(t.eqr(1))return Jmat.Complex.trigamma(a);var r=Jmat.Complex.hurwitzzeta(t.inc(),a);return Jmat.Complex(-1).pow(t.inc()).mul(Jmat.Complex.factorial(t)).mul(r)},Jmat.Complex.incgamma_lower=function(t,a){if(a.re>0){var r=a.pow(t).div(t).mul(Jmat.Complex.hypergeometric1F1(t,t.inc(),a.neg()));if(!Jmat.Complex.isNaN(r))return r}for(var r=Jmat.Complex(0),m=Jmat.Complex(1),e=a.pow(t),n=1,i=a.abs()>5?50:30,o=0;i>o;o++)o>0&&(m/=o,n=-n,e=e.mul(a)),r=r.add(Jmat.Complex(n*m).mul(e).div(t.addr(o)));return r},Jmat.Complex.incgamma_upper=function(t,a){return Jmat.Complex.isNegativeIntOrZero(t)&&(t=t.addr(1e-7)),Jmat.Complex.gamma(t).sub(Jmat.Complex.incgamma_lower(t,a))},Jmat.Complex.gamma_p_cache_=[],Jmat.Complex.gamma_p=function(t,a){if(Jmat.Complex.isNegativeIntOrZero(t))return Jmat.Complex(1);var r=Jmat.Complex.calcCache_(t,Jmat.Complex.gamma,Jmat.Complex.gamma_p_cache_);return Jmat.Complex.incgamma_lower(t,a).div(r)},Jmat.Complex.gamma_q=function(t,a){return Jmat.Complex.isNegativeIntOrZero(t)?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.gamma_p(t,a))},Jmat.Complex.gamma_p_inv_series_1_=function(t,a){var r=t.inc(),m=r.mul(r),e=t.addr(2),n=e.mul(e),i=t.mul(t),o=i.mul(t),l=o.mul(t),u=t.addr(3),J=t.addr(4),p=[0,1];p[2]=t.inc().inv(),p[3]=t.mulr(3).addr(5).div(m.mul(e).mulr(2)),p[4]=i.mulr(8).add(t.mulr(33)).addr(31).div(m.mul(r).mul(e).mul(u).mulr(3)),p[5]=l.mulr(125).add(o.mulr(1179)).add(i.mulr(3971)).add(t.mulr(5661)).addr(2888).div(m.mul(m).mul(n).mul(u).mul(J).mulr(24));var s=a.mul(Jmat.Complex.gamma(r)).pow(t.inv());return Jmat.Complex.powerSeries(p,p.length,Jmat.Complex.ZERO,s)},Jmat.Complex.gamma_p_inv=function(t,a){return!Jmat.Complex.isReal(a)||!Jmat.Complex.isReal(t)||a.re<0||a.re>1||t.re<0?Jmat.Complex(NaN):Jmat.Complex.gamma_p_inv_series_1_(t,a)},Jmat.Complex.gamma_q_inva=function(t,a){return Jmat.Complex.rootfind_bisection(Jmat.Complex(0),Jmat.Complex(100),function(r){return Jmat.Complex.gamma_q(r,a).sub(t)})},Jmat.Complex.gammaDiv_=function(t,a){if(t.eq(a))return Jmat.Complex.ONE;if(Jmat.Complex.isInfOrNaN(t)||Jmat.Complex.isInfOrNaN(a))return Jmat.Complex(NaN);if(Jmat.Complex.isNegativeIntOrZero(a)&&(t.re>0||!Jmat.Complex.isInt(t)))return Jmat.Complex.ZERO;if(Jmat.Complex.isInt(t)&&Jmat.Complex.isInt(a)){if(t.re<=0&&a.re<=0){var r=Jmat.Real.isOdd(t.re-a.re)?-1:1;return Jmat.Complex.gammaDiv_(a.rsub(1),t.rsub(1)).mulr(r)}if(t.re>0&&a.re>0&&Jmat.Real.dist(t.re,a.re)<16){if(t.re>a.re){for(var m=a.re,e=a.re+1;e<t.re;e++)m*=e;return Jmat.Complex(m)}for(var m=1/t.re,e=t.re+1;e<a.re;e++)m/=e;return Jmat.Complex(m)}}return Jmat.Complex.gamma(t).div(Jmat.Complex.gamma(a))},Jmat.Complex.gammaDiv12_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex.isNegativeIntOrZero(r)&&(t.re>0||!Jmat.Complex.isInt(t))?Jmat.Complex.ZERO:Jmat.Complex.gammaDiv_(t,a).div(Jmat.Complex.gamma(r)):Jmat.Complex.gammaDiv_(t,r).div(Jmat.Complex.gamma(a))},Jmat.Complex.gammaDiv21_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(t)?Jmat.Complex.gammaDiv_(t,r).mul(Jmat.Complex.gamma(a)):Jmat.Complex.gammaDiv_(a,r).mul(Jmat.Complex.gamma(t))},Jmat.Complex.gammaDiv22_=function(t,a,r,m){return Jmat.Complex.isNegativeIntOrZero(t)==Jmat.Complex.isNegativeIntOrZero(r)?Jmat.Complex.gammaDiv_(t,r).mul(Jmat.Complex.gammaDiv_(a,m)):Jmat.Complex.gammaDiv_(t,m).mul(Jmat.Complex.gammaDiv_(a,r))},Jmat.Complex.loggammaDiv_=function(t,a){if(t.eq(a))return Jmat.Complex.ZERO;if(Jmat.Complex.isInfOrNaN(t)||Jmat.Complex.isInfOrNaN(a))return Jmat.Complex(NaN);if(Jmat.Complex.isNegativeIntOrZero(a)&&(t.re>0||!Jmat.Complex.isInt(t)))return Jmat.Complex(-(1/0));if(Jmat.Complex.isInt(t)&&Jmat.Complex.isInt(a)&&t.re<=0&&a.re<=0){var r=Jmat.Real.isOdd(t.re-a.re)?-1:1,m=Jmat.Complex.loggammaDiv_(a.rsub(1),t.rsub(1));return-1==r&&(m=m.add(Jmat.Complex.newi(Math.PI))),m}return Jmat.Complex.loggamma(t).sub(Jmat.Complex.loggamma(a))},Jmat.Complex.loggammaDiv12_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex.isNegativeIntOrZero(r)&&(t.re>0||!Jmat.Complex.isInt(t))?Jmat.Complex(-(1/0)):Jmat.Complex.loggammaDiv_(t,a).sub(Jmat.Complex.loggamma(r)):Jmat.Complex.loggammaDiv_(t,r).sub(Jmat.Complex.loggamma(a))},Jmat.Complex.loggammaDiv21_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(t)?Jmat.Complex.loggammaDiv_(t,r).add(Jmat.Complex.loggamma(a)):Jmat.Complex.loggammaDiv_(a,r).add(Jmat.Complex.loggamma(t))},Jmat.Complex.loggammaDiv2_=function(t,a,r,m){return Jmat.Complex.isNegativeIntOrZero(t)==Jmat.Complex.isNegativeIntOrZero(r)?Jmat.Complex.loggammaDiv_(t,r).add(Jmat.Complex.loggammaDiv_(a,m)):Jmat.Complex.loggammaDiv_(t,m).add(Jmat.Complex.loggammaDiv_(a,r))},Jmat.Complex.agmMulSqrt_=function(t,a){return Jmat.Complex.isPositive(t)&&Jmat.Complex.isPositive(a)?Jmat.Complex.sqrt(t.mul(a)):Jmat.Complex(Math.sqrt(t.mul(a).abs())).mul(Jmat.Complex.exp(Jmat.Complex.I.mulr((t.arg()+a.arg())/2)))},Jmat.Complex.agm=function(t,a){if(t.eq(a.neg())||t.eq(Jmat.Complex.ZERO)||a.eq(Jmat.Complex.ZERO))return Jmat.Complex(0);for(var r,m,e=Jmat.Complex.isReal(t)&&Jmat.Complex.isReal(a)&&t.re<0==a.re<0,n=0;60>n&&!t.eq(a);n++)r=t.add(a).divr(2),m=Jmat.Complex.agmMulSqrt_(t,a),t=r,a=m;return e&&(t.im=0),t},Jmat.Complex.ghm=function(t,a){for(var r,m,e=0;60>e&&!t.eq(a);e++)r=Jmat.Complex.agmMulSqrt_(t,a),m=Jmat.Complex.TWO.div(t.inv().add(a.inv())),t=r,a=m;return t},Jmat.Complex.bessel0big_=function(t){for(var a=Jmat.Complex,r=[-.0703125,.112152099609375,-.5725014209747314,.6074042001273483,-110.0171402692467,303.8090510922384,-118838.4262567832,625295.1493434797,-425939216.5047669,3646840080.706556,-3833534661393.944,48540146868529.01],m=[.0732421875,-.2271080017089844,1.727727502584457,-24.38052969955606,551.3358961220206,-18257.75547429318,832859.3040162893,-50069589.53198893,3836255180.230433,-364901081884.9833,42189715702840.96,-5827244631566907],e=t.abs(),n=e>=50?8:e>=35?10:12,i=a.ONE,o=a(-.125).div(t),l=t.inv(),u=l.mul(l),J=a.ONE,p=0;n>p;p++)J=J.mul(u),i=i.add(J.mulr(r[p])),o=o.add(J.mul(l).mulr(m[p]));var s=a.sqrt(t.mulr(Math.PI/2).inv()),x=t.subr(.25*Math.PI),f=s.mul(i.mul(a.cos(x)).sub(o.mul(a.sin(x)))),c=s.mul(i.mul(a.sin(x)).add(o.mul(a.cos(x))));return[f,c]},Jmat.Complex.besselj0_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(1);if(t.re<0&&(t=t.neg()),t.abs()<12){
for(var r=a.ONE,m=a.ONE,e=t.mul(t),n=1;40>=n&&(m=m.mul(e).mulr(-.25/(n*n)),r=r.add(m),!(m.abssq()<1e-30*r.abssq()));n++);return r}return Jmat.Complex.bessel0big_(t)[0]},Jmat.Complex.bessely0_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(-(1/0));var r,m,e=t.re<0;if(e&&(t=t.neg()),t.abs()<12){r=a.besselj0_(t);for(var n=0,i=a.ONE,o=a.ZERO,l=t.mul(t),u=1;40>=u;u++){n+=1/u,i=i.mulr(-.25/(u*u)).mul(l);var J=i.mulr(n);if(o=o.add(J),J.abssq()<1e-30*o.abssq())break}var p=a(2/Math.PI);m=p.mul(a.log(t.divr(2)).add(a.EM)).mul(r).sub(p.mul(o))}else{var s=Jmat.Complex.bessel0big_(t);r=s[0],m=s[1]}return e&&(m=t.im<=0?m.add(a(0,2).mul(r)):m.sub(a(0,2).mul(r))),m},Jmat.Complex.bessel1big_=function(t){for(var a=Jmat.Complex,r=[.1171875,-.144195556640625,.6765925884246826,-6.883914268109947,121.5978918765359,-3302.272294480852,127641.2726461746,-6656367.718817688,450278600.3050393,-38338575207.4279,4011838599133.198,-506056850331472.7],m=[-.1025390625,.2775764465332031,-1.993531733751297,27.24882731126854,-603.8440767050702,19718.37591223663,-890297.8767070678,53104110.10968522,-4043620325.107754,382701134659.8605,-44064814178522.78,6065091351222699],e=t.abs(),n=e>=50?8:e>=35?10:12,i=a.ONE,o=a(.375).div(t),l=t.inv(),u=l.mul(l),J=a.ONE,p=0;n>p;p++)J=J.mul(u),i=i.add(J.mulr(r[p])),o=o.add(J.mul(l).mulr(m[p]));var s=a.sqrt(t.mulr(Math.PI/2).inv()),x=t.subr(.75*Math.PI),f=s.mul(i.mul(a.cos(x)).sub(o.mul(a.sin(x)))),c=s.mul(i.mul(a.sin(x)).add(o.mul(a.cos(x))));return[f,c]},Jmat.Complex.besselj1_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(0);var r,m=t.re<0;if(m&&(t=t.neg()),t.abs()<12){r=a.ONE;for(var e=a.ONE,n=t.mul(t),i=1;40>=i&&(e=e.mul(n).mulr(-.25/(i*(i+1))),r=r.add(e),!(e.abssq()<1e-30*r.abssq()));i++);r=r.mul(t).mulr(.5)}else r=Jmat.Complex.bessel1big_(t)[0];return m&&(r=r.neg()),r},Jmat.Complex.bessely1_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(-(1/0));var r,m,e=t.re<0;if(e&&(t=t.neg()),t.abs()<12){r=a.besselj1_(t);for(var n=0,i=a.ONE,o=a.ONE,l=t.mul(t),u=1;40>=u;u++){n+=1/u,i=i.mulr(-.25/(u*(u+1))).mul(l);var J=i.mulr(2*n+1/(u+1));if(o=o.add(J),J.abssq()<1e-30*o.abssq())break}var p=a(2/Math.PI);m=p.mul(a.log(t.divr(2)).add(a.EM).mul(r).sub(t.inv()).sub(t.mul(o).mulr(.25)))}else{var s=Jmat.Complex.bessel1big_(t);r=s[0],m=s[1]}return e&&(m=t.im<=0?m.add(a(0,2).mul(r)).neg():m.sub(a(0,2).mul(r)).neg()),m},Jmat.Complex.bessel_sqrt_=function(t){return Jmat.Complex.isNegative(t)?Jmat.Complex.sqrt(t).neg():Jmat.Complex.sqrt(t)},Jmat.Complex.bessel_sqrt2piz_=function(t){return Jmat.Complex.bessel_sqrt_(t.rdiv(2/Math.PI))},Jmat.Complex.besselj_miller_=function(t,a){if(a.eqr(0))return Jmat.Complex(0);if(t.eqr(1))return Jmat.Complex.besselj1_(a);if(t.re<a.abs()/4){for(var r=Jmat.Complex.besselj0_(a),m=Jmat.Complex.besselj1_(a),e=1;e<t.re;e++){var n=m.mulr(2*e).div(a).sub(r);r=m,m=n}return m}for(var i,r=Jmat.Complex.besselj0_(a),o=Jmat.Complex(1),l=Jmat.Complex.ZERO,u=Math.ceil(Math.max(a.abs(),t.abs())),e=t.re+u;e>0;e--){var n=o.mulr(2*e).div(a).sub(l);l=o,o=n,e-1==t.re&&(i=n)}var J=r.div(o);return i.mul(J)},Jmat.Complex.besselj_series_=function(t,a){var r=Jmat.Complex,m=r.isNegativeInt(t);m&&(t=t.neg());for(var e=r(0),n=1,i=r.gamma(t.inc()),o=0;50>o;o++){var l=r(o+1),u=r.gamma(l).mul(i),J=r(n).div(u).mul(a.divr(2).pow(r(2*o).add(t)));n=-n,e=e.add(J),i=i.mul(t.add(l))}return m&&Jmat.Real.isOdd(t.re)&&(e=e.neg()),e},Jmat.Complex.besselj_hankelexpansion_=function(t,a){var r,m=Jmat.Complex,e=Math.PI,n=Math.abs(a.arg())>3;n&&(a=a.neg());for(var i,o=Jmat.Complex.ONE,l=m.ONE,u=a.sub(t.mulr(e/2)).subr(e/4),J=m.ZERO,p=m.ZERO,s=t.mul(t).mulr(4),x=Math.max(4,Math.min(60,Math.abs(t.re))),f=0;x>f;f++){if(f>0){var c=s.subr((2*f-1)*(2*f-1));o=o.mul(c).divr(8*f),l=l.mul(a),i=d}var C=2>f%4?1:-1,d=o.div(l).mulr(C);if(d.abssq()<1e-28)break;f%2==0?p=p.add(d):J=J.add(d)}return d.abssq()>.01?m(NaN):(p=m.cos(u).mul(p),J=m.sin(u).mul(J),r=m.bessel_sqrt2piz_(a).mul(p.sub(J)),n&&(r=r.mul(m.exp(t.muli(e)))),r)},Jmat.Complex.besselj_hypergeom_=function(t,a){var r=Jmat.Complex,m=1;r.isNegativeInt(t)&&(r.isOdd(t)&&(m=-1),t=t.neg()),r.isNegativeInt(t.addr(.5))&&(t=t.abssq()<5?t.addr(1e-12):t.addr(1e-5));var e=r.hypergeometric1F1(t.addr(.5),t.mulr(2).inc(),a.muli(2)),n=r.log(a.mulr(.5)).mul(t).sub(r.loggamma(t.inc())).add(a.muli(-1));return r.exp(n.add(r.log(e))).mulr(m)},Jmat.Complex.besselj_large_nu_=function(t,a){var r=Jmat.Complex,m=r.bessel_sqrt2piz_(t).divr(2),e=r.E.mul(a).div(t).divr(2);return m.mul(e.pow(t))},Jmat.Complex.besselj=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r(0);if(r.isInf(a))return r(0);if(a.eqr(0))return 0==t.re?r(0==t.im?1:NaN):t.re<0?r(1/0,1/0):r(0);if(t.eqr(0))return r.besselj0_(a);if(t.eqr(1))return r.besselj1_(a);if(t.eqr(.5))return r.bessel_sqrt2piz_(a).mul(r.sin(a));if(t.eqr(-.5))return r.bessel_sqrt2piz_(a).mul(r.cos(a));if(t.re>300&&Math.abs(t.im)<t.re&&a.abssq()<2500)return r(0);if(t.re<-300&&r.isInt(t)&&a.abssq()<2500)return r(0);if(t.re>50&&r.isReal(a)&&t.re>16*a.abs())return Jmat.Complex.besselj_large_nu_(t,a);if(r.isInt(t)&&Math.abs(t.re)<50){var m;return m=t.re<0?r.besselj_miller_(t.neg(),a).mulr(r.isOdd(t)?-1:1):r.besselj_miller_(t,a)}return a.abs()<25?r.besselj_series_(t,a):a.abssq()>t.abssq()?r.besselj_hankelexpansion_(t,a):t.re>2*a.abs()?Jmat.Complex.besselj_large_nu_(t,a):r.besselj_hypergeom_(t,a)},Jmat.Complex.bessely_miller_=function(t,a){for(var r=Jmat.Complex.bessely0_(a),m=Jmat.Complex.bessely1_(a),e=1;e<t.re;e++){var n=m.mulr(2*e).div(a).sub(r);r=m,m=n}return m},Jmat.Complex.bessely_with_besselj_=function(t,a){var r=Jmat.Complex;if(r.isInt(t.addr(.5)))return r.besselj(t.neg(),a).mulr(r.isOdd(t.addr(.5))?-1:1);var m=r.besselj(t,a),e=r.cos(t.mulr(Math.PI));r.isInt(e.addr(.5))&&(e=r(0));var n=r.besselj(t.neg(),a),i=r.sin(t.mulr(Math.PI));return m.mul(e).sub(n).div(i)},Jmat.Complex.bessely_hankelexpansion_=function(t,a){var r=Jmat.Complex,m=Math.PI,e=Math.abs(a.arg())>3;e&&(a=a.neg());for(var n,i=Jmat.Complex.ONE,o=r.ONE,l=a.sub(t.mulr(m/2)).subr(m/4),u=r.ZERO,J=r.ZERO,p=t.mul(t).mulr(4),s=Math.max(4,Math.min(60,Math.abs(t.re))),x=0;s>x;x++){if(x>0){var f=p.subr((2*x-1)*(2*x-1));i=i.mul(f).divr(8*x),o=o.mul(a),n=C}var c=2>x%4?1:-1,C=i.div(o).mulr(c);if(C.abssq()<1e-28)break;x%2==0?J=J.add(C):u=u.add(C)}if(C.abssq()>.01)return r(NaN);J=r.sin(l).mul(J),u=r.cos(l).mul(u);var d=r.bessel_sqrt2piz_(a).mul(J.add(u));if(e){var g=r.besselj(t,a);d=d.mul(r.exp(t.muli(-m))).add(r.cos(t.mulr(m)).mul(g).muli(2))}return d},Jmat.Complex.bessely=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r.isInf(a)?r(NaN):r.isPositive(a)?r(-(1/0)):r(1/0,1/0);if(r.isInf(a))return r(0);if(a.eqr(0))return 0==t.re?r(0==t.im?-(1/0):NaN):r(1/0,1/0);if(t.eqr(0))return r.bessely0_(a);if(t.eqr(1))return r.bessely1_(a);if(r.isInt(t)){var m=a.re<0;m&&(a=a.neg());var e;if(e=t.re<0?r.bessely_miller_(t.neg(),a).mulr(r.isOdd(t)?-1:1):r.bessely_miller_(t,a),m){var n=r.besselj(t,a);e=a.im<=0?e.add(r(0,2).mul(n)):e.sub(r(0,2).mul(n)),r.isOdd(t)&&(e=e.neg())}return e}return a.abs()<20?r.bessely_with_besselj_(t,a):a.abssq()>t.abssq()?r.bessely_hankelexpansion_(t,a):r(NaN)},Jmat.Complex.hankelh1=function(t,a){var r=Jmat.Complex;return r.isInf(t)?r(1/0,1/0):r.isInf(a)?r(0):a.eqr(0)?0==t.re&&0!=t.im?r(NaN):r(1/0,1/0):t.im<0?r.exp(t.mul(r.newi(-Math.PI))).mul(r.hankelh1(t.neg(),a)):r.besselj(t,a).add(r.bessely(t,a).mul(r.I))},Jmat.Complex.hankelh2=function(t,a){var r=Jmat.Complex;return r.isInf(t)?r(1/0,1/0):r.isInf(a)?r(0):a.eqr(0)?0==t.re&&0!=t.im?r(NaN):r(1/0,1/0):t.im>0?r.exp(t.mul(r.newi(Math.PI))).mul(r.hankelh2(t.neg(),a)):r.besselj(t,a).sub(r.bessely(t,a).mul(r.I))},Jmat.Complex.besseli=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r(r.isInf(a)?NaN:0);if(a.eqr(1/0))return r(1/0);if(r.isInf(a))return r(1/0,1/0);if(a.eqr(0))return 0==t.re?r(0==t.im?1:NaN):t.re<0?r(1/0,1/0):r(0);var m=r.I.pow(t.neg()).mul(r.besselj(t,a.mul(r.I)));return 0==a.im&&0==t.im&&Jmat.Real.near(m.im,0,1e-10)&&(m.im=0),m},Jmat.Complex.besselk=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r.isInf(a)?r(NaN):r.isPositive(a)?r(1/0):r(1/0,1/0);if(a.eqr(1/0))return r(0);if(r.isInf(t))return r(1/0,1/0);if(a.eqr(0))return 0==t.re?r(0==t.im?1/0:NaN):r(1/0,1/0);var m;return m=a.im>=0?r.I.pow(t.inc()).mulr(Math.PI/2).mul(r.hankelh1(t,r.I.mul(a))):r.newi(-1).pow(t.inc()).mulr(Math.PI/2).mul(r.hankelh2(t,r.newi(-1).mul(a))),0==a.im&&0==t.im&&Jmat.Real.near(m.im,0,.001)&&(m.im=0),m},Jmat.Complex.airyloop_=function(t,a,r,m){for(var e=1.3541179394264005,n=.8929795115692493,i=t.mul(t).mul(t),o=Jmat.Complex.ONE,l=t,u=1,J=Jmat.Complex.ZERO,p=0;30>p;p++){p>0&&(u*=p,e*=p+2/3-1,n*=p+4/3-1,a/=9,r/=9,o=o.mul(i),l=l.mul(i));var s=o.mulr(a/u/e),x=l.mulr(r/u/n);if(Jmat.Complex.isNaN(s)||Jmat.Complex.isNaN(x))break;if(s.eqr(0)&&x.eqr(0))break;J=J.add(s).add(x.mulr(m))}return J},Jmat.Complex.airy=function(t){if(t.abs()>8){if(Math.abs(t.arg())<2*Math.PI/3){var a=t.powr(.25).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r.neg()).div(a.mulr(2))}var m=t.neg(),a=m.powr(.25).mul(Jmat.Complex.SQRTPI),r=m.powr(1.5).mulr(2/3);return Jmat.Complex.sin(r.addr(Math.PI/4)).div(a)}var e=Math.pow(3,-2/3),n=Math.pow(3,-4/3);return Jmat.Complex.airyloop_(t,e,n,-1)},Jmat.Complex.bairy=function(t){if(t.abs()>10){if(Math.abs(t.arg())<Math.PI/3){var a=t.powr(.25).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r).div(a)}var m=t.neg(),a=m.powr(.25).mul(Jmat.Complex.SQRTPI),r=m.powr(1.5).mulr(2/3);return Jmat.Complex.cos(r.addr(Math.PI/4)).div(a)}var e=Math.pow(3,-1/6),n=Math.pow(3,-5/6);return Jmat.Complex.airyloop_(t,e,n,1)},Jmat.Complex.airy_deriv_loop_=function(t,a,r,m){for(var e=2.6789385347077475,n=.9027452929509336,i=t.mul(t).mul(t),o=Jmat.Complex.ONE,l=t.mul(t),u=1,J=Jmat.Complex.ZERO,p=0;30>p;p++){p>0&&(u*=p,e*=p+1/3-1,n*=p+5/3-1,a/=9,r/=9,o=o.mul(i),l=l.mul(i));var s=o.mulr(a/u/e),x=l.mulr(r/u/n);if(Jmat.Complex.isNaN(s)||Jmat.Complex.isNaN(x))break;if(s.eqr(0)&&x.eqr(0))break;J=J.add(s.mulr(m)).add(x)}return J},Jmat.Complex.airy_deriv=function(t){if(t.abs()>8){if(Math.abs(t.arg())<2*Math.PI/3){var a=t.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r.neg()).div(a.mulr(2)).neg()}var m=t.neg(),a=m.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=m.powr(1.5).mulr(2/3);return Jmat.Complex.cos(r.addr(Math.PI/4)).div(a).neg()}var e=Math.pow(3,-1/3),n=Math.pow(3,-5/3);return Jmat.Complex.airy_deriv_loop_(t,e,n,-1)},Jmat.Complex.bairy_deriv=function(t){if(t.abs()>10){if(Math.abs(t.arg())<Math.PI/3){var a=t.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r).div(a)}var m=t.neg(),a=m.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=m.powr(1.5).mulr(2/3);return Jmat.Complex.sin(r.addr(Math.PI/4)).div(a)}var e=Math.pow(3,1/6),n=Math.pow(3,-7/6);return Jmat.Complex.airy_deriv_loop_(t,e,n,1)},Jmat.Complex.zetaint_=function(t){for(var a=function(t,a){var r=Jmat.Complex.sin(t.mul(Jmat.Complex.atan(a))),m=a.mul(a).inc().pow(t.divr(2)),e=Jmat.Complex.exp(a.mulr(2*Math.PI)).dec(),a=m.mul(e);return r.eq(a)?Jmat.Complex.ONE:r.div(a)},r=Jmat.Complex.ONE;;){var m=a(t,r);if(m.abssq()<1e-4&&m.abssq()<1e-4)break;if(r.re>1e3)break;r=r.mulr(2)}for(var e=r.re,n=.01,i=Jmat.Complex.ZERO,o=0;e>o;o+=n){var l=a(t,Jmat.Complex(o)).mulr(n);i=i.add(l),n*=1.01}return i.mulr(2).addr(.5).add(t.dec().inv())},Jmat.Complex.zeta=function(t){if(t.eq(Jmat.Complex.ZERO))return Jmat.Complex(-.5);if(t.eqr(-1))return Jmat.Complex(-1/12);if(t.eqr(1))return Jmat.Complex(+(1/0));if(t.eqr(3))return Jmat.Complex(1.202056903159594);if(t.re==+(1/0))return Jmat.Complex(1);if(Jmat.Complex.isEven(t)&&t.re<0)return Jmat.Complex(0);var a=t.dec().abs();if(10>a){for(var r=t.dec(),m=r.inv(),e=Jmat.Complex.ONE,n=5>a?10:30,i=0;n>i;i++)m=m.add(Jmat.Complex(Jmat.Complex.stieltjes_zeta[i]).mul(e)),e=e.mul(r);return m}if(t.re>=5){for(var m=Jmat.Complex(0),i=1;32>i;i++)m=m.add(Jmat.Complex(i).pow(t).inv());return m}if(t.re>=.5){if(Jmat.Complex.near(t,Jmat.Complex(1,18.125),.1))return Jmat.Complex.zetaint_(t);for(var m=Jmat.Complex(0),o=Jmat.Complex.TWO.pow(Jmat.Complex.ONE.sub(t)),l=Jmat.Complex.ONE.div(Jmat.Complex.ONE.sub(o)),u=1,i=1;128>i;i++){var J=Jmat.Complex(u).div(Jmat.Complex(i).pow(t));m=m.add(J),u=-u}return m.mul(l)}var p=Jmat.Complex.ONE.sub(t),l=Jmat.Complex.TWO.pow(t),s=Jmat.Complex.PI.pow(t.subr(1)),x=Jmat.Complex.sin(t.mulr(Math.PI/2)),f=Jmat.Complex.gamma(p),c=Jmat.Complex.zeta(p);return l.mul(s).mul(x).mul(f).mul(c)},Jmat.Complex.eta=function(t){if(t.re<.5){t=t.neg();var a=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(t.neg().subr(1))),r=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(t.neg())),m=a.div(r).mulr(2).mul(Jmat.Complex.PI.pow(t.neg().subr(1))),e=Jmat.Complex.sin(Jmat.Complex.PI.mul(t).divr(2)),n=Jmat.Complex.gamma(t),i=Jmat.Complex.eta(t.inc());return m.mul(t).mul(e).mul(n).mul(i)}for(var o=50,e=function(t,a){for(var r=0,m=0;t>=m;m++){var e=Jmat.Real.factorial(a+m-1)/Jmat.Real.factorial(a-m),n=Math.pow(4,m)/Jmat.Real.factorial(2*m);r+=e*n}return r*a},l=e(o,o),u=Jmat.Complex(0),J=Jmat.Complex(1),p=0;o>p;p++){var a=J.mulr(e(p,o)-l),r=Jmat.Complex(p+1).pow(t);u=u.add(a.div(r)),J=J.neg()}return u.mulr(-1/l)},Jmat.Complex.lambda=function(t){return Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(t.neg())).mul(Jmat.Complex.zeta(t))},Jmat.Complex.hurwitzzeta_generate_hasse_table_=function(t){for(var a=[],r=0;t>r;r++){a[r]=0;for(var m=1,e=0;r>=e;e++)a[e]+=m*Jmat.Real.pascal_triangle(r,e)/(r+1),m=-m}return a},Jmat.Complex.hurwitzzeta_hasse_tables_=[],Jmat.Complex.hurwitzzeta_hasse_series_=function(t,a){var r=30;Jmat.Complex.hurwitzzeta_hasse_tables_[r]||(Jmat.Complex.hurwitzzeta_hasse_tables_[r]=Jmat.Complex.hurwitzzeta_generate_hasse_table_(r));for(var m=Jmat.Complex.hurwitzzeta_hasse_tables_[r],e=Jmat.Complex.ZERO,n=0;r>n;n++)e=e.add(a.addr(n).pow(Jmat.Complex.ONE.sub(t)).mulr(m[n]));return e=e.mul(t.dec().inv())},Jmat.Complex.hurwitzzeta_cos_series_=function(t,a){for(var r=t.rsub(1),m=Jmat.Complex.gamma(r).mulr(2).div(Jmat.Complex(2*Math.PI).pow(r)),e=Jmat.Complex.ZERO,n=1;30>n;n++){var i=Jmat.Complex.cos(r.mulr(Math.PI/2).sub(a.mulr(2*Math.PI*n)));e=e.add(i.div(Jmat.Complex(n).pow(r)))}return e.mul(m)},Jmat.Complex.hurwitzzeta_simple_series_=function(t,a){if(Jmat.Complex.isNegativeIntOrZero(a))return Jmat.Complex(1/0);for(var r=Jmat.Complex.ZERO,m=0;30>m;m++){var e=a.addr(m).pow(t).inv();r=r.add(e)}return r},Jmat.Complex.hurwitzzeta_euler_=function(t,a){for(var r=25,m=15,e=a.addr(r).pow(t).inv(),n=t.dec().inv().mul(a.addr(r).pow(t.dec()).inv()),i=Jmat.Complex.ZERO,o=0;r>o;o++){var l=a.addr(o).pow(t).inv();i=i.add(l)}for(var u=t,J=1,p=Jmat.Complex.ZERO,o=1;m>=o;o++){J*=2*(2*o-1)*o,u=u.mul(t.addr(2*o-1)).mul(t.addr(2*o));var s=u.div(a.addr(r).pow(t.addr(2*o+1))).neg();p=p.add(s.mulr(Jmat.Complex.bernoulli[2*o]/J))}return i.sub(p).add(e.divr(2)).add(n)},Jmat.Complex.hurwitzzeta=function(t,a){if(t.eqr(0))return Jmat.Complex(.5).sub(a);if(t.eqr(-1))return Jmat.Complex(-1/12).add(a.mulr(.5)).add(a.mul(a).mulr(-.5));if(a.eqr(1))return Jmat.Complex.zeta(t);if(t.re>2&&a.re>0)return Jmat.Complex.hurwitzzeta_simple_series_(t,a);if(t.re>=0&&a.re>-10)return Jmat.Complex.hurwitzzeta_euler_(t,a);if(t.re<0&&0==a.im&&a.re>0&&a.re<=1)return Jmat.Complex.hurwitzzeta_cos_series_(t,a);if(a.re>2)return Jmat.Complex.hurwitzzeta_hasse_series_(t,a);if(a.re>-40&&!a.eqr(0)){var r=t.re<0&&0==a.im?Math.ceil(-a.re):Math.ceil(2-a.re+.5),m=Jmat.Complex.ZERO;if(r>0)for(var e=0;r>e;e++){var n=a.addr(e).pow(t).inv();Jmat.Complex.isNaN(n)||(m=m.add(n))}else for(var e=0;-r>e;e++){var n=a.addr(e).addr(r).pow(t).inv();Jmat.Complex.isNaN(n)||(m=m.add(n))}var i=Jmat.Complex.hurwitzzeta(t,a.addr(r));return r>0?i.add(m):i.sub(m)}return Jmat.Complex(NaN)},Jmat.Complex.beta=function(t,a){return t.re<50&&t.re>-50&&a.re<50&&a.re>-50?Jmat.Complex.gammaDiv21_(t,a,t.add(a)):Jmat.Complex.exp(Jmat.Complex.loggammaDiv21_(t,a,t.add(a)))},Jmat.Complex.incbeta=function(t,a,r){if(t.eqr(1))return Jmat.Complex.beta(a,r);if(Jmat.Complex.isPositive(t)&&t.re<.75&&Jmat.Complex.isPositive(a)&&Jmat.Complex.isPositive(r)){for(var m,e,n=Jmat.Complex.ONE.sub(r),i=0;30>i&&(0==i?(m=Jmat.Complex(1),e=Jmat.Complex(0)):(m=m.mul(n.addr(i-1)),m=m.mul(t),m=m.divr(i)),!m.eqr(0));i++)e=e.add(m.div(a.addr(i)));return t.pow(a).mul(e)}return t.pow(a).div(a).mul(Jmat.Complex.hypergeometric2F1(a,Jmat.Complex.ONE.sub(r),a.inc(),t))},Jmat.Complex.beta_i=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(a)&&!Jmat.Complex.isNegativeIntOrZero(r)?Jmat.Complex(1):Jmat.Complex.isNegativeIntOrZero(r)&&!Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex(0):Jmat.Complex.isNegativeIntOrZero(r.add(a))&&t.eqr(1)?Jmat.Complex(1):Jmat.Complex.incbeta(t,a,r).div(Jmat.Complex.beta(a,r))},Jmat.Complex.beta_i_inv=function(t,a,r){if(!(Jmat.Complex.isPositiveOrZero(t)&&Jmat.Complex.isPositiveOrZero(a)&&Jmat.Complex.isPositiveOrZero(r)))return Jmat.Complex(NaN);for(var m=Jmat.Complex.beta(a,r),e=Jmat.Complex.ZERO,n=Jmat.Complex.ZERO,i=Jmat.Complex.ONE;!Jmat.Complex.near(n,i,1e-6);)e=n.add(i).divr(2),Jmat.Complex.incbeta(e,a,r).div(m).re>t.re?i=e:n=e;return e},Jmat.Complex.hypergeometric0F1=function(t,a){var r=Jmat.Complex;if(r.isNegativeInt(t))return r(1/0,1/0);if(a.re<-80&&t.abssq()<a.abssq()/3){var m=r.gamma(t).divr(2*r.SQRTPI.re),e=r.sqrt(a.neg()),n=r.exp(e.muli(-2)).mul(e.muli(-1).pow(t.rsub(.5))),i=r.hypergeometric([t.subr(.5),t.rsub(1.5)],[],e.muli(4).inv().neg()),o=r.exp(e.muli(2)).mul(e.muli(1).pow(t.rsub(.5))),l=r.hypergeometric([t.subr(.5),t.rsub(1.5)],[],e.muli(4).inv());return m.mul(n.mul(i).add(o.mul(l)))}for(var u=r.ONE,J=r.ZERO,p=0;30>p&&(p>0&&(u.eqr(0)||(u=u.div(t.addr(p-1))),u=u.mul(a).divr(p)),!u.eqr(0));p++)J=J.add(u);return J},Jmat.Complex.hypergeometric1F1_series_=function(t,a,r){for(var m=Jmat.Complex,e=t.div(a).mul(r).divr(1),n=m(1),i=1;200>i&&(i>1&&(e=e.mul(t.addr(i-1)),e.eqr(0)||(e=e.div(a.addr(i-1))),e=e.mul(r),e=e.divr(i)),!(e.eqr(0)||e.abssq()/n.abssq()<1e-28));i++)n=n.add(e);return n},Jmat.Complex.hypergeometric1F1_asymp_=function(t,a,r){var m=Jmat.Complex;if(m.isNegativeInt(a))return m(NaN);for(var e=m.ONE,n=m.ONE,i=m.ONE,o=m.ONE,l=1;30>l&&(i=i.mul(t.addr(l-1)).mul(t.sub(a).addr(l)).divr(l).div(r.neg()),o=o.mul(a.sub(t).addr(l-1)).mul(t.rsub(l)).divr(l).div(r),e=e.add(i),n=n.add(o),!(i.abssq()<1e-28&&o.abssq()<1e-28));l++);if(i.abssq()>1e-10||o.abssq()>1e-10)return m(NaN);var u=r.arg()<=0?-1:1;if(r.abs()<100){var J=m.gammaDiv_(a,a.sub(t)).mul(m.exp(t.muli(u*Math.PI))).div(r.pow(t)),p=m.gammaDiv_(a,t).mul(m.exp(r)).mul(r.pow(t.sub(a)));return J.mul(e).add(p.mul(n))}var J=m.loggammaDiv_(a,a.sub(t)).add(t.muli(u*Math.PI)).sub(m.log(r).mul(t)),p=m.loggammaDiv_(a,t).add(r).add(m.log(r).mul(t.sub(a)));return m.exp(J.add(m.log(e))).add(m.exp(p.add(m.log(n))))},Jmat.Complex.hypergeometric1F1_rational_=function(t,a,r){var m=Jmat.Complex,e=function(t,a,r){for(var e,n,i=r.mul(r),o=i.mul(r),l=a.mul(a.inc()),u=m(1),J=m(1).add(t.inc().mul(r).div(a).divr(2)),p=m(1).add(t.addr(2).mul(r).div(a.inc()).divr(2)).add(t.inc().mul(t.addr(2)).mul(i).div(l).divr(12)),s=t.mul(r).div(a),x=m(1),f=J.sub(s),c=t.addr(2).mul(r).div(a.inc()).divr(2).inc(),C=t.mul(t.inc()).mul(i).div(l).divr(2),d=p.sub(s.mul(c)).add(C),g=3;50>g;g++){var v=2*g,h=t.rsub(g-2).div(a.addr(g-1).mulr(2*(v-3))),I=t.addr(g).mul(t.addr(g-1)).div(a.addr(g-1).mul(a.addr(g-2)).mulr(4*(v-3)*(v-1))),_=t.addr(g-2).mul(t.addr(g-1)).mul(t.rsub(g-2)).div(a.addr(g-3).mul(a.addr(g-2)).mul(a.addr(g-1)).mulr(8*(v-3)*(v-3)*(v-5))).neg(),b=t.addr(g-1).mul(a.rsub(g-1)).div(a.addr(g-2).mul(a.addr(g-1)).mulr(2*(v-3))).neg(),M=h.mul(r).inc(),w=I.mul(r).add(b).mul(r),B=_.mul(o);e=d.mul(M).add(f.mul(w)).add(x.mul(B)),n=p.mul(M).add(J.mul(w)).add(u.mul(B)),x=f,f=d,d=e,u=J,J=p,p=n}var R=f.div(J),N=e.div(n);return R.sub(N).abs()>1e-10?m(NaN):N};return e(t,a,r.neg())},Jmat.Complex.hypergeometric1F1=function(t,a,r){var m=Jmat.Complex;if(a.sub(t).abssq()<t.abssq())return m.hypergeometric1F1(a.sub(t),a,r.neg()).mul(m.exp(r));if(t.eq(a))return m.exp(r);if(m.isNegativeInt(a)&&!(m.isNegativeInt(t)&&t.re>=a.re))return m(1/0);if(t.eqr(0))return m(1);if(r.eqr(0))return m(1);if(r.eqr(1/0))return m(1/0,1/0);var e=r.mul(t).div(a).abs();if(8>e)return m.hypergeometric1F1_series_(t,a,r);var n=m.hypergeometric1F1_asymp_(t,a,r);return m.isNaN(n)&&(n=m.hypergeometric1F1_rational_(t,a,r)),n},Jmat.Complex.hypergeometric2F1=function(t,a,r,m){if(m.abs()>1.0001){var e=m.div(m.dec());if(e.abs()<.75)return Jmat.Complex.ONE.sub(m).pow(t.neg()).mul(Jmat.Complex.hypergeometric2F1(t,r.sub(a),r,e));var n=function(t){return Jmat.Complex.isNegativeIntOrZero(t)?t.addr(1e-5):t},i=m.inv(),o=m.neg().pow(t.neg()),l=m.neg().pow(a.neg()),u=Jmat.Complex.gammaDiv22_(n(r),n(a.sub(t)),n(a),n(r.sub(t))),J=Jmat.Complex.gammaDiv22_(n(r),n(t.sub(a)),n(t),n(r.sub(a))),p=Jmat.Complex.hypergeometric2F1(t,Jmat.Complex.ONE.sub(r).add(t),n(Jmat.Complex.ONE.sub(a).add(t)),i),s=Jmat.Complex.hypergeometric2F1(a,Jmat.Complex.ONE.sub(r).add(a),n(Jmat.Complex.ONE.sub(t).add(a)),i),x=u.mul(o).mul(p),f=J.mul(l).mul(s);return x.add(f)}var e=m.div(m.dec());if(e.abs()<m.abs())return Jmat.Complex.ONE.sub(m).pow(t.neg()).mul(Jmat.Complex.hypergeometric2F1(t,r.sub(a),r,e));var c=30;m.abs()>.5&&(c=60),m.abs()>.75&&(c=100);for(var C=t.mul(a).div(r).mul(m).divr(1),d=Jmat.Complex(1),g=1;c>g&&(g>1&&(C=C.mul(t.addr(g-1)),C=C.mul(a.addr(g-1)),C.eqr(0)||(C=C.div(r.addr(g-1))),C=C.mul(m),C=C.divr(g)),!C.eqr(0))&&!Jmat.Complex.near(C,Jmat.Complex.ZERO,1e-15);g++)d=d.add(C);return d},Jmat.Complex.hypergeometric=function(t,a,r){if(r.eqr(0))return Jmat.Complex(1);if(0==t.length&&0==a.length)return Jmat.Complex.exp(r);if(1==t.length&&0==a.length)return Jmat.Complex.pow(r.rsub(1),t[0].neg());if(0==t.length&&1==a.length)return Jmat.Complex.hypergeometric0F1(a[0],r);if(1==t.length&&1==a.length)return Jmat.Complex.hypergeometric1F1(t[0],a[0],r);if(2==t.length&&1==a.length)return Jmat.Complex.hypergeometric2F1(t[0],t[1],a[0],r);for(var m=r,e=0;e<t.length;e++)m=m.mul(t[e]);for(var e=0;e<a.length;e++)m=m.div(a[e]);for(var n=Jmat.Complex(1),i=1;40>i;i++){if(i>1){for(var e=0;e<t.length;e++)m=m.mul(t[e].addr(i-1));for(var e=0;e<a.length;e++)m=m.eqr(0)?m:m.div(a[e].addr(i-1));m=m.mul(r),m=m.divr(i)}if(m.eqr(0))break;n=n.add(m)}return n},Jmat.Complex.PIPI6_=Jmat.Complex(Math.PI*Math.PI/6),Jmat.Complex.dilog=function(t){if(t.eqr(0))return Jmat.Complex.ZERO;if(t.eqr(1))return Jmat.Complex.PIPI6_;if(t.eqr(+(1/0)))return Jmat.Complex(-(1/0));if(t.eqr(-(1/0)))return Jmat.Complex(-(1/0));var a=function(t){for(var a=Jmat.Complex.ZERO,m=t,e=.5>=r?30:50,n=1;e>n;n++){var i=m.divr(n*n);if(a=a.add(i),Jmat.Complex.near(i,Jmat.Complex.ZERO,1e-15))break;m=m.mul(t)}return a},r=t.abs();if(.5>r)return a(t);if(.5>1/r){var m=a(t.inv()).neg(),e=Jmat.Complex.log(t.neg());return m.sub(e.mul(e).divr(2)).sub(Jmat.Complex.PIPI6_)}var n=Jmat.Complex.ONE.sub(t),i=n.abs(),o=Jmat.Complex.ONE.sub(t).inv(),l=o.abs(),u=t.div(t.dec()),J=u.abs(),p=r,s=0;if(p>1/r&&(p=1/r,s=1),p>i&&(p=i,s=2),p>l&&(p=l,s=3),p>J&&(p=J,s=4),.8>p){if(0==s)return a(t);if(1==s){var m=a(t.inv()).neg(),e=Jmat.Complex.log(t.neg());return m.sub(e.mul(e).divr(2)).sub(Jmat.Complex.PIPI6_)}if(2==s){var m=a(n).neg(),x=Jmat.Complex.log(n),f=Jmat.Complex.log(t);return m.sub(x.mul(f)).add(Jmat.Complex.PIPI6_)}if(3==s){var m=a(o),x=Jmat.Complex.log(Jmat.Complex.ONE.sub(t)),f=Jmat.Complex.log(t.neg());return m.add(x.mul(x).divr(2)).sub(f.mul(x)).sub(Jmat.Complex.PIPI6_)}if(4==s){var m=a(u).neg(),e=Jmat.Complex.log(Jmat.Complex.ONE.sub(t));return m.sub(e.mul(e).divr(2))}}return Jmat.Complex.dilog(t.mul(t)).divr(2).sub(Jmat.Complex.dilog(t.neg()))},Jmat.Complex.trilog=function(t){if(t.eqr(0))return Jmat.Complex.ZERO;if(t.eqr(1))return Jmat.Complex.APERY;if(t.eqr(+(1/0)))return Jmat.Complex(-(1/0));if(t.eqr(-(1/0)))return Jmat.Complex(-(1/0));var a=function(t){for(var a=Jmat.Complex.ZERO,m=t,e=.5>r?30:50,n=1;e>n;n++){var i=m.divr(n*n*n);if(a=a.add(i),Jmat.Complex.near(i,Jmat.Complex.ZERO,1e-15))break;m=m.mul(t)}return a},r=t.abs();if(.75>r)return a(t);if(.75>1/r){var m=a(t.inv()),e=Jmat.Complex.log(t.neg());return m.sub(e.mul(e).mul(e).divr(6)).sub(Jmat.Complex.PIPI6_.mul(e))}return Jmat.Complex.polylog_integral_(Jmat.Complex(3),t)},Jmat.Complex.bernoulli=[1,-0.5,1/6,0,-1/30,0,1/42,0,-1/30,0,5/66,0,-691/2730,0,7/6,0,-3617/510,0,43867/798,0,-174611/330,0,854513/138,0,-23749461029/2730,0,8615841276005/6,0,-8861288553.122988,0,179980998.3498813,0],Jmat.Complex.stieltjes=[.5772156649015329,-.07281584548367673,-.00969036319287232,.002053834420303346,.0023253700654673,.0007933238173010627,-.0002387693454301996,-.000527289567057751,-.0003521233538030395,-3439477441808805e-20,.0002053328149090648,.0002701844395439035,.0001672729121051402,-27463806603760158e-21,-.00020920926205929996,-.0002834686553202414,-.00019969685830896976,26277037109918338e-21,.0003073684081492528,.0005036054530473557,.00046634356151155945,.00010443776975600011,-.0005415995822039977,-.0012439620904082457,-.0015885112789035616,-.0010745919527384888,.0006568035186371545,.0034778369136185382,.00640006853170063,.007371151770472239,.003557728855573161,-.007513325997815229],Jmat.Complex.stieltjes_zeta=[.5772156649015329,.07281584548367673,-.00484518159643616,-.00034230573671722433,9689041939447084e-20,-66110318108421895e-22,-3.316240908752772e-7,1.0462094584479188e-7,-8.733218100273798e-9,9.47827778276236e-11,5.658421927608708e-11,-6.768689863513697e-12,3.4921159366720317e-13,4.4104247417577536e-15,-2.3997862217709992e-15,2.1677312200726828e-16,-9.544466076366965e-18,-7.387676660538637e-20,4.800850782488065e-20,-4.139956737713306e-21,1.9168201593991233e-22,-2.0441543122262165e-24,-4.818498501107353e-25,4.8118570515125666e-26,-2.560263310318815e-27,6.927840895304667e-29,1.6286075504855866e-30,-3.1939375611532554e-31,2.0991515893634255e-32,-8.33674529544144e-34,1.3412593772192187e-35,9.137143891298173e-37],Jmat.Complex.polylog_integral_=function(t,a){if(t.re>1&&Math.abs(t.im)<t.re&&Math.abs(a.arg())>.1){var r=Jmat.Complex.gamma(t),m=Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(20),function(r){var m=r.pow(t.dec()).div(Jmat.Complex.exp(r).sub(a));return Jmat.Complex.isNaN(m)&&(m=Jmat.Complex.ZERO),m},100);return a.div(r).mul(m)}if(Jmat.Complex.isNegative(t)&&Math.abs(a.arg())>.1){var e=Jmat.Complex.log(a.neg()),m=Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(20),function(a){var r=a.pow(t.neg()),m=Jmat.Complex.sin(t.mulr(Math.PI/2).sub(a.mul(e))),n=Jmat.Complex.sinh(a.mulr(Math.PI)),i=r.mul(m).div(n);return Jmat.Complex.isNaN(i)&&(i=Jmat.Complex.ZERO),i},100);return m}if(a.im<=0||t.re>0&&Math.abs(t.im)<t.re){var e=Jmat.Complex.log(a.neg()),n=function(a){var r=Jmat.Complex.sin(t.mul(Jmat.Complex.atan(a)).sub(a.mul(e))),m=Jmat.Complex.ONE.add(a.mul(a)).pow(t.divr(2)),n=Jmat.Complex.sinh(a.mulr(Math.PI)),i=r.div(m).div(n);return Jmat.Complex.isNaN(i)&&(i=Jmat.Complex.ZERO),i},m=Jmat.Complex.ZERO;return m=m.add(Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(5),n,50)),m=m.add(Jmat.Complex.integrate(Jmat.Complex(5),Jmat.Complex(20),n,20)),m=m.add(Jmat.Complex.integrate(Jmat.Complex(20),Jmat.Complex(100),n,10)),a.mulr(.5).add(a.mul(m))}if(a.im>0){var i=Jmat.Complex.log(a),n=function(a){var r=Jmat.Complex.sin(t.mul(Jmat.Complex.atan(a)).sub(a.mul(i))),m=Jmat.Complex.ONE.add(a.mul(a)).pow(t.divr(2)),e=Jmat.Complex.exp(a.mulr(2*Math.PI)).sub(1),n=r.div(m).div(e);return Jmat.Complex.isNaN(n)&&(n=Jmat.Complex.ZERO),n},m=Jmat.Complex.ZERO;m=m.add(Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(5),n,50)),m=m.add(Jmat.Complex.integrate(Jmat.Complex(5),Jmat.Complex(20),n,20)),m=m.add(Jmat.Complex.integrate(Jmat.Complex(20),Jmat.Complex(100),n,10));var r=Jmat.Complex.incgamma_upper(Jmat.Complex.ONE.sub(t),i.neg()),o=i.neg().pow(Jmat.Complex.ONE.sub(t));return a.mulr(.5).add(r.div(o)).add(a.mulr(2).mul(m))}return Jmat.Complex(NaN)},Jmat.Complex.polylog_borwein_=function(t,a){var r=a.mul(a).div(a.dec()).abs();if(r>=3.7)return Jmat.Complex(NaN);var m=Math.floor(Math.min(31,16/r)),e=[];e[0]=Jmat.Complex.ONE;for(var n=Jmat.Complex.ONE,i=Jmat.Complex.ONE,o=Jmat.Complex.ZERO,l=1;m>=l;l++){i=i.mul(a);var u=i.div(Jmat.Complex(l).pow(t));o=o.add(u);var J=Jmat.Complex.binomial(Jmat.Complex(m),Jmat.Complex(l)),p=J.mul(i);l%2&&(p=p.neg()),n=n.add(p),e[l]=n}var s=Jmat.Complex.ZERO;for(l=m+1;2*m>=l;l++){i=i.mul(a);var u=i.div(Jmat.Complex(l).pow(t));n=e[2*m-l],u=u.mul(n),s=s.add(u)}var x=a.dec().inv().powr(m);s=s.mul(x);var f;return f=m%2?o.sub(s):o.add(s)},Jmat.Complex.polylog_borwein_ok_=function(t,a){var r=a.mul(a).div(a.dec()).abs();return t.re>=-5&&0==a.im&&1.5>=r||t.re>=0&&Math.abs(t.im)<t.re&&2>=r||a.abs()<=.5},Jmat.Complex.polylog_residue_=function(t,a){var r=!1,m=a;0==t.im&&0==a.im&&(a=a.add(Jmat.Complex.newi(-1e-4)),(Jmat.Complex.isNegativeInt(t)||a.re<0)&&(r=!0));for(var e=Jmat.Complex.log(a),n=Jmat.Complex.gamma(Jmat.Complex.ONE.sub(t)),i=Jmat.Complex.ZERO,o=0;30>o;o++)i=m.im>0?i.add(Jmat.Complex.newi(2*o*Math.PI).sub(e).pow(t.dec())):i.add(Jmat.Complex.newi(-2*o*Math.PI).sub(e).pow(t.dec()));var l=n.mul(i);return r&&0!=l.im&&(l=Jmat.Complex(l.re)),l},Jmat.Complex.polylog=function(t,a){if(Jmat.Complex.isInt(t)){if(t.eqr(0))return a.div(Jmat.Complex.ONE.sub(a));if(t.eqr(1))return Jmat.Complex.log(Jmat.Complex.ONE.sub(a)).neg();if(t.eqr(2))return Jmat.Complex.dilog(a);if(t.eqr(3))return Jmat.Complex.trilog(a);if(t.eqr(-1)){var r=Jmat.Complex.ONE.sub(a);return a.div(r).div(r)}if(t.eqr(-2)){var r=Jmat.Complex.ONE.sub(a);return a.mul(a.inc()).div(r).div(r).div(r)}if(t.eqr(-3)){var r=Jmat.Complex.ONE.sub(a),m=r.mul(r);return a.mul(Jmat.Complex.ONE.add(a.mulr(4)).add(a.mul(a))).div(m).div(m)}if(t.eqr(-4)){var r=Jmat.Complex.ONE.sub(a),m=r.mul(r);return a.mul(a.inc()).mul(Jmat.Complex.ONE.add(a.mulr(10)).add(a.mul(a))).div(m).div(m).div(r)}}if(t.re>1&&a.eqr(0))return Jmat.Complex(0);if(t.re>1&&a.eqr(1))return Jmat.Complex.zeta(t);var e=a.abs();if(.5>=e&&t.re>=-10||.75>e&&t.re>=-2||.9>e&&t.re>-1){for(var n=Jmat.Complex.ZERO,i=a,o=.5>=e?30:50,l=1;o>l;l++){var u=i.div(Jmat.Complex(l).pow(t));if(n=n.add(u),Jmat.Complex.near(u,Jmat.Complex.ZERO,1e-15))break;i=i.mul(a)}return n}if(Jmat.Complex.polylog_borwein_ok_(t,a))return Jmat.Complex.polylog_borwein_(t,a);if(t.re<0)return Jmat.Complex.polylog_residue_(t,a);if(Jmat.Complex.isNegativeInt(t)&&e>1){var J=Jmat.Complex.isOdd(t)?1:-1;return Jmat.Complex.polylog(t,a.inv()).mulr(J)}return Jmat.Complex.polylog_integral_(t,a)},Jmat.Complex.theta1=function(t,a){if(t.im>1)return Jmat.Complex.theta1(t.neg(),a).neg();for(var r=Jmat.Complex(0),m=Jmat.Complex(1),e=0;20>e;e++){var n=a.powr((e+.5)*(e+.5)),i=Jmat.Complex.sin(t.mulr(2*e+1));r=r.add(m.mul(n).mul(i)),m=m.neg()}return r.mulr(2)},Jmat.Complex.theta2=function(t,a){if(t.im>1)return Jmat.Complex.theta2(t.neg(),a);for(var r=Jmat.Complex(0),m=0;20>m;m++){var e=a.powr((m+.5)*(m+.5)),n=Jmat.Complex.cos(t.mulr(2*m+1));r=r.add(e.mul(n))}return r.mulr(2)},Jmat.Complex.theta3=function(t,a){if(t.im>1)return Jmat.Complex.theta3(t.neg(),a);for(var r=Jmat.Complex(0),m=0;20>m;m++){var e=a.powr(m*m),n=Jmat.Complex.cos(t.mulr(2*m));r=r.add(e.mul(n))}return r.mulr(2).addr(1)},Jmat.Complex.theta4=function(t,a){if(t.im>1)return Jmat.Complex.theta4(t.neg(),a);for(var r=Jmat.Complex(0),m=Jmat.Complex(1),e=0;20>e;e++){var n=a.powr(e*e),i=Jmat.Complex.cos(t.mulr(2*e));r=r.add(m.mul(n).mul(i)),m=m.neg()}return r.mulr(2).addr(1)},Jmat.Complex.isPrime=function(t){return Jmat.Complex.isReal(t)?Jmat.Real.isPrime(t.re):0},Jmat.Complex.decompose=function(t,a){if(Math.abs(t.re)>=Math.abs(t.im)){var r=Jmat.Real.decompose(t.re,a),m=Math.round(t.im*r[1]);return[Jmat.Complex(r[0],m),Jmat.Complex(r[1])]}var r=Jmat.Real.decompose(t.im,a),e=Math.round(t.re*r[1]);return[Jmat.Complex(e,r[0]),Jmat.Complex(r[1])]},Jmat.Complex.permutation=function(t,a){return Jmat.Complex.gammaDiv_(t.inc(),t.sub(a).inc())},Jmat.Complex.binomial=function(t,a){if(Jmat.Complex.isPositiveIntOrZero(t)&&Jmat.Complex.isPositiveIntOrZero(a)&&a.re<=t.re&&t.re<30)return Jmat.Complex(Jmat.Real.pascal_triangle(t.re,a.re));var r=Jmat.Complex.gammaDiv12_(t.inc(),a.inc(),t.sub(a).inc());
return r.re>100&&Jmat.Complex.isPositiveInt(t)&&Jmat.Complex.isPositiveInt(a)&&t.re>a.re&&(r=Jmat.Complex.round(r)),r},Jmat.Complex.stirling2=function(t,a){if(!Jmat.Complex.isInt(a))return Jmat.Complex(NaN);var r=Jmat.Complex.ZERO,m=Jmat.Real.isOdd(a.re)?-1:1,e=Jmat.Complex(0);for(e.re=0;e.re<=a.re;e.re++)r=r.add(Jmat.Complex.binomial(a,e).mul(e.pow(t)).mulr(m)),m*=-1;return r.div(Jmat.Complex.factorial(a))},Jmat.Complex.manhattan=function(t,a){return Math.max(Math.abs(t.re-a.re),Math.abs(t.im-a.im))},Jmat.Complex.near=function(t,a,r){return t.re-r<=a.re&&t.re+r>=a.re&&t.im-r<=a.im&&t.im+r>=a.im},Jmat.Complex.relnear=function(t,a,r){return t.eq(a)?!0:t.sub(a).abs()<Math.max(t.abs(),a.abs())*r},Jmat.Complex.lambertwb_generic_=function(t,a,r){if(t.isReal(r)&&r.re>-.36&&0==a)return t(Jmat.Real.lambertw(r));if(!Jmat.Real.isInt(a))return t(NaN);if(t.isNaN(r))return NaN;if(t.isInf(r))return t(1/0);if(0==a&&0==r.re&&0==r.im)return t(0);if(0!=a&&0==r.re&&0==r.im)return t(-(1/0));var m=t.log(r).add(t(0,a*Math.PI*2));0==a&&r.abs()<1.2&&(m=t.sqrt(r.mulr(5.43656365691809).addr(2)).add(t(-1,a*Math.PI*2))),0!=a&&0==r.im&&(r.im+=1e-14);for(var e=36,n=0;e>n;n++){var i=t.exp(m),o=m.mul(i),l=o.sub(r),u=i.mul(m.addr(1)),J=m.addr(2).mul(l).div(m.mulr(2).addr(2));m=m.sub(l.div(u.sub(J)));var p=t.log(r.div(m));if(t.near(p,m,1e-16)||t.near(o,r,1e-16))break;if(n+1==e&&!t.near(p,m,1)&&!t.near(o,r,1))return t(NaN)}return 0==r.im&&r.re>=0&&(m.im=0),m},Jmat.Complex.lambertwb=function(t,a){return Jmat.Complex.lambertwb_generic_(Jmat.Complex,t,a)},Jmat.Complex.lambertw=function(t){return Jmat.Complex.lambertwb(0,t)},Jmat.Complex.lambertwm=function(t){return Jmat.Complex.lambertwb(-1,t)},Jmat.Complex.tetration=function(t,a){if(Jmat.Complex.isPositive(t)&&Jmat.Complex.isPositiveInt(a)&&a.re!=1/0)return Jmat.Complex(Jmat.Real.tetration(t.re,a.re));if(a.eqr(0))return Jmat.Complex(1);if(a.eqr(1))return t;if(a.eqr(2))return t.pow(t);if(Jmat.Complex.isReal(t)&&t.re>=2&&a>5)return Jmat.Complex(1/0);if(t.eqr(0)&&Jmat.Complex.isPositiveInt(a))return Jmat.Complex.isEven(a)?Jmat.Complex(1):Jmat.Complex(0);if(a.eqr(1/0)){if(t.eqr(1))return Jmat.Complex(1);var r=Jmat.Complex.log(t);return Jmat.Complex.lambertw(r.neg()).div(r.neg())}var m=function(t,a,r,m){for(var e,n=a,i=0;r>i;i++){if(n=m?Jmat.Complex.logy(n,t):t.pow(n),Jmat.Complex.isNaN(n))return n;if(n.eq(e))return n;if(e=n,i>1e3)return Jmat.Complex(NaN)}return n};if(Jmat.Complex.isPositiveInt(a))return m(t,t,a.re-1,!1);if(Jmat.Complex.isReal(a)){if(a.eqr(-1))return Jmat.Complex(0);if(a.re>-1&&a.re<=0)return a.inc();if(a.re>0){var e=a.sub(Jmat.Complex.floor(a));return m(t,e,Math.ceil(a.re),!1)}if(a.re<=-1){var e=a.sub(Jmat.Complex.floor(a));return m(t,e,-Math.ceil(a.re),!0)}}if(Jmat.Complex.near(t,Jmat.Complex.E,1e-15)){var e,n=[.30685281944005,.59176735125832,.3964832129017,.17078658150959,.08516537613999,.03804195209047,.01734090876306,.00755271038865,.00328476064839,.0013936174017,.00058758348148,.00024379186661,.00024379186661,.00010043966462,1654344436e-14,663102846e-14,264145664e-14,104446533e-14,4.1068839e-7,1.6048059e-7,6.239367e-8,2.412797e-8,9.28797e-9,3.5585e-9,1.35774e-9,5.1587e-10],i=[Jmat.Complex(.37090658903229,1.33682167078891),Jmat.Complex(.01830048268799,.06961107694975),Jmat.Complex(-.0422210796016,.02429633404907),Jmat.Complex(-.01585164381085,-.01478953595879),Jmat.Complex(.00264738081895,-.0065755813052),Jmat.Complex(.00182759574799,-.00025319516391),Jmat.Complex(.0003656299477,.0002824651581),Jmat.Complex(2689538943e-14,.00014180498091),Jmat.Complex(-3139436775e-14,3583704949e-14),Jmat.Complex(-1376358453e-14,-183512708e-14),Jmat.Complex(-18029098e-13,-314787679e-14),Jmat.Complex(2.639887e-7,-9.2613311e-7),Jmat.Complex(2.4961828e-7,-1.3664223e-7),Jmat.Complex(6.37479e-9,2.270476e-8),Jmat.Complex(-3.41142e-9,5.12289e-9),Jmat.Complex(-1.62203e-9,3.1619e-10),Jmat.Complex(-3.8743e-10,-2.7282e-10),Jmat.Complex(-1.201e-11,-1.344e-10),Jmat.Complex(2.57e-11,-2.543e-11),Jmat.Complex(9.35e-12,4.5e-13),Jmat.Complex(1.7e-12,1.86e-12),Jmat.Complex(-5e-14,7.1e-13),Jmat.Complex(-1.6e-13,1.2e-13),Jmat.Complex(-5e-14,-1e-14),Jmat.Complex(-1e-14,-1e-14)],o=[Jmat.Complex(.31813150520476413,1.3372357014306895),Jmat.Complex(1),Jmat.Complex(-.15131489715565175,-.2967488367322413),Jmat.Complex(-.03697630940906762,.09873054431149697),Jmat.Complex(.02581159797314014,-.017386962126530753),Jmat.Complex(-.0079444196,.00057925018)],l=function(t){var a=Jmat.Complex(1.077961437528,-.94654096394782),r=Jmat.Complex(.12233176,-.02366108),m=o[0],e=Jmat.Complex.exp(m.mul(t).add(a)),n=r.mul(e).mul(Jmat.Complex.exp(t.mul(Jmat.Complex.newi(2*Math.PI))));return Jmat.Complex.powerSeries(o,o.length,Jmat.Complex.ZERO,e).add(n)},u=Jmat.Complex(Jmat.Real.fracn(a.re),a.im);return e=a.im<-4.5?l(u.conj()).conj():a.im<-1.5?Jmat.Complex.powerSeries(i,i.length,Jmat.Complex.newi(3),u.conj()).conj():a.im<1.5?Jmat.Complex.log(u.addr(2)).add(Jmat.Complex.powerSeries(n,n.length,Jmat.Complex.ZERO,u)):a.im<4.5?Jmat.Complex.powerSeries(i,i.length,Jmat.Complex.newi(3),u):l(u),a.re>0?m(t,e,Math.floor(a.re),!1):m(t,e,-Math.ceil(a.re),!0)}return Jmat.Complex(NaN)},Jmat.Complex.faddeeva=function(t){var a=2/Jmat.Real.SQRTPI,r=t.re*t.re+t.im*t.im*2;if(3.5>r){for(var m=Jmat.Complex.ZERO,e=1,n=1,i=Jmat.Complex.I.mul(t).neg(),o=i,l=0;20>l;l++)l>0&&(n*=l,e=-e,o=o.mul(i).mul(i)),m=m.add(o.mulr(e/(n*(2*l+1))));var u=Jmat.Complex.exp(t.mul(t).neg());return u.sub(u.mul(m).mulr(a))}for(var J=Jmat.Complex(Math.abs(t.re),Math.abs(t.im)),p=40>r?40:80>r?20:10,s=Jmat.Complex(0),l=0;p>l;l++){var x=Jmat.Complex(J.im+s.re,J.re-s.im);s=x.mulr(.5/x.abssq())}if(s=s.mulr(a),0==J.im&&(s.re=Math.exp(-J.re*J.re)),t.im<0){var u=Jmat.Complex.exp(J.mul(J).neg()).mulr(2);s=u.sub(s),t.re>0&&(s.im=-s.im)}else t.re<0&&(s.im=-s.im);return s},Jmat.Complex.erfcx=function(t){return Jmat.Complex.faddeeva(Jmat.Complex(-t.im,t.re))},Jmat.Complex.erf=function(t){if(0==t.im)return Jmat.Complex(Jmat.Real.erf(t.re));if(0==t.re)return Jmat.Complex.I.mulr(Jmat.Real.erfi(t.im));var a=Jmat.Complex.exp(t.mul(t).neg());return t.re>=0?Jmat.Complex.ONE.sub(a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I)))):a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I.neg()))).sub(Jmat.Complex.ONE)},Jmat.Complex.erfc=function(t){if(0==t.im)return Jmat.Complex(Jmat.Real.erfc(t.re));var a=Jmat.Complex.exp(t.mul(t).neg());return t.re>=0?a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I))):Jmat.Complex.TWO.sub(a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I.neg()))))},Jmat.Complex.erf_inv=function(t){if(0!=t.im&&Math.abs(t.re)>1){var a=function(t){return Jmat.Complex.TWO.divr(Jmat.Real.SQRTPI).mul(Jmat.Complex.exp(t.mul(t).neg()))},r=t.re<0;r&&(t=t.neg());var m=Jmat.Complex.sqrt(Jmat.Complex.log(t.mulr(Jmat.Real.SQRTPI).mul(Jmat.Complex.ONE.sub(t))).neg()),e=Jmat.Complex.finvert_newton(t,Jmat.Complex.erf,a,m);return r&&(e=e.neg()),e}if(0==t.im){if(0==t.re)return Jmat.Complex(0);if(1==t.re)return Jmat.Complex(1/0);if(-1==t.re)return Jmat.Complex(-(1/0))}var n=[.886226899,-1.645349621,.914624893,-.140543331],i=[1,-2.118377725,1.442710462,-.329097515,.012229801],o=[-1.970840454,-1.62490649,3.429567803,1.641345311],l=[1,3.5438892,1.6370678],u=t.abs();if(.7>=u){var J=t.mul(t),p=t.mul(J.mulr(n[3]).addr(n[2]).mul(J).addr(n[1]).mul(J).addr(n[0]));p=p.div(J.mulr(i[4]).addr(i[3]).mul(J).addr(i[2]).mul(J).addr(i[1]).mul(J).addr(i[0]))}else{var s=Jmat.Complex.sqrt(Jmat.Complex.log(Jmat.Complex.ONE.sub(t).divr(2)).neg()),p=s.mulr(o[3]).addr(o[2]).mul(s).addr(o[1]).mul(s).addr(o[0]);p=p.div(s.mulr(l[2]).addr(l[1]).mul(s).addr(l[0]))}return p},Jmat.Complex.erfc_inv=function(t){return Jmat.Complex.erf_inv(Jmat.Complex.ONE.sub(t))},Jmat.Complex.erfi=function(t){return Jmat.Complex.isReal(t)?Jmat.Complex(Jmat.Real.erfi(t.re)):Jmat.Complex.erf(t.mul(Jmat.Complex.I)).mul(Jmat.Complex.I).neg()},Jmat.Complex.dawson=function(t){if(Jmat.Complex.isReal(t))return Jmat.Complex(Jmat.Real.dawson(t.re));var a=Jmat.Complex.faddeeva(t),r=Jmat.Complex.exp(t.mul(t).neg());return r.sub(a).mul(Jmat.Complex.I.mulr(Jmat.Real.SQRTPI/2))},Jmat.Complex.minkowski=function(t){return Jmat.Complex(Jmat.Real.minkowski(t.re),Jmat.Real.minkowski(t.im))},Jmat.Complex.rootfind_bisection=function(t,a,r,m,e){var n=void 0==m?256:m,i=void 0==e?1e-9:e,o=t.re,l=a.re;if(o>l){var u=o;o=l,l=u}if(l-o==1/0)return Jmat.Complex(NaN);for(var J=NaN,p=NaN,s=0,x=0,f=0;n>f;f++){var c=o+f*(l-o)/n,C=r(Jmat.Complex(c)).re;if(Jmat.Real.near(C,0,i))return Jmat.Complex(c);C>s&&(J=c,s=C),x>C&&(p=c,x=C)}if(p!=p||J!=J)return Jmat.Complex(NaN);for(;;){var c=(p+J)/2,C=r(Jmat.Complex(c)).re;if(Jmat.Real.near(C,0,i))return Jmat.Complex(c);if(C>0&&(J=c),0>C&&(p=c),Jmat.Real.near(p,J,i))return Jmat.Complex(NaN)}},Jmat.Complex.rootfind_secant=function(t,a,r,m,e){m=m||30,e=e||1e-15;for(var n=r(t),i=r(a),o=0;m>o;o++){var l=t.mul(i).sub(a.mul(n)).div(i.sub(n));Jmat.Complex.isInfOrNaN(l);var u=r(l);if(Jmat.Real.near(u,0,e))return l;t=a,n=i,a=l,i=u}return a},Jmat.Complex.rootfind=function(t,a){a||(a={});var r=a.z0||Jmat.Complex.ZERO,m=a.maxit||30,e=void 0==a.prec?1e-9:a.prec;return a.real&&void 0!=a.z1?Jmat.Complex.rootfind_bisection(r,a.z1,t,m,e):a.df?Jmat.Complex.rootfind_newton(t,a.df,r,m):Jmat.Complex.rootfind_newton_noderiv(t,r,m)},Jmat.Complex.newtonStartValues_=[Jmat.Complex(0),Jmat.Complex(.1),Jmat.Complex(-.1),Jmat.Complex.newi(.1),Jmat.Complex.newi(-.1),Jmat.Complex(.1,.1),Jmat.Complex(.1,-.1),Jmat.Complex(-.1,.1),Jmat.Complex(-.1,-.1),Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)],Jmat.Complex.newtonStartValue_=function(t){for(var a=Jmat.Complex.newtonStartValues_,r=1/0,m=Jmat.Complex(NaN),e=0;e<a.length;e++){var n=a[e],i=t(n),o=Jmat.Complex.manhattan(i,Jmat.Complex.ZERO);r>o&&(r=o,m=n)}return m},Jmat.Complex.newtonStartValuesAround_=[Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)],Jmat.Complex.newtonStartValueAround_=function(t,a,r){for(var m=Jmat.Complex.newtonStartValuesAround_,e=1/0,n=Jmat.Complex(NaN),i=0;i<m.length;i++){var o=a.add(m[i].mulr(r)),l=t(o),u=Jmat.Complex.manhattan(l,Jmat.Complex.ZERO);e>u&&(e=u,n=o)}return n},Jmat.Complex.rootfind_newton=function(t,a,r,m){r||(r=Jmat.Complex.ZERO),m||(m=30);for(var e=r,n=e,i=1/0,o=Jmat.Complex(NaN),l=0;m>l;l++){var u=t(e),J=Jmat.Complex.manhattan(u,Jmat.Complex.ZERO);if(Jmat.Real.near(J,0,1e-15))return e;i>J&&(i=J,o=e);var p=e.sub(u.div(a(e)));if(Jmat.Complex.isInfOrNaN(p)){var J=Jmat.Complex.manhattan(e,n);p=Jmat.Complex.newtonStartValueAround_(t,e,J?J:.1)}e=p,n=e}return o},Jmat.Complex.rootfind_newton_noderiv=function(t,a,r){return Jmat.Complex.rootfind_newton(t,function(a){return Jmat.Complex.differentiate_stencil5(a,t)},a,r)},Jmat.Complex.finvert_newton=function(t,a,r,m,e){return Jmat.Complex.rootfind_newton(function(r){return a(r).sub(t)},r,m,e)},Jmat.Complex.finvert_newton_noderiv=function(t,a,r,m){return Jmat.Complex.rootfind_newton_noderiv(function(r){return a(r).sub(t)},r,m)},Jmat.Real.integrate_simpson=function(t,a,r,m,e){for(var n=(a-t)/r,i=0,o=0,l=0;r>=l;l++){var u=t+(l-1)*n,J=t+l*n,p=m((u+J)/2),s=m(J);if(l>0&&(i+=(J-u)/6*(o+4*p+s)),o=s,e&&l%50==49&&e())return NaN}return i},Jmat.Real.integrate=function(t,a,r,m){return m||(m=30),Jmat.Real.integrate_simpson(t,a,m,r)},Jmat.Complex.integrate_simpson=function(t,a,r,m,e){for(var n,i,o=a.sub(t).divr(r),l=Jmat.Complex(0),u=null,J=0;r>=J;J++){a.eqr(1/0)?(n=i?i:t,i=i?i.mulr(2):t.addr(.1)):(n=t.add(o.mulr(J-1)),i=t.add(o.mulr(J)));var p=m(n.add(i).divr(2)),s=m(i);if(J>0){var x=i.sub(n).divr(6).mul(u.add(p.mulr(4)).add(s));l=l.add(x)}if(u=s,e&&J%50==49&&e())return Jmat.Complex(NaN)}return l},Jmat.Complex.integrate=function(t,a,r,m){return m||(m=30),Jmat.Complex.integrate_simpson(t,a,m,r)},Jmat.Complex.differentiate_newton_noderiv=function(t,a){var r=Math.max(.01,Math.abs(t.re))/1e3,m=a(t.addr(r/2)),e=a(t.subr(r/2));return m.sub(e).divr(r)},Jmat.Complex.differentiate_stencil5=function(t,a){var r=Math.max(.01,Math.abs(t.re))/1e3,m=a(t.addr(2*r)).neg(),e=a(t.addr(r)).mulr(8),n=a(t.subr(r)).mulr(-8),i=a(t.subr(2*r));return m.add(e).add(n).add(i).divr(12*r)},Jmat.Complex.differentiate2nd_stencil5=function(t,a){var r=Jmat.Complex(Math.max(.01,Math.abs(t.re))/1e3),m=a(t.add(r.mulr(2))).neg(),e=a(t.add(r)).mulr(16),n=a(t).mulr(-30),i=a(t.sub(r)).mulr(16),o=a(t.sub(r.mulr(2))).neg();return m.add(e).add(n).add(i).add(o).div(r.mul(r).mulr(12))},Jmat.Complex.differentiate=function(t,a){return Jmat.Complex.differentiate_stencil5(t,a)},Jmat.Complex.doSummation=function(t,a,r,m,e){if(0==r)return Jmat.Complex(NaN);if(0>r)return Jmat.Complex(NaN);if(!Jmat.Complex.isReal(t)||!Jmat.Complex.isReal(a))return Jmat.Complex(NaN);for(var n=t.re,o=a.re,l=Jmat.Complex(0),u=n;o+r/4>=u;u+=r){var J=m(Jmat.Complex(u));if(l=l.add(J),e&&i%50==49&&e())return Jmat.Complex(NaN)}return l},Jmat.Complex.doProduct=function(t,a,r,m,e){if(0==r)return Jmat.Complex(NaN);if(0>r)return Jmat.Complex(NaN);if(!Jmat.Complex.isReal(t)||!Jmat.Complex.isReal(a))return Jmat.Complex(NaN);for(var n=t.re,o=a.re,l=Jmat.Complex.ONE,u=n;o+r/4>=u;u+=r){var J=m(Jmat.Complex(u));if(l=l.mul(J),e&&i%50==49&&e())return Jmat.Complex(NaN)}return l},Jmat.Complex.powerSeries=function(t,a,r,m){for(var e=void 0==t[0].re,n=Jmat.Complex.ZERO,i=Jmat.Complex.ONE,o=0;a>o;o++)n=e?n.add(i.mulr(t[o])):n.add(i.mul(t[o])),i=i.mul(m.sub(r));return n},Jmat.Complex.pdf_uniform=function(t,a,r){return t.re>=a.re&&t.re<=r.re?r.sub(a).inv():Jmat.Complex(0)},Jmat.Complex.cdf_uniform=function(t,a,r){return t.re<a.re?Jmat.Complex(0):t.re<r.re?t.sub(a).div(r.sub(a)):Jmat.Complex(1)},Jmat.Complex.qf_uniform=function(t,a,r){var m=a.add(t.mul(r.sub(a)));return m.re>=a.re&&m.re<=r.re?m:Jmat.Complex(NaN)},Jmat.Complex.pdf_standardnormal=function(t){return Jmat.Complex.exp(t.mul(t).mulr(-.5)).mul(Jmat.Complex.INVSQRT2PI)},Jmat.Complex.cdf_standardnormal=function(t){return Jmat.Complex.erf(t.div(Jmat.Complex.SQRT2)).addr(1).mulr(.5)},Jmat.Complex.qf_standardnormal=function(t){return Jmat.Complex.erf_inv(t.mulr(2).subr(1)).mul(Jmat.Complex.SQRT2)},Jmat.Complex.pdf_normal=function(t,a,r){var m=Jmat.Complex.INVSQRT2PI.div(r),e=t.sub(a).mul(t.sub(a)).div(r.mul(r).mulr(2));return m.mul(Jmat.Complex.exp(e.neg()))},Jmat.Complex.cdf_normal=function(t,a,r){var m=t.sub(a).divr(r.abs()).div(Jmat.Complex.SQRT2);return Jmat.Complex.erf(m).addr(1).mulr(.5)},Jmat.Complex.qf_normal=function(t,a,r){return Jmat.Complex.exp(a.add(r.mul(Jmat.Complex.qf_standardnormal(t))))},Jmat.Complex.pdf_lognormal=function(t,a,r){var m=Jmat.Complex.INVSQRT2PI.div(r).div(t),e=Jmat.Complex.log(t).sub(a);return m.mul(Jmat.Complex.exp(e.mul(e).div(r.mul(r).mulr(2)).neg()))},Jmat.Complex.cdf_lognormal=function(t,a,r){var m=Jmat.Complex.log(t).sub(a).div(Jmat.Complex.SQRT2.mul(r));return Jmat.Complex.erf(m).addr(1).mulr(.5)},Jmat.Complex.qf_lognormal=function(t,a,r){var m=Jmat.Complex.log(t).sub(a).div(Jmat.Complex.SQRT2.mul(r));return Jmat.Complex.erf(m).addr(1).mulr(.5)},Jmat.Complex.pdf_cauchy=function(t,a,r){var m=t.sub(a),e=m.mul(m).add(r.mul(r)).mulr(Math.PI);return r.div(e)},Jmat.Complex.cdf_cauchy=function(t,a,r){return Jmat.Complex.atan(t.sub(a).div(r)).divr(Math.PI).addr(.5)},Jmat.Complex.qf_cauchy=function(t,a,r){return a.add(r.mul(Jmat.Complex.tan(t.subr(.5).divr(Math.PI))))},Jmat.Complex.pdf_studentt_cache_=[],Jmat.Complex.pdf_studentt_cachefun_=function(t){var a=t.inc().divr(2);return Jmat.Complex.gammaDiv_(a,t.divr(2))},Jmat.Complex.pdf_studentt=function(t,a){if(a.eqr(1))return t.mul(t).addr(1).mulr(Math.PI).inv();if(a.eqr(2))return t.mul(t).addr(2).powr(1.5).inv();if(a.eqr(3)){var r=10.392304845413264,m=t.mul(t).addr(3);return Jmat.Complex(r).div(m.mul(m).mulr(Math.PI))}if(a.eqr(1/0))return Jmat.Complex.pdf_standardnormal(t);var e=a.inc().divr(2),n=Jmat.Complex.calcCache_(a,Jmat.Complex.pdf_studentt_cachefun_,Jmat.Complex.pdf_studentt_cache_),i=Jmat.Complex.sqrt(Jmat.Complex.PI.mul(a)).inv(),o=n.mul(i);Jmat.Complex.isNaN(o)&&a.re>100&&(o=Jmat.Complex(Jmat.Complex.INVSQRT2PI));var l=t.mul(t).div(a).inc();return o.mul(l.pow(e.neg()))},Jmat.Complex.cdf_studentt=function(t,a){if(a.eqr(1))return Jmat.Complex.atan(t).divr(Math.PI).addr(.5);if(a.eqr(2))return t.div(Jmat.Complex.sqrt(t.mul(t).addr(2)).mulr(2)).addr(.5);if(a.eqr(1/0))return Jmat.Complex.cdf_standardnormal(t);if(t.eqr(0))return Jmat.Complex(.5);var r=Jmat.Complex.calcCache_(a,Jmat.Complex.pdf_studentt_cachefun_,Jmat.Complex.pdf_studentt_cache_),m=Jmat.Complex.incbeta(t.mul(t).div(a).neg(),Jmat.Complex(.5),Jmat.Complex.ONE.sub(a).mulr(.5)),e=Jmat.Complex.I.mul(t).mul(m),n=Jmat.Complex(t.abs()).mulr(2).mul(Jmat.Complex.SQRTPI);return Jmat.Complex(.5).sub(r.mul(e).div(n))},Jmat.Complex.qf_studentt=function(t,a){if(a.eqr(1))return Jmat.Complex.tan(Jmat.Complex.PI.mul(t.subr(.5)));if(a.eqr(2)){var r=t.mulr(4).mul(Jmat.Complex.ONE.sub(t));return t.subr(.5).mulr(2).mul(Jmat.Complex.sqrt(Jmat.Complex(2).div(r)))}if(a.eqr(4)&&Jmat.Complex.isReal(t)){var r=t.mulr(4).mul(Jmat.Complex.ONE.sub(t)),m=Jmat.Complex.sqrt(r),e=Jmat.Complex.cos(Jmat.Complex(1/3).mul(Jmat.Complex.acos(m))).div(m);return Jmat.Complex.sign(t.subr(.5)).mulr(2).mul(Jmat.Complex.sqrt(e.dec()))}if(a.eqr(1/0))return Jmat.Complex.qf_standardnormal(t);if(Jmat.Real.near(t.im,0,1e-15)&&(t=Jmat.Complex(t.re)),Jmat.Real.near(a.im,0,1e-15)&&(a=Jmat.Complex(a.re)),Jmat.Complex.isPositive(a)&&Jmat.Complex.isPositive(t)&&t.re<1){if(t.re<.5){var n=Jmat.Complex.beta_i_inv(t.mulr(2),a.divr(2),Jmat.Complex(.5));return Jmat.Complex.sqrt(a.mul(n.inv().subr(1))).neg()}var n=Jmat.Complex.beta_i_inv(Jmat.Complex.ONE.sub(t).mulr(2),a.divr(2),Jmat.Complex(.5));return Jmat.Complex.sqrt(a.mul(n.inv().subr(1)))}return Jmat.Complex(NaN)},Jmat.Complex.pdf_chi_square=function(t,a){var r=a.divr(2),m=r.eqr(1)?Jmat.Complex(2):Jmat.Complex(2).pow(r),e=Jmat.Complex.isNegativeInt(r)?Jmat.Complex(1/0):Jmat.Complex.gamma(r),n=t.pow(r.dec()).mul(Jmat.Complex.exp(t.divr(-2)));return m.mul(e).inv().mul(n)},Jmat.Complex.cdf_chi_square=function(t,a){return Jmat.Complex.gamma_p(a.divr(2),t.divr(2))},Jmat.Complex.qf_chi_square=function(t,a){return Jmat.Complex.gamma_p_inv(a.divr(2),t).mulr(2)},Jmat.Complex.pdf_logistic=function(t,a,r){var m=Jmat.Complex.exp(t.sub(a).div(r).neg()),e=m.inc();return m.div(r.mul(e).mul(e))},Jmat.Complex.cdf_logistic=function(t,a,r){return Jmat.Complex.tanh(t.sub(a).div(r).divr(2)).mulr(.5).addr(.5)},Jmat.Complex.qf_logistic=function(t,a,r){var m=t.div(Jmat.Complex.ONE.sub(t));return a.add(r.mul(Jmat.Complex.log(m)))},Jmat.Complex.pdf_gamma_cache_=[],Jmat.Complex.pdf_gamma=function(t,a,r){var m=t.pow(a.dec()),e=Jmat.Complex.exp(t.div(r).neg()),n=r.pow(a),i=Jmat.Complex.calcCache_(a,Jmat.Complex.gamma,Jmat.Complex.pdf_gamma_cache_);return m.mul(e).div(n).div(i)},Jmat.Complex.cdf_gamma=function(t,a,r){return Jmat.Complex.gamma_p(a,t.div(r))},Jmat.Complex.qf_gamma=function(t,a,r){return Jmat.Complex.gamma_p_inv(a,t).mul(r)},Jmat.Complex.pdf_beta=function(t,a,r){var m=t.pow(a.dec()),e=t.rsub(1).pow(r.dec()),n=Jmat.Complex.beta(a,r);return m.mul(e).div(n)},Jmat.Complex.cdf_beta=function(t,a,r){return Jmat.Complex.beta_i(t,a,r)},Jmat.Complex.qf_beta=function(t,a,r){return Jmat.Complex.beta_i_inv(t,a,r)},Jmat.Complex.pdf_fisher=function(t,a,r){var m=a.mul(t).pow(a).mul(r.pow(r)),e=a.mul(t).add(r).pow(a.add(r)),n=t.mul(Jmat.Complex.beta(a.divr(2),r.divr(2)));return Jmat.Complex.sqrt(m.div(e)).div(n)},Jmat.Complex.cdf_fisher=function(t,a,r){var m=a.mul(t).div(a.mul(t).add(r));return Jmat.Complex.beta_i(m,a.divr(2),r.divr(2))},Jmat.Complex.qf_fisher=function(t,a,r){var m=Jmat.Complex.beta_i_inv(t,a.divr(2),r.divr(2)),e=Jmat.Complex.ONE.sub(m);return r.mul(m).div(a.mul(e))},Jmat.Complex.pdf_weibull=function(t,a,r){var m=r.div(a),e=t.div(a).pow(r.dec()),n=t.div(a).pow(r).neg();return m.mul(e).mul(Jmat.Complex.exp(n))},Jmat.Complex.cdf_weibull=function(t,a,r){var m=t.div(a).pow(r).neg();return Jmat.Complex.ONE.sub(Jmat.Complex.exp(m))},Jmat.Complex.qf_weibull=function(t,a,r){var m=Jmat.Complex.ONE.sub(t),e=Jmat.Complex.log(m).neg().pow(r.inv());return a.mul(e)},Jmat.Complex.pdf_exponential=function(t,a){return t.re<0?Jmat.Complex(0):a.mul(Jmat.Complex.exp(t.mul(a).neg()))},Jmat.Complex.cdf_exponential=function(t,a){return t.re<0?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.exp(t.mul(a).neg()))},Jmat.Complex.qf_exponential=function(t,a){return Jmat.Complex.log(t.rsub(1)).neg().div(a)},Jmat.Complex.pdf_laplace=function(t,a,r){var m=Jmat.Complex.exp(Jmat.Complex(t.sub(a).abs()).neg().div(r));return r.mulr(2).inv().mul(m)},Jmat.Complex.cdf_laplace=function(t,a,r){var m=Jmat.Complex.exp(Jmat.Complex(t.sub(a).abs()).neg().div(r)),e=Jmat.Complex.sign(t.sub(a));return m.rsub(1).mul(e).mulr(.5).addr(.5)},Jmat.Complex.qf_laplace=function(t,a,r){var m=Jmat.Complex.log(Jmat.Complex(t.subr(.5).abs()).mulr(2).rsub(1)),e=Jmat.Complex.sign(t.subr(.5));return a.sub(r.mul(e).mul(m))},Jmat.Complex.pmf_bernoulli=function(t,a){return t.eqr(0)?a.rsub(1):t.eqr(1)?a:a.pow(t).mul(a.rsub(1).pow(t.rsub(1)))},Jmat.Complex.cdf_bernoulli=function(t,a){return t.re<0?Jmat.Complex.ZERO:t.re>=1?Jmat.Complex.ONE:a.rsub(1)},Jmat.Complex.qf_bernoulli=function(t,a){return t.re<1-a.re?Jmat.Complex.ZERO:Jmat.Complex.ONE},Jmat.Complex.pmf_binomial=function(t,a,r){var m=Jmat.Complex.binomial(a,t);return m.mul(r.pow(t)).mul(r.rsub(1).pow(a.sub(t)))},Jmat.Complex.cdf_binomial=function(t,a,r){return Jmat.Complex.beta_i(r,a.sub(t),t.addr(1))},Jmat.Complex.qf_binomial=function(t,a,r){if(r.eqr(0))return Jmat.Complex.ZERO;if(r.eqr(1))return a;var m=Jmat.Complex,e=Jmat.Complex.rootfind_bisection(m(0),a,function(m){return Jmat.Complex.cdf_binomial(m,a,r).sub(t)},100,1e-14);return Jmat.Complex.round(e)},Jmat.Complex.pmf_poisson=function(t,a){var r=a.pow(t),m=Jmat.Complex.factorial(t),e=Jmat.Complex.exp(a.neg());return r.mul(e).div(m)},Jmat.Complex.cdf_poisson=function(t,a){return Jmat.Complex.gamma_q(t.addr(1),a)},Jmat.Complex.qf_poisson=function(t,a){return Jmat.Complex.gamma_q_inva(a,t).subr(1)},Jmat.Matrix=function(t,a,r){if(!(this instanceof Jmat.Matrix))return Jmat.Matrix.make.apply(this,arguments);this.h=t,this.w=a,this.e=[];for(var m=0;t>m;m++)this.e[m]=[]},Jmat.Matrix.make=function(t,a,r){if(!t)return new Jmat.Matrix(0,0);if(t instanceof Jmat.Matrix)return Jmat.Matrix.copy(t);if("string"==typeof t)return Jmat.Matrix.parse(t);var m=function(t,a,r){return t&&void 0!=t[a]?Jmat.Complex.cast(void 0==t[a][r]?t[a]:t[a][r]):Jmat.Complex()},e=function(t,a,r){return t&&void 0!=t[a]?Jmat.Real.cast(void 0==t[a][r]?t[a]:t[a][r]):0},n=function(t,a,r,m){return new Jmat.Complex(e(t,r,m),e(a,r,m))},i=function(t){return t&&void 0!=t[0]?void 0==t[0].length?1:t[0].length:0},o=function(t,a,r,e,i){var o;if(e>=0&&r.length<t*a){if(o=Jmat.Matrix.zero(t,a),e>=0&&r.length-e==1){for(var l=0;a>l&&t>l;l++)o.e[l][l]=Jmat.Complex.cast(r[e]);return o}if(e>=0&&r.length-e==Math.min(t,a)){for(var l=0;a>l&&t>l;l++)o.e[l][l]=Jmat.Complex.cast(r[l+e]);return o}return null}o=new Jmat.Matrix(t,a);for(var u=0;u<o.h;u++)for(var l=0;l<o.w;l++)0>e?o.e[u][l]=i?n(r,i,u,l):m(r,u,l):o.e[u][l]=Jmat.Complex.cast(r[u*a+l+e]);return o};if("undefined"!=typeof t&&t.length||"undefined"!=typeof a&&a.length){var l=Math.max(t&&t.length||0,a&&a.length||0),u=Math.max(i(t),i(a));return o(l,u,t,-1,a)}if(void 0!=t&&void 0==a){var J=new Jmat.Matrix(1,1);return J.e[0][0]=Jmat.Complex.cast(t),J}if(void 0!=t&&void 0!=a){if(void 0==r)return new Jmat.Matrix(t,a);var l=t,u=a;return r&&r.length?o(l,u,r,0):o(l,u,arguments,2)}return new Jmat.Matrix(0,0)},Jmat.Matrix.toString=function(t){if(!t)return""+t;for(var a="[",r=0;r<t.h;r++){a+="[";for(var m=0;m<t.w;m++){var e=t.e[r][m];a+=Jmat.Complex.toString(e),m+1<t.w&&(a+=", ")}a+="]",r+1<t.h&&(a+=", ")}return a+"]"},Jmat.Matrix.prototype.toString=function(){return Jmat.Matrix.toString(this)},Jmat.Matrix.parse=function(t){for(var a=[],r=[a],m="",e=1;e<t.length-1&&r.length>0;e++){var n=t.charAt(e);if("["==n){var i=[];r[r.length-1].push(i),r.push(i)}else"]"==n?(""!=m&&(r[r.length-1].push(Jmat.Complex.parse(m)),m=""),r.pop()):","==n?""!=m&&(r[r.length-1].push(Jmat.Complex.parse(m)),m=""):m+=n}return""!=m&&r[r.length-1].push(Jmat.Complex.parse(m)),Jmat.Matrix.make(a)},Jmat.Matrix.render=function(t,a){if(!t)return""+t;a=void 0==a?3:a;for(var r="",m=Jmat.Matrix.isReal(t),e=[],n=[],i=0;i<t.h;i++){e.push([]);for(var o=0;o<t.w;o++){0==i&&n.push([0,0]);var l=[t.e[i][o].re.toFixed(a),Math.abs(t.e[i][o].im).toFixed(a)];n[o]=[Math.max(l[0].length,n[o][0]),Math.max(l[1].length,n[o][1])],e[i].push(l)}}for(var i=0;i<t.h;i++){var u="";u+="|"+(i+1==t.h?"_":" ");for(var o=0;o<t.w;o++){for(var l=e[i][o][0];l.length<n[o][0];)l=" "+l;if(!m){for(var J=t.e[i][o].im<0,p=e[i][o][1];p.length<n[o][1];)p="0"+p;p=(J?"-":"+")+p,l+=p+"i"}u+=l+(i+1==t.h&&o+1==t.w?"_":" ")}if(u+="|",0==i){for(var s=" _";s.length+2<u.length;)s+=" ";s+="_",r+=s+"\n"}r+=u+"\n"}return r},Jmat.Matrix.prototype.render=function(t){return Jmat.Matrix.render(this,t)},Jmat.Matrix.cast=function(t){return t instanceof Jmat.Matrix?t:Jmat.Matrix.make(t)},Jmat.Matrix.copy=function(t){for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var m=0;m<t.w;m++)a.e[r][m]=Jmat.Complex(t.e[r][m].re,t.e[r][m].im);return a},Jmat.Matrix.identity=function(t,a){for(var r=new Jmat.Matrix(t,a),m=0;t>m;m++)for(var e=0;a>e;e++)r.e[m][e]=Jmat.Complex(e==m?1:0);return r},Jmat.Matrix.zero=function(t,a){for(var r=new Jmat.Matrix(t,a),m=0;t>m;m++)for(var e=0;a>e;e++)r.e[m][e]=Jmat.Complex(0);return r},Jmat.Matrix.add=function(t,a){if(t.w!=a.w||t.h!=a.h)return null;for(var r=new Jmat.Matrix(t.h,t.w),m=0;m<t.h;m++)for(var e=0;e<t.w;e++)r.e[m][e]=t.e[m][e].add(a.e[m][e]);return r},Jmat.Matrix.prototype.add=function(t){return Jmat.Matrix.add(this,t)},Jmat.Matrix.sub=function(t,a){if(t.w!=a.w||t.h!=a.h)return null;for(var r=new Jmat.Matrix(t.h,t.w),m=0;m<t.h;m++)for(var e=0;e<t.w;e++)r.e[m][e]=t.e[m][e].sub(a.e[m][e]);return r},Jmat.Matrix.prototype.sub=function(t){return Jmat.Matrix.sub(this,t)},Jmat.Matrix.mul=function(t,a){if(t.w!=a.h)return null;for(var r=new Jmat.Matrix(t.h,a.w),m=0;m<t.h;m++)for(var e=0;e<a.w;e++){for(var n=Jmat.Complex(0),i=0;i<t.w;i++)n=n.add(t.e[m][i].mul(a.e[i][e]));r.e[m][e]=n}return r},Jmat.Matrix.prototype.mul=function(t){return Jmat.Matrix.mul(this,t)},Jmat.Matrix.mulc=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),m=0;m<t.h;m++)for(var e=0;e<t.w;e++)r.e[m][e]=t.e[m][e].mul(a);return r},Jmat.Matrix.prototype.mulc=function(t){return Jmat.Matrix.mulc(this,t)},Jmat.Matrix.mulr=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),m=0;m<t.h;m++)for(var e=0;e<t.w;e++)r.e[m][e]=t.e[m][e].mulr(a);return r},Jmat.Matrix.prototype.mulr=function(t){return Jmat.Matrix.mulr(this,t)},Jmat.Matrix.div=function(t,a){if(t.w!=a.h)return null;var r=new Jmat.Matrix(t.h,a.w);a=Jmat.Matrix.inv(a);for(var m=0;m<t.h;m++)for(var e=0;e<a.w;e++){for(var n=Jmat.Complex(0),i=0;i<t.w;i++)n=n.add(t.e[m][i].mul(a.e[i][e]));r.e[m][e]=n}return r},Jmat.Matrix.prototype.div=function(t){return Jmat.Matrix.div(this,t)},Jmat.Matrix.leftdiv=function(t,a){if(t.w!=a.h)return null;var r=new Jmat.Matrix(t.h,a.w);a=Jmat.Matrix.inv(a);for(var m=0;m<a.h;m++)for(var e=0;e<t.w;e++){for(var n=Jmat.Complex(0),i=0;i<a.w;i++)n=n.add(a.e[m][i].mul(t.e[i][e]));r.e[m][e]=n}return r},Jmat.Matrix.prototype.leftdiv=function(t){return Jmat.Matrix.leftdiv(this,t)},Jmat.Matrix.divc=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),m=0;m<t.h;m++)for(var e=0;e<t.w;e++)r.e[m][e]=t.e[m][e].div(a);return r},Jmat.Matrix.prototype.divc=function(t){return Jmat.Matrix.divc(this,t)},Jmat.Matrix.divr=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),m=0;m<t.h;m++)for(var e=0;e<t.w;e++)r.e[m][e]=t.e[m][e].divr(a);return r},Jmat.Matrix.prototype.divr=function(t){return Jmat.Matrix.divr(this,t)},Jmat.Matrix.isReal=function(t){for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++){var m=t.e[a][r];if(0!=m.im)return!1}return!0},Jmat.Matrix.isValid=function(t){if(!(t&&t.w&&t.h&&t.e&&t.e.length))return!1;for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++){var m=t.e[a][r];if(!m)return!1;if(m.re==1/0||m.re==-(1/0)||m.re!=m.re)return!1;if(m.im==1/0||m.im==-(1/0)||m.im!=m.im)return!1}return!0},Jmat.Matrix.isNaN=function(t){for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++)if(Jmat.Complex.isNaN(t.e[a][r]))return!0;return!1},Jmat.Matrix.isInfOrNaN=function(t){for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++)if(Jmat.Complex.isInfOrNaN(t.e[a][r]))return!0;return!1},Jmat.Matrix.transpose=function(t){for(var a=new Jmat.Matrix(t.w,t.h),r=0;r<t.h;r++)for(var m=0;m<t.w;m++)a.e[m][r]=t.e[r][m];return a},Jmat.Matrix.prototype.transpose=function(){return Jmat.Matrix.transpose(this)},Jmat.Matrix.neg=function(t){for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var m=0;m<t.w;m++)a.e[r][m]=t.e[r][m].neg();return a},Jmat.Matrix.prototype.neg=function(){return Jmat.Matrix.neg(this)},Jmat.Matrix.conj=function(t){for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var m=0;m<t.w;m++)a.e[r][m]=Jmat.Complex.conj(t.e[r][m]);return a},Jmat.Matrix.prototype.conj=function(){return Jmat.Matrix.conj(this)},Jmat.Matrix.transjugate=function(t){return Jmat.Matrix.conj(Jmat.Matrix.transpose(t))},Jmat.Matrix.prototype.transjugate=function(){return Jmat.Matrix.transjugate(this)},Jmat.Matrix.subrow=function(t,a){if(t.h<2)return null;for(var r=new Jmat.Matrix(t.h-1,t.w),m=0;m<t.h-1;m++)for(var e=0;e<t.w;e++)r.e[m][e]=t.e[a>m?m:m+1][e];return r},Jmat.Matrix.subcol=function(t,a){if(t.w<2)return null;for(var r=new Jmat.Matrix(t.h,t.w-1),m=0;m<t.h;m++)for(var e=0;e<t.w-1;e++)r.e[m][e]=t.e[m][a>e?e:e+1];return r},Jmat.Matrix.minorsub=function(t,a,r){if(t.h<2||t.w<2)return null;for(var m=new Jmat.Matrix(t.h-1,t.w-1),e=0;e<t.h-1;e++)for(var n=0;n<t.w-1;n++)m.e[e][n]=t.e[a>e?e:e+1][r>n?n:n+1];return m},Jmat.Matrix.submatrix=function(t,a,r,m,e){if(0>m||0>a||m>t.w||a>t.h)return null;if(0>e||0>r||e>t.w||r>t.h)return null;var n=e-m,i=r-a;if(0>=n||0>=i||n>t.w||i>t.h)return null;for(var o=new Jmat.Matrix(i,n),l=0;i>l;l++)for(var u=0;n>u;u++)o.e[l][u]=t.e[a+l][m+u];return o},Jmat.Matrix.minor=function(t,a,r){if(t.h<2||t.w<2||t.w!=t.h)return Jmat.Complex(NaN);var m=Jmat.Matrix.minorsub(t,a,r);return Jmat.Matrix.determinant(m)},Jmat.Matrix.cofactor=function(t,a,r){var m=Jmat.Matrix.minor(t,a,r),e=(a+r)%2==0?1:-1;return m.mulr(e)},Jmat.Matrix.determinant=function(t){if(t.w!=t.h)return NaN;if(1==t.w)return t.e[0][0];if(2==t.w)return t.e[0][0].mul(t.e[1][1]).sub(t.e[0][1].mul(t.e[1][0]));for(var a=Jmat.Complex(0),r=0;r<t.w;r++)a=a.add(t.e[0][r].mul(Jmat.Matrix.cofactor(t,0,r)));return a},Jmat.Matrix.adj=function(t){if(t.w!=t.h)return NaN;if(1==t.w)return Jmat.Matrix.identity(1,1);for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var m=0;m<t.w;m++)a.e[r][m]=Jmat.Matrix.cofactor(t,m,r);return a},Jmat.Matrix.inv=function(t){return t.w!=t.h?null:Jmat.Matrix.mulc(Jmat.Matrix.adj(t),Jmat.Complex.inv(Jmat.Matrix.determinant(t)))},Jmat.Matrix.pseudoinverse_=function(t){for(var a=Jmat.Matrix.svd(t),r=Math.min(a.s.w,a.s.h),m=1e-15,e=0;r>e;e++)a.s.e[e][e]=Math.abs(a.s.e[e][e].re)<m?a.s.e[e][e]:Jmat.Complex.inv(a.s.e[e][e]);return a.s=Jmat.Matrix.transpose(a.s),Jmat.Matrix.mul(Jmat.Matrix.mul(a.v,a.s),Jmat.Matrix.transjugate(a.u))},Jmat.Matrix.pseudoinverse=function(t){var a=Jmat.Matrix.inv(t);return Jmat.Matrix.isValid(a)?a:Jmat.Matrix.pseudoinverse_(t)},Jmat.Matrix.getFirstNonZeroDigit_=function(t){if(0==t)return 0;0>t&&(t=-t);for(var a=0;100>a;a++)if(1>t)t*=10;else{if(!(t>=10))return Math.floor(t);t/=10}return 0},Jmat.Matrix.getDebugNumber=function(t){for(var a=t.w+10*t.h,r=.1,m=0;m<t.h;m++)for(var e=0;e<t.w;e++){var n=Jmat.Matrix.getFirstNonZeroDigit_(t.e[m][e].re);a+=n*r,r/=10}return r*=10,a=Math.round(a/r)*r,Jmat.Complex(a)},Jmat.Matrix.norm=function(t){for(var a=0,r=0;r<t.h;r++)for(var m=0;m<t.w;m++){var e=t.e[r][m];a+=e.abssq()}return a=Math.sqrt(a),Jmat.Complex(a)},Jmat.Matrix.maxcolnorm=function(t){for(var a=0,r=0;r<t.w;r++){for(var m=0,e=0;e<t.h;e++)m+=t.e[e][r].abssq();m>a&&(a=m)}return Jmat.Complex(a)},Jmat.Matrix.maxrownorm=function(t){for(var a=0,r=0;r<t.h;r++){for(var m=0,e=0;e<t.w;e++)m+=t.e[r][e].abssq();m>a&&(a=m);
}return Jmat.Complex(a)},Jmat.Matrix.norm2=function(t){var a=Jmat.Matrix.svd(t);return a.s.e[0][0]},Jmat.Matrix.conditionNumber=function(t){var a=Jmat.Matrix.svd(t),r=Math.min(t.w,t.h);return a.s.e[0][0].div(a.s.e[r-1][r-1])},Jmat.Matrix.rank=function(t){for(var a=Jmat.Matrix.svd(t).s,r=0,m=0;m<a.w;m++)Jmat.Real.near(a.e[m][m].re,0,1e-14)||r++;return Jmat.Complex(r)},Jmat.Matrix.trace=function(t){if(t.w!=t.h)return Jmat.Complex(NaN);for(var a=Jmat.Complex.ZERO,r=0;r<t.w;r++)a=a.add(t.e[r][r]);return a},Jmat.Matrix.col=function(t,a){for(var r=new Jmat.Matrix(t.h,1),m=0;m<t.h;m++)r.e[m][0]=t.e[m][a];return r},Jmat.Matrix.row=function(t,a){for(var r=new Jmat.Matrix(1,t.w),m=0;m<t.w;m++)r.e[0][m]=t.e[a][m];return r},Jmat.Matrix.overlap=function(t,a,r,m){for(var e=Math.max(r+a.h,t.h)-Math.min(0,r),n=Math.max(m+a.w,t.w)-Math.min(0,m),i=Jmat.Matrix.zero(e,n),o=0;o<t.h;o++)for(var l=0;l<t.w;l++){var u=0>m?l-m:l,J=0>r?o-r:o;i.e[J][u]=t.e[o][l]}for(var o=0;o<a.h;o++)for(var l=0;l<a.w;l++){var u=0>m?l:l+m,J=0>r?o:o+r;i.e[J][u]=i.e[J][u].add(a.e[o][l])}return i},Jmat.Matrix.insert=function(t,a,r,m){for(var e=Jmat.Matrix.copy(t),n=0;n<a.h;n++)for(var i=0;i<a.w;i++){var o=i+m,l=n+r;o>=0&&o<t.w&&l>=0&&l<t.h&&(e.e[l][o]=a.e[n][i])}return e},Jmat.Matrix.qr=function(t){if(t.h<t.w)return null;for(var a=Jmat.Matrix,r=Jmat.Complex,m=a.transjugate,e=Jmat.Matrix.isReal(t),n=a.copy(t),i=n.h,o=n.w,l=[],u=[],J=0;o>J;J++){var p=a.submatrix(n,J,i,J,J+1),s=p.e[0][0].eqr(0)?r(-1):r.sign(p.e[0][0]);l[J]=a.identity(i-J,1).mulc(s.mul(a.norm(p))).add(p);var x,f=a.norm(l[J]),c=f.eqr(0);if(c)x=r(0);else if(l[J]=l[J].divc(f),x=r(2),!e){var C=a.mul(a.transjugate(p),l[J]),d=a.mul(a.transjugate(l[J]),p);x=C.e[0][0].div(d.e[0][0]).addr(1)}u[J]=x;var g=a.submatrix(n,J,i,J,o);g=g.sub(l[J].mul(m(l[J])).mul(g).mulc(x)),n=a.insert(n,g,J,J)}for(var v=n,h=a.identity(i,i),J=o-1;J>=0;J--){var I=a.submatrix(h,J,i,0,i),I=a.submatrix(h,J,i,0,i);I=I.sub(l[J].mul(m(l[J])).mul(I).mulc(u[J])),h=a.insert(h,I,J,0)}return{q:h,r:v}},Jmat.Matrix.eig11=function(t){if(1!=t.w||1!=t.h)return null;var a={};return a.l=new Jmat.Matrix(1,1),a.l.e[0][0]=Jmat.Complex(t.e[0][0]),a.v=new Jmat.Matrix(1,1),a.v.e[0][0]=Jmat.Complex(1),a},Jmat.Matrix.eigval22=function(t){if(2!=t.w||2!=t.h)return null;var a=Jmat.Complex(1),r=t.e[0][0].neg().sub(t.e[1][1]),m=t.e[0][0].mul(t.e[1][1]).sub(t.e[0][1].mul(t.e[1][0])),e=Jmat.Complex.sqrt(r.mul(r).sub(a.mul(m).mulr(4))),n=r.neg().add(e).div(a.mulr(2)),i=r.neg().sub(e).div(a.mulr(2));return[n,i]},Jmat.Matrix.eig22=function(t){if(2!=t.w||2!=t.h)return null;var a=Jmat.Matrix.eigval22(t),r=a[0],m=a[1],e=t.e[0][1].div(r.sub(t.e[0][0])),n=Jmat.Complex(1),i=t.e[0][1].div(m.sub(t.e[0][0])),o=Jmat.Complex(1),l={};return l.l=new Jmat.Matrix(2,1),l.l.e[0][0]=r,l.l.e[1][0]=m,l.v=new Jmat.Matrix(2,2),l.v.e[0][0]=e,l.v.e[1][0]=n,l.v.e[0][1]=i,l.v.e[1][1]=o,l},Jmat.Matrix.eig=function(t){if(t.w!=t.h||t.w<1)return null;var a=t.w;if(1==a)return Jmat.Matrix.eig11(t);if(2==a)return Jmat.Matrix.eig22(t);for(var r=Jmat.Matrix.copy(t),m=Jmat.Matrix.identity(a,a),e=void 0,n=0;15>n;n++){var i=Jmat.Matrix.eigval22(Jmat.Matrix.submatrix(r,r.h-2,r.h,r.w-2,r.w)),o=m.mulc(i[0]);r=r.sub(o);var l=Jmat.Matrix.qr(r);r=Jmat.Matrix.mul(l.r,l.q).add(o);var u=m.mulc(i[1]);if(r=r.sub(u),l=Jmat.Matrix.qr(r),r=Jmat.Matrix.mul(l.r,l.q).add(u),!Jmat.Matrix.isValid(r)){if(3>n)return null;e||(e=r);break}e=r}r=e;for(var i=new Jmat.Matrix(t.w,1),n=0;n<t.w;n++)i.e[n][0]=r.e[n][n];for(var J=new Jmat.Matrix(a,a),p=0;a>p;p++){for(var s=r.e[p][p],x=Jmat.Matrix.copy(t),n=0;a>n;n++)x.e[n][n]=x.e[n][n].sub(s);for(var n=0;a>n;n++)x.e[x.h-1][n]=Jmat.Complex(n==a-1?1:0);var f=Jmat.Matrix.zero(a,1);f.e[f.h-1][0]=Jmat.Complex(1);var c=Jmat.Matrix.solve(x,f);if(c)for(var n=0;a>n;n++)J.e[n][p]=c.e[n][0];else for(var n=0;a>n;n++)J.e[n][p]=Jmat.Complex(NaN,NaN)}return{l:i,v:J}},Jmat.Matrix.evd=function(t){var a=Jmat.Matrix.eig(t);return{v:a.v,d:Jmat.Matrix.diag(a.l)}},Jmat.Matrix.diag=function(t){for(var a=t.w*t.h,r=Jmat.Matrix.zero(a,a),m=0,e=0;e<t.h;e++)for(var n=0;n<t.w;n++)r.e[m][m]=t.e[e][n],m++;return r},Jmat.Matrix.get1=function(t,a){var r=a%t.w,m=Math.floor(a/t.w);return t.e[m][r]},Jmat.Matrix.prototype.get1=function(t){return Jmat.Matrix.get1(this,t)},Jmat.Matrix.set1=function(t,a,r){var m=a%t.w,e=Math.floor(a/t.w);t.e[e][m]=r},Jmat.Matrix.cross=function(t,a){if(t.w*t.h!=3||a.w*a.h!=3)return Jmat.Matrix(NaN);var r=new Jmat.Matrix(t.h,t.w);return Jmat.Matrix.set1(r,0,t.get1(1).mul(a.get1(2)).sub(t.get1(2).mul(a.get1(1)))),Jmat.Matrix.set1(r,1,t.get1(2).mul(a.get1(0)).sub(t.get1(0).mul(a.get1(2)))),Jmat.Matrix.set1(r,2,t.get1(0).mul(a.get1(1)).sub(t.get1(1).mul(a.get1(0)))),r},Jmat.Matrix.dot=function(t,a){if((t.w!=a.w||t.h!=a.h)&&(t.w!=a.h||t.h!=a.w||1!=t.w&&1!=t.h))return Jmat.Matrix(NaN);for(var r=t.w*t.h,m=Jmat.Complex(0),e=0;r>e;e++)m=m.add(t.get1(e).mul(a.get1(e).conj()));return m},/*
Licensing: This is from linpack, from http://www.netlib.org/linpack/
The license is not mentioned directly in the source code or the website, but
has been said to now be a variant of the BSD license: see
https://bugzilla.redhat.com/show_bug.cgi?id=1000829.
Here is the original author comment from zsvdc.f:
    linpack. this version dated 03/19/79 .
             correction to shift calculation made 2/85.
    g.w. stewart, university of maryland, argonne national lab.
*/
Jmat.Matrix.zsvdc_=function(t,a,r,m,e,n,i,o,l,u,J,p){var s,x,f,c,C,d,g,v,h,I,_,b,M,w,B,R,N,q,y,Q,O,E,P,A,S,z,T,F,k,Z,j,Y,D,G,W,V,L,K,U,H,X,$=30,tt=function(t){return t.re},at=function(t){return Math.abs(t.re)+Math.abs(t.im)},rt=function(t){return at(t)<1e-150},mt=function(t,a){return a.eqr(0)?Jmat.Complex(0):a.mulr(t.abs()/a.abs())},et=function(t,a){return 0==a?0:0>a?-Math.abs(t):Math.abs(t)},j=function(t,a,r){for(var m=Jmat.Complex(0),e=0;t>e;e++){var n=a[r+e];m=m.add(n.mul(n.conj()))}return Jmat.Complex.sqrt(m)},nt=function(t,a,r,m,e,n){for(var i=0;t>i;i++)e[n+i]=e[n+i].add(r[m+i].mul(a))},it=function(t,a,r,m,e){for(var n=Jmat.Complex(0),i=0;t>i;i++)n=n.add(a[r+i].conj().mul(m[e+i]));return n},ot=function(t,a,r,m){for(var e=0;t>e;e++)r[m+e]=r[m+e].mul(a)},lt=function(t,a){var r=Math.abs(t),m=Math.abs(a),e=et(Math.sqrt(t*t+a*a),r>m?t:a),n=0==e?1:t/e,i=0==e?0:a/e,o=r>m?i:0==e?0:0==n?1:1/n;return[e,o,n,i]},ut=function(t,a,r,m,e,n,i){for(var o=0;t>o;o++){var l=a[r+o],u=m[e+o];a[r+o]=l.mulr(n).add(u.mulr(i)),m[e+o]=u.mulr(n).sub(l.mulr(i))}},Jt=function(t,a,r,m,e){for(var n=0;t>n;n++){var i=a[n+r];a[n+r]=m[n+e],m[n+e]=i}},pt=!1,st=!1;for(c=Math.floor(p%100/10),y=c>1?Math.min(r,m):r,0!=c&&(pt=!0),p%10!=0&&(st=!0),O=0,q=Math.min(r-1,m),Q=Math.max(0,Math.min(m-2,r)),M=Math.max(q,Q),v=0;M>v;v++){for(_=v+1,q>v&&(e[v]=Jmat.Complex(j(r-v,t,v+v*a)),rt(e[v])||(rt(t[v+v*a])||(e[v]=mt(e[v],t[v+v*a])),E=Jmat.Complex(1).div(e[v]),ot(r-v,E,t,v+v*a),t[v+v*a]=t[v+v*a].addr(1)),e[v]=e[v].neg()),f=_;m>f;f++)q>v&&(rt(e[v])||(E=it(r-v,t,v+v*a,t,v+f*a).neg().div(t[v+v*a]),nt(r-v,E,t,v+v*a,t,v+f*a))),n[f]=t[v+f*a].conj();if(pt&&q>v)for(s=v;r>s;s++)i[s+v*o]=t[s+v*a];if(Q>v){if(n[v]=Jmat.Complex(j(m-v-1,n,_)),rt(n[v])||(rt(n[_])||(n[v]=mt(n[v],n[_])),E=Jmat.Complex(1).div(n[v]),ot(m-v-1,E,n,_),n[_]=Jmat.Complex(1).add(n[_])),n[v]=n[v].conj().neg(),r>_&&!rt(n[v])){for(f=_;r>f;f++)J[f]=Jmat.Complex(0);for(f=_;m>f;f++)nt(r-v-1,n[f],t,_+f*a,J,_);for(f=_;m>f;f++)nt(r-v-1,n[f].neg().div(n[_]).conj(),J,_,t,_+f*a)}if(st)for(s=_;m>s;s++)l[s+v*u]=n[s]}}if(w=Math.min(m,r+1),m>q&&(e[q]=t[q+q*a]),w>r&&(e[w-1]=Jmat.Complex(0)),w>Q+1&&(n[Q]=t[Q+(w-1)*a]),n[w-1]=Jmat.Complex(0),pt){for(f=q;y>f;f++){for(s=0;r>s;s++)i[s+f*o]=Jmat.Complex(0);i[f+f*o]=Jmat.Complex(1)}for(h=0;q>h;h++)if(v=q-h-1,0==at(e[v])){for(s=0;r>s;s++)i[s+v*o]=Jmat.Complex(0);i[v+v*o]=Jmat.Complex(1)}else{for(_=v+1,f=_;y>f;f++)E=it(r-v,i,v+v*o,i,v+f*o).neg().div(i[v+v*o]),nt(r-v,E,i,v+v*o,i,v+f*o);for(ot(r-v,Jmat.Complex(-1),i,v+v*o),i[v+v*o]=i[v+v*o].inc(),s=0;v>s;s++)i[s+v*o]=Jmat.Complex(0)}}if(st)for(h=0;m>h;h++){if(v=m-h-1,_=v+1,Q>v&&!rt(n[v]))for(f=_;m>f;f++)E=it(m-_,l,_+v*u,l,_+f*u).neg().div(l[_+v*u]),nt(m-_,E,l,_+v*u,l,_+f*u);for(s=0;m>s;s++)l[s+v*u]=Jmat.Complex(0);l[v+v*u]=Jmat.Complex(1)}for(s=0;w>s&&(rt(e[s])||(E=Jmat.Complex.abs(e[s]),P=e[s].div(E),e[s]=E,w>s+1&&(n[s]=n[s].div(P)),pt&&ot(r,P,i,s*o)),s+1!=w);s++)rt(n[s])||(E=Jmat.Complex.abs(n[s]),P=E.div(n[s]),n[s]=E,e[s+1]=e[s+1].mul(P),st&&ot(m,P,l,(s+1)*u));for(B=w,x=0;0!=w;){if(x>=$){O=w;break}for(h=1;w>=h&&(v=w-h,0!=v);h++)if(U=e[v-1].abs()+e[v].abs(),H=U+n[v-1].abs(),H==U){n[v-1]=Jmat.Complex(0);break}if(v==w-1)d=4;else{for(_=v+1,N=w+1,I=_;N>=I&&(b=w-I+_,b!=v);I++)if(U=0,b!=w&&(U+=n[b-1].abs()),b!=v+1&&(U+=n[b-2].abs()),H=U+e[b-1].abs(),H==U){e[b-1]=Jmat.Complex(0);break}b==v?d=3:b==w?d=1:(d=2,v=b)}if(v++,1==d)for(R=w-1,k=tt(n[w-2]),n[w-2]=Jmat.Complex(0),g=v;R>=g;g++)C=R-g+v,K=tt(e[C-1]),X=lt(K,k),K=X[0],k=X[1],z=X[2],V=X[3],e[C-1]=Jmat.Complex(K),C!=v&&(k=-V*tt(n[C-2]),n[C-2]=n[C-2].mulr(z)),st&&ut(m,l,(C-1)*u,l,(w-1)*u,z,V);else if(2==d)for(k=tt(n[v-2]),n[v-2]=Jmat.Complex(0),C=v;w>=C;C++)K=tt(e[C-1]),X=lt(K,k),K=X[0],k=X[1],z=X[2],V=X[3],e[C-1]=Jmat.Complex(K),k=-V*tt(n[C-1]),n[C-1]=n[C-1].mulr(z),pt&&ut(r,i,(C-1)*o,i,(v-2)*o,z,V);else if(3==d){for(Y=Math.max(Math.max(Math.max(Math.max(e[w-1].abs(),e[w-2].abs()),n[w-2].abs()),e[v-1].abs()),n[v-1].abs()),W=tt(e[w-1])/Y,L=tt(e[w-2])/Y,F=tt(n[w-2])/Y,G=tt(e[v-1])/Y,T=tt(n[v-1])/Y,A=((L+W)*(L-W)+F*F)/2,S=W*F*W*F,D=0,(0!=A||0!=S)&&(D=Math.sqrt(A*A+S),0>A&&(D=-D),D=S/(A+D)),k=(G+W)*(G-W)+D,Z=G*T,R=w-1,C=v;R>=C;C++)X=lt(k,Z),k=X[0],Z=X[1],z=X[2],V=X[3],C!=v&&(n[C-2]=Jmat.Complex(k)),k=z*tt(e[C-1])+V*tt(n[C-1]),n[C-1]=n[C-1].mulr(z).sub(e[C-1].mulr(V)),Z=V*tt(e[C]),e[C]=e[C].mulr(z),st&&ut(m,l,(C-1)*u,l,C*u,z,V),X=lt(k,Z),k=X[0],Z=X[1],z=X[2],V=X[3],e[C-1]=Jmat.Complex(k),k=z*tt(n[C-1])+V*tt(e[C]),e[C]=n[C-1].mulr(-V).add(e[C].mulr(z)),Z=V*tt(n[C]),n[C]=n[C].mulr(z),pt&&r>C&&ut(r,i,(C-1)*o,i,C*o,z,V);n[w-2]=Jmat.Complex(k),x++}else if(4==d){for(tt(e[v-1])<0&&(e[v-1]=e[v-1].neg(),st&&ot(m,Jmat.Complex(-1),l,(v-1)*u));v!=B&&!(tt(e[v])<=tt(e[v-1]));)E=e[v-1],e[v-1]=e[v],e[v]=E,st&&m>v&&Jt(m,l,(v-1)*u,l,v*u),pt&&r>v&&Jt(r,i,(v-1)*o,i,v*o),v++;x=0,w--}}return O},Jmat.Matrix.svd=function(t){for(var a=[],r=0;r<t.h;r++)for(var m=0;m<t.w;m++)a[r+m*t.h]=t.e[r][m];var e=[],n=[],i=[],o=[];Jmat.Matrix.zsvdc_(a,t.h,t.h,t.w,e,o,n,t.h,i,t.w,[],11);for(var l=1e-15,u=0;u<e.length;u++)Math.abs(e[u])<l&&(e[u]=0);for(var J={u:new Jmat.Matrix(t.h,t.h),s:new Jmat.Matrix(t.h,t.w),v:new Jmat.Matrix(t.w,t.w)},r=0;r<t.h;r++)for(var m=0;m<t.h;m++)J.u.e[r][m]=n[r+m*t.h];for(var r=0;r<t.h;r++)for(var m=0;m<t.w;m++)J.s.e[r][m]=m==r?Jmat.Complex(e[m]):Jmat.Complex(0);for(var r=0;r<t.w;r++)for(var m=0;m<t.w;m++)J.v.e[r][m]=i[r+m*t.w];return J},Jmat.Matrix.eq=function(t,a){if(t.w!=a.w||t.h!=a.h)return!1;for(var r=0;r<t.h;r++)for(var m=0;m<t.w;m++)if(!t.e[r][m].eq(a.e[r][m]))return!1;return!0},Jmat.Matrix.near=function(t,a,r){if(t.w!=a.w||t.h!=a.h)return!1;for(var m=0;m<t.h;m++)for(var e=0;e<t.w;e++){var n=t.e[m][e],i=a.e[m][e];if(Math.abs(n.re-i.re)>r)return!1;if(Math.abs(n.im-i.im)>r)return!1}return!0},Jmat.Matrix.relnear=function(t,a,r){if(t.w!=a.w||t.h!=a.h)return!1;for(var m=0;m<t.h;m++)for(var e=0;e<t.w;e++){var n=t.e[m][e],i=a.e[m][e];if(!Jmat.Complex.relnear(n,i,r))return!1}return!0},Jmat.Matrix.solve=function(t,a){if(t.h!=a.h)return void 0;var r=Jmat.Matrix.pseudoinverse(t),m=Jmat.Matrix.mul(t,r),e=Jmat.Matrix.mul(m,a);return Jmat.Matrix.near(a,e,1e-5)?Jmat.Matrix.mul(r,a):null},/*
License of the kiss_ and kf_ functions below (converted from C to JavaScript):
Kiss FFT
Copyright (c) 2003-2010, Mark Borgerding
All rights reserved.
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
* Neither the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
Jmat.Matrix.kiss_fft_state_=function(t,a){this.nfft=t,this.inverse=a,this.factors=[],this.twiddles=[]},Jmat.Matrix.kf_bfly2_=function(t,a,r,m,e){for(var n=0,i=0;e>i;i++){var o=t[a+i+e].mul(m.twiddles[n]);n+=r,t[a+i+e]=t[a+i].sub(o),t[a+i]=t[a+i].add(o)}},Jmat.Matrix.kf_bfly4_=function(t,a,r,m,e){for(var n=[],i=2*e,o=3*e,l=0,u=0,J=0,p=0;e>p;p++)n[0]=t[a+p+e].mul(m.twiddles[l]),n[1]=t[a+p+i].mul(m.twiddles[u]),n[2]=t[a+p+o].mul(m.twiddles[J]),n[5]=t[a+p].sub(n[1]),t[a+p]=t[a+p].add(n[1]),n[3]=n[0].add(n[2]),n[4]=n[0].sub(n[2]),t[a+p+i]=t[a+p].sub(n[3]),l+=r,u+=2*r,J+=3*r,t[a+p]=t[a+p].add(n[3]),m.inverse?(t[a+p+e].re=n[5].re-n[4].im,t[a+p+e].im=n[5].im+n[4].re,t[a+p+o].re=n[5].re+n[4].im,t[a+p+o].im=n[5].im-n[4].re):(t[a+p+e].re=n[5].re+n[4].im,t[a+p+e].im=n[5].im-n[4].re,t[a+p+o].re=n[5].re-n[4].im,t[a+p+o].im=n[5].im+n[4].re)},Jmat.Matrix.kf_bfly3_=function(t,a,r,m,e){for(var n=e,i=2*e,o=0,l=0,u=[],J=m.twiddles[r*e],p=0;n>p;p++)u[1]=t[a+p+e].mul(m.twiddles[o]),u[2]=t[a+p+i].mul(m.twiddles[l]),u[3]=u[1].add(u[2]),u[0]=u[1].sub(u[2]),o+=r,l+=2*r,t[a+p+e].re=t[a+p].re-u[3].re/2,t[a+p+e].im=t[a+p].im-u[3].im/2,u[0]=u[0].mulr(J.im),t[a+p]=t[a+p].add(u[3]),t[a+p+i].re=t[a+p+e].re+u[0].im,t[a+p+i].im=t[a+p+e].im-u[0].re,t[a+p+e].re-=u[0].im,t[a+p+e].im+=u[0].re},Jmat.Matrix.kf_bfly5_=function(t,a,r,m,e){for(var n=[],i=m.twiddles[r*e],o=m.twiddles[2*r*e],l=2*e,u=3*e,J=4*e,p=0;e>p;++p)n[0]=Jmat.Complex(t[a+p]),n[1]=t[a+e+p].mul(m.twiddles[p*r]),n[2]=t[a+l+p].mul(m.twiddles[2*p*r]),n[3]=t[a+u+p].mul(m.twiddles[3*p*r]),n[4]=t[a+J+p].mul(m.twiddles[4*p*r]),n[7]=n[1].add(n[4]),n[10]=n[1].sub(n[4]),n[8]=n[2].add(n[3]),n[9]=n[2].sub(n[3]),t[a+p].re+=n[7].re+n[8].re,t[a+p].im+=n[7].im+n[8].im,n[5]=Jmat.Complex(0),n[5].re=n[0].re+n[7].re*i.re+n[8].re*o.re,n[5].im=n[0].im+n[7].im*i.re+n[8].im*o.re,n[6]=Jmat.Complex(0),n[6].re=n[10].im*i.im+n[9].im*o.im,n[6].im=-n[10].re*i.im-n[9].re*o.im,t[a+e+p]=n[5].sub(n[6]),t[a+J+p]=n[5].add(n[6]),n[11]=Jmat.Complex(0),n[11].re=n[0].re+n[7].re*o.re+n[8].re*i.re,n[11].im=n[0].im+n[7].im*o.re+n[8].im*i.re,n[12]=Jmat.Complex(0),n[12].re=-n[10].im*o.im+n[9].im*i.im,n[12].im=n[10].re*o.im-n[9].re*i.im,t[a+l+p]=n[11].add(n[12]),t[a+u+p]=n[11].sub(n[12])},Jmat.Matrix.kf_bfly_generic_=function(t,a,r,m,e,n){var i,o,l,u,J,p=m.nfft,s=[];for(i=0;e>i;++i){for(o=i,l=0;n>l;++l)s[l]=Jmat.Complex(t[a+o]),o+=e;for(o=i,l=0;n>l;++l){var x=0;for(t[a+o]=s[0],u=1;n>u;++u)x+=r*o,x>=p&&(x-=p),J=s[u].mul(m.twiddles[x]),t[a+o]=t[a+o].add(J);o+=e}}},Jmat.Matrix.kf_work_=function(t,a,r,m,e,n,i,o,l){var u=i[o+0],J=i[o+1],p=0;if(1==J)for(var s=0;u*J>s;s++)t[s+a]=Jmat.Complex(r[m+p]),p+=e*n;else for(var s=0;u*J>s;s+=J)Jmat.Matrix.kf_work_(t,a+s,r,m+p,e*u,n,i,o+2,l),p+=e*n;switch(u){case 2:Jmat.Matrix.kf_bfly2_(t,a,e,l,J);break;case 3:Jmat.Matrix.kf_bfly3_(t,a,e,l,J);break;case 4:Jmat.Matrix.kf_bfly4_(t,a,e,l,J);break;case 5:Jmat.Matrix.kf_bfly5_(t,a,e,l,J);break;default:Jmat.Matrix.kf_bfly_generic_(t,a,e,l,J,u)}},Jmat.Matrix.kf_factor_=function(t,a){var r=0,m=4,e=Math.floor(Math.sqrt(t));do{for(;t%m!=0;){switch(m){case 4:m=2;break;case 2:m=3;break;default:m+=2}m>e&&(m=t)}t=Math.floor(t/m),a[r+0]=m,a[r+1]=t,r+=2}while(t>1)},Jmat.Matrix.kiss_fft_alloc_=function(t,a){for(var r=new Jmat.Matrix.kiss_fft_state_(t,a),m=0;t>m;++m){var e=2*-Math.PI*m/t;r.inverse&&(e*=-1),r.twiddles[m]=new Jmat.Complex(Math.cos(e),Math.sin(e))}return Jmat.Matrix.kf_factor_(t,r.factors),r},Jmat.Matrix.kiss_fft_=function(t,a,r){Jmat.Matrix.kf_work_(r,0,a,0,1,1,t.factors,0,t)},Jmat.Matrix.matrixfft_=function(t,a){var r=new Jmat.Matrix(t.h,t.w);if(t.w>1)for(var m=0;m<t.h;m++){for(var e=[],n=0;n<t.w;n++)e[n]=Jmat.Complex(0);var i=Jmat.Matrix.kiss_fft_alloc_(t.w,a);Jmat.Matrix.kiss_fft_(i,t.e[m],e);for(var n=0;n<t.w;n++)r.e[m][n]=e[n]}else r=t;var o=new Jmat.Matrix(t.h,t.w);if(t.h>1)for(var m=0;m<t.w;m++){for(var l=Jmat.Matrix.transpose(Jmat.Matrix.col(r,m)),e=[],n=0;n<t.h;n++)e[n]=Jmat.Complex(0);var i=Jmat.Matrix.kiss_fft_alloc_(t.h,a);Jmat.Matrix.kiss_fft_(i,l.e[0],e);for(var n=0;n<t.h;n++)o.e[n][m]=e[n]}else o=r;var u=1/Math.sqrt(t.w*t.h);return o=Jmat.Matrix.mulr(o,u)},Jmat.Matrix.fft=function(t){return Jmat.Matrix.matrixfft_(t,0)},Jmat.Matrix.ifft=function(t){return Jmat.Matrix.matrixfft_(t,1)},Jmat.Matrix.exp=function(t){if(t.h!=t.w)return null;for(var a=t.add(Jmat.Matrix.identity(t.w,t.w)),r=t,m=1,e=2;20>=e;e++)m*=e,r=r.mul(t),a=a.add(r.mulr(1/m));return a},Jmat.Matrix.cos=function(t){if(t.h!=t.w)return null;for(var a=Jmat.Matrix.identity(t.w,t.w),r=t.mul(t),m=null,e=1,n=1,i=0;20>i;i++)0==i?e=2:e*=(2*i+1)*(2*i+2),n=-n,m=null==m?r:m.mul(r),a=a.add(m.mulr(n/e));return a},Jmat.Matrix.sin=function(t){if(t.h!=t.w)return null;for(var a=t,r=t.mul(t),m=t,e=1,n=1,i=0;20>i;i++)e*=(2*i+2)*(2*i+3),n=-n,m=m.mul(r),a=a.add(m.mulr(n/e));return a},Jmat.Matrix.sqrt=function(t){if(t.h!=t.w)return null;for(var a=Jmat.Matrix.evd(t),r=a.v,m=a.d,e=0;e<m.w;e++)m.e[e][e]=Jmat.Complex.sqrt(m.e[e][e]);return r.mul(m).mul(Jmat.Matrix.inv(r))},Jmat.Matrix.log=function(t){if(t.h!=t.w)return null;for(var a=Jmat.Matrix.evd(t),r=a.v,m=a.d,e=0;e<m.w;e++)m.e[e][e]=Jmat.Complex.log(m.e[e][e]);return r.mul(m).mul(Jmat.Matrix.inv(r))},Jmat.Matrix.powc=function(t,a){if(t.h!=t.w)return null;for(var r=Jmat.Matrix.evd(t),m=r.v,e=r.d,n=0;n<e.w;n++)e.e[n][n]=e.e[n][n].pow(a);return m.mul(e).mul(Jmat.Matrix.inv(m))},Jmat.BigInt=function(t,a,r){return this instanceof Jmat.BigInt?(this.a=t||[],this.radix=a||Jmat.BigInt.ARRAYBASE_,this.minus=r||!1,void 0):Jmat.BigInt.make(t,a,r)},Jmat.BigInt.ARRAYBASE_=32768,Jmat.BigInt.ARRAYBASE_BITS_=15,Jmat.BigInt.STRINGBASE_=10,Jmat.BigInt.make=function(t,a,r){return void 0==t?new Jmat.Bigum(t,a,r):"number"==typeof t?Jmat.BigInt.fromInt(t,a):"string"==typeof t?Jmat.BigInt.parse(t,Jmat.BigInt.STRINGBASE_,a):void 0!=t.length?new Jmat.BigInt(t,a,r):void 0!=t.re?Jmat.BigInt.fromInt(t.re,a):void 0!=t.w?Jmat.BigInt.fromInt(t.w,a):a&&t.radix!=a?Jmat.BigInt.convertBase(t,a):Jmat.BigInt.copy(t)},Jmat.BigInt.cast=function(t,a,r){return void 0==t?new Jmat.BigInt(void 0,a,r):void 0==t.a||a&&t.radix!=a?t.radix&&a?Jmat.BigInt.convertBase(t,a):Jmat.BigInt(t,a,r):t},Jmat.BigInt.copy=function(t){return new Jmat.BigInt(t.a.slice(0),t.radix,t.minus)},Jmat.BigInt.parse=function(t,a,r){var m=a||Jmat.BigInt.STRINGBASE_,e=r||Jmat.BigInt.ARRAYBASE_,n=!1;"-"==t[0]&&(n=!0,t=t.substr(1));var i=Jmat.BigInt.stringToArray(t,e,m);return new Jmat.BigInt(i,e,n)},Jmat.BigInt.toString=function(t,a){if(!t||!t.a)return"invalid";var r=t.minus?"-":"";return r+Jmat.BigInt.arrayToString(t.a,t.radix,a)},Jmat.BigInt.prototype.toString=function(t){return Jmat.BigInt.toString(this,t)},Jmat.BigInt.stringToArray=function(t,a,r){for(var m=a||Jmat.BigInt.ARRAYBASE_,e=r||Jmat.BigInt.STRINGBASE_,n=[],i=0;i<t.length;i++){var o=Jmat.BigInt.di_(t[i]);n[i]=o}return Jmat.BigInt.convertArrayBase(n,e,m)},Jmat.BigInt.arrayToString=function(t,a,r){var m=a||Jmat.BigInt.ARRAYBASE_,e=r||Jmat.BigInt.STRINGBASE_;t=Jmat.BigInt.convertArrayBase(t,m,e);for(var n="",i=0;i<t.length;i++)n+=Jmat.BigInt.d_[t[i]];return 0==t.length&&(n="0"),n},Jmat.BigInt.getInBaseTwoWithoutConvert_=function(t){for(var a=[];t>0;)a.push(1&t),t>>=1;return Jmat.BigInt.mirror_(a),new Jmat.BigInt(a,2)},Jmat.BigInt.convertArrayBase=function(t,a,r,m){if(t.length>8&&10==r&&Jmat.Real.isPOT(a)){var e=Jmat.BigInt.convertArrayBase(t,a,1e6);return Jmat.BigInt.convertArrayBase(e,1e6,10)}var n=Jmat.Real,i=Jmat.BigInt;if(a==r)return t;var o=[];if(t=i.maybecopystrip_(t),2147483648>=a&&2147483648>=r&&n.isPOT(a)&&n.isPOT(r)){for(var l=n.ilog2(a),u=n.ilog2(r),J=Math.ceil(t.length*l/u),p=0;J>p;p++)o[p]=0;if(r>a)for(var s=J-1,x=0,p=t.length-1;p>=0;p--)if(x+l>u){var e=u-x;0!=e&&(o[s]|=(t[p]&(1<<e)-1)<<x),s--,o[s]=t[p]>>e,x=l-e}else o[s]|=t[p]<<x,x+=l;else for(var f=r-1,s=t.length-1,x=0,p=J-1;p>=0;p--)if(x+u>l){var e=l-x;o[p]=t[s]>>x,s--,o[p]|=(t[s]&f)<<e,x=u-e}else o[p]|=t[s]>>x&f,x+=u;return i.stripInPlace_(o),o}var c=n.isPowerOf(a,r);if(c){for(var p=0;p<t.length;p++){for(var C=t[p],d=0;c>d;d++)o.push(Math.floor(C/(c-d-1))%r);for(var d=c-1;d>=0;d--)o[p*c+d]=C%r,C=Math.floor(C/r)}return i.stripInPlace_(o),o}if(c=n.isPowerOf(r,a)){for(var g=Math.ceil(t.length/c),p=0;g>p;p++){var v=1;o[g-1-p]=0;for(var d=0;c>d;d++){var h=t.length-1-p*c-d;if(0>h)break;o[g-1-p]+=t[h]*v,v*=a}}return i.stripInPlace_(o),o}if(t.length>8){for(var I=n.idiv(t.length,2),_=[],b=[],p=0;I>p;p++)_[p]=t[p];for(var p=I;p<t.length;p++)b[p-I]=t[p];var M=m||[],w=i.convertArrayBase(_,a,r,M),B=i.convertArrayBase(b,a,r,M),R=t.length-I,c=M[R];if(!c){var N=n.idiv(R,2),C=R-N,q=M[N],y=M[C];c=q&&y?q.mul(y):q?q.mul(i.pow(i(a,r),i.getInBaseTwoWithoutConvert_(C))):y?y.mul(i.pow(i(a,r),i.getInBaseTwoWithoutConvert_(N))):i.pow(i(a,r),i.getInBaseTwoWithoutConvert_(R))}return M[R]=c,i(B,r).add(i(w,r).mul(c)).a}for(var p=0;p<t.length;p++)o=i.baseloop_(o,0,a,[],0,1,t[p],r,!1);return 0==o.length&&(o=[0]),o},Jmat.BigInt.convertStringBase=function(t,a,r){if(a==r)return t;var m=Jmat.BigInt.stringToArray(t,r,a);return Jmat.BigInt.arrayToString(m,r,r)},Jmat.BigInt.baseloop_=function(t,a,r,m,e,n,i,o,l){var u=[],J=Math.max(t.length+a,m.length+e),p=t.length;if(m.length||a)if(0==a&&0==e&&1==r&&1==n)for(var s=0;J>s;s++)s<t.length&&(i+=t[t.length-s-1]),s<m.length&&(i+=m[m.length-s-1]),u[s]=(i+o)%o,i=Math.floor(i/o);else for(var s=0;J>s;s++)s>=a&&s<t.length+a&&(i+=r*t[t.length-s-1+a]),s>=e&&s<m.length+e&&(i+=n*m[m.length-s-1+e]),u[s]=(i+o)%o,i=Math.floor(i/o);else for(var s=0;J>s;s++)i+=r*t[t.length-s-1],u[s]=(i+o)%o,i=Math.floor(i/o);if(i==1/0)throw"infinite overflow";for(;i>0;)u.push((i+o)%o),i=Math.floor(i/o);if(l){for(;u.length>p&&0==u[u.length-1];)u.length--;for(;u.length<p;)u.push(0)}else for(;u.length>1&&0==u[u.length-1];)u.length--;return Jmat.BigInt.mirror_(u),u},Jmat.BigInt.intToArray=function(t,a){if(t>Jmat.Real.BIGGESTJSINT)throw"too large integer literal for JS";for(var r=a||Jmat.BigInt.ARRAYBASE_,m=[];t>0;)m.push(t%r),t=Math.floor(t/r);return 0==m.length&&(m=[0]),m.length>1&&Jmat.BigInt.mirror_(m),m},Jmat.BigInt.arrayToInt=function(t,a){for(var r=a||Jmat.BigInt.ARRAYBASE_,m=0,e=1,n=0;n<t.length;n++)if(m+=e*t[t.length-1-n],e*=r,m==1/0||e==1/0)return 1/0;return m},Jmat.BigInt.fromInt=function(t,a){var r=a||Jmat.BigInt.ARRAYBASE_,m=!1;return 0>t&&(m=!0,t=-t),new Jmat.BigInt(Jmat.BigInt.intToArray(t,r),r,m)},Jmat.BigInt.toInt=function(t){return Jmat.BigInt.arrayToInt(t.a,t.radix)*(t.minus?-1:1)},Jmat.BigInt.prototype.toInt=function(){return Jmat.BigInt.arrayToInt(this.a,this.radix)*(this.minus?-1:1)},Jmat.BigInt.ZERO=Jmat.BigInt(0),Jmat.BigInt.ONE=Jmat.BigInt(1),Jmat.BigInt.TWO=Jmat.BigInt(2),Jmat.BigInt.convertBase=function(t,a){return t.radix==a?t:new Jmat.BigInt(Jmat.BigInt.convertArrayBase(t.a,t.radix,a),a,t.minus)},Jmat.BigInt.cloneArray=function(t){return t.slice(0)},Jmat.BigInt.cloneArrayTo=function(t,a){a.length=t.length;for(var r=0;r<t.length;r++)a[r]=t[r]},Jmat.BigInt.lshift_radix=function(t,a){if(0==a)return t;if(0>a)return Jmat.BigInt.rshift_radix(t,-a);for(var r=Jmat.BigInt.copy(t),m=0;a>m;m++)r.a.push(0);return r},Jmat.BigInt.prototype.lshift_radix=function(t){return Jmat.BigInt.lshift_radix(this,t)},Jmat.BigInt.rshift_radix=function(t,a){if(0==a)return t;if(0>a)return Jmat.BigInt.lshift_radix(t,-a);var r=Jmat.BigInt.copy(t);return r.a=r.a.slice(0,-a),r},Jmat.BigInt.prototype.rshift_radix=function(t){return Jmat.BigInt.rshift_radix(this,t)},Jmat.BigInt.lshift=function(t,a){var r=Jmat.BigInt;if(0==a)return t;if(0>a)return r.rshift(t,-a);t=r.cast(t,Jmat.BigInt.ARRAYBASE_);var m=new r([],t.radix),e=Math.floor(a/r.ARRAYBASE_BITS_),n=a%r.ARRAYBASE_BITS_;if(0==n){for(var i=0;i<t.a.length;i++)m.a[i]=t.a[i];for(var i=0;e>i;i++)m.a.push(0)}else{m.a=[];for(var o=(1<<r.ARRAYBASE_BITS_-n)-1<<n,l=(1<<n)-1,i=0;i<=t.a.length;i++){var u=i>0?t.a[i-1]:0,J=i<t.a.length?t.a[i]:0,p=J<<n>>r.ARRAYBASE_BITS_&l,s=u<<n&o,x=s|p;(x||m.a.length)&&m.a.push(x)}for(var i=0;e>i;i++)m.a.push(0);0==m.a.length&&(m.a=[0])}return t.minus&&(m=m.neg()),m},Jmat.BigInt.prototype.lshift=function(t){return Jmat.BigInt.lshift(this,t)},Jmat.BigInt.rshift=function(t,a){var r=Jmat.BigInt;if(0==a)return t;if(0>a)return r.lshift(t,-a);t=r.cast(t,Jmat.BigInt.ARRAYBASE_);var m=new r([],t.radix),e=Math.floor(a/r.ARRAYBASE_BITS_),n=a%r.ARRAYBASE_BITS_;if(0==n){m.a=[];for(var i=0;i<t.a.length-e;i++)m.a.push(t.a[i]);0==m.a.length&&(m.a=[0])}else{m.a=[];for(var o=(1<<n)-1<<r.ARRAYBASE_BITS_-n,l=(1<<r.ARRAYBASE_BITS_-n)-1,i=0;i<t.a.length-e;i++){var u=i>0?t.a[i-1]:0,J=i<t.a.length?t.a[i]:0,p=u<<r.ARRAYBASE_BITS_>>n&o,s=J>>n&l;m.a.push(p|s)}0==m.a.length&&(m.a=[0])}return t.minus&&(m=m.neg()),m},Jmat.BigInt.prototype.rshift=function(t){return Jmat.BigInt.rshift(this,t)},Jmat.BigInt.bitand=function(t,a){var r=Jmat.BigInt;if(t=r.cast(t,r.ARRAYBASE_),a=r.cast(a,r.ARRAYBASE_),t.minus||a.minus){var m=Math.max(r.getNumBits(t),r.getNumBits(a));t.minus&&(t=t.addr(1).bitnot(m)),a.minus&&(a=a.addr(1).bitnot(m))}for(var e=new r([],r.ARRAYBASE_),n=Math.min(t.a.length,a.a.length),i=0;n>i;i++){var o=t.a[t.a.length-1-i]||0,l=a.a[a.a.length-1-i]||0;e.a[n-1-i]=o&l}return e},Jmat.BigInt.prototype.bitand=function(t){return Jmat.BigInt.bitand(this,t)},Jmat.BigInt.bitandr=function(t,a){var r=Jmat.BigInt;return t.minus?r.bitand(t,r(a)).toInt():(t=r.cast(t,a<r.ARRAYBASE_?r.ARRAYBASE_:2147483648),t.a[t.a.length-1]&a)},Jmat.BigInt.bitor=function(t,a){var r=Jmat.BigInt;if(t=r.cast(t,r.ARRAYBASE_),a=r.cast(a,r.ARRAYBASE_),t.minus||a.minus){var m=Math.max(r.getNumBits(t),r.getNumBits(a));t.minus&&(t=t.addr(1).bitnot(m)),a.minus&&(a=a.addr(1).bitnot(m))}for(var e=new r([],r.ARRAYBASE_),n=Math.max(t.a.length,a.a.length),i=0;n>i;i++){var o=t.a[t.a.length-1-i]||0,l=a.a[a.a.length-1-i]||0;e.a[n-1-i]=o|l}return e},Jmat.BigInt.prototype.bitor=function(t){return Jmat.BigInt.bitor(this,t)},Jmat.BigInt.bitxor=function(t,a){var r=Jmat.BigInt;if(t=r.cast(t,r.ARRAYBASE_),a=r.cast(a,r.ARRAYBASE_),t.minus||a.minus){var m=Math.max(r.getNumBits(t),r.getNumBits(a));t.minus&&(t=t.addr(1).bitnot(m)),a.minus&&(a=a.addr(1).bitnot(m))}for(var e=new r([],r.ARRAYBASE_),n=Math.max(t.a.length,a.a.length),i=0;n>i;i++){var o=t.a[t.a.length-1-i]||0,l=a.a[a.a.length-1-i]||0;e.a[n-1-i]=o^l}return e},Jmat.BigInt.prototype.bitxor=function(t){return Jmat.BigInt.bitxor(this,t)},Jmat.BigInt.bitneg=function(t){var a=Jmat.BigInt;return t=a.cast(t,Jmat.BigInt.ARRAYBASE_),t=t.addr(1),t=t.neg()},Jmat.BigInt.prototype.bitneg=function(){return Jmat.BigInt.bitneg(this)},Jmat.BigInt.bitnot=function(t,a){if(0>=a)return t;var r=Jmat.BigInt;t=r.cast(t,r.ARRAYBASE_);var m,e=r.maybecopystrip_(t.a),n=r.ARRAYBASE_-1;if(void 0!=a){m=r(0);for(var i=a%r.ARRAYBASE_BITS_,o=Math.ceil(a/r.ARRAYBASE_BITS_),l=(1<<i)-1,u=0;o>u;u++){var J=e[e.length-o+u]||0;m.a[u]=J^n,0==u&&0!=i&&(m.a[u]&=l)}}else{if(!e.length)return t;var i=Jmat.Real.ilog2(e[0])+1;if(0==i){m=r(1);for(var u=0;u<e.length;u++)m.a.push(e[u]^n)}else{var l=(2<<i)-1;m=r(0),m.a[0]=(e[0]^n)&l;for(var u=1;u<e.length;u++)m.a[u]=e[u]^n}}return m.minus=t.minus,m},Jmat.BigInt.prototype.bitnot=function(t){return Jmat.BigInt.bitnot(this,t)},Jmat.BigInt.abs=function(t){return t.abs()},Jmat.BigInt.prototype.abs=function(){return this.minus?new Jmat.BigInt(this.a,this.radix,!1):this},Jmat.BigInt.neg=function(t){return t.neg()},Jmat.BigInt.prototype.neg=function(){return new Jmat.BigInt(this.a,this.radix,!this.minus)},Jmat.BigInt.getSign=function(t){return t.getSign()},Jmat.BigInt.prototype.getSign=function(){return this.minus?-1:1},Jmat.BigInt.nonZero=function(t){return t.nonZero()},Jmat.BigInt.prototype.nonZero=function(){for(var t=0;t<this.a.length;t++)if(this.a[t])return!0;return!1},Jmat.BigInt.sign=function(t){return t.sign()},Jmat.BigInt.prototype.sign=function(){return this.nonZero()?this.getSign():0},Jmat.BigInt.add=function(t,a){return t.add(a)},Jmat.BigInt.prototype.add=function(t){return this.minus!=t.minus?this.sub(t.neg()):(t=Jmat.BigInt.cast(t,this.radix),new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,t.a,0,1,0,this.radix,!1),this.radix,this.minus))},Jmat.BigInt.addr=function(t,a){return t.addr(a)},Jmat.BigInt.prototype.addr=function(t){return this.add(Jmat.BigInt.fromInt(t))},Jmat.BigInt.sub=function(t,a){return t.sub(a)},Jmat.BigInt.prototype.sub=function(t){return this.minus!=t.minus?this.add(t.neg()):(t=Jmat.BigInt.cast(t,this.radix),this.abs().gte(t.abs())?new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,t.a,0,-1,0,this.radix,!1),this.radix,this.minus):new Jmat.BigInt(Jmat.BigInt.baseloop_(t.a,0,1,this.a,0,-1,0,this.radix,!1),this.radix,!this.minus))},Jmat.BigInt.subr=function(t,a){return t.subr(a)},Jmat.BigInt.prototype.subr=function(t){return this.sub(Jmat.BigInt.fromInt(t))},Jmat.BigInt.mul=function(t,a){return t.mul(a)},Jmat.BigInt.prototype.mul=function(t){t=Jmat.BigInt.cast(t,this.radix);var a=Jmat.BigInt.karatsuba_(this.strip().a,t.strip().a,this.radix);return new Jmat.BigInt(a,this.radix,this.minus!=t.minus)},Jmat.BigInt.mulr=function(t,a){var r=new Jmat.BigInt([],t.radix,t.minus!=0>a);return r.a=Jmat.BigInt.baseloop_(t.a,0,a,[],0,1,0,r.radix,!1),r},Jmat.BigInt.prototype.mulr=function(t){var a=new Jmat.BigInt([],this.radix,this.minus!=0>t);return a.a=Jmat.BigInt.baseloop_(this.a,0,t,[],0,1,0,a.radix,!1),a},Jmat.BigInt.karatsuba_=function(t,a,r){if(t.length<=1||a.length<=1)return Jmat.BigInt.schoolmul_(t,a,r);if(t.length<a.length)return Jmat.BigInt.karatsuba_(a,t,r);if(t.length<=20)return Jmat.BigInt.schoolmul_(t,a,r);var m=Math.floor(t.length/2),e=a.length-(t.length-m),n=t.slice(0,m),i=t.slice(m,t.length),o=0>=e?[0]:a.slice(0,e),l=0>=e?a:a.slice(e,a.length);if(0>=e){var u=Jmat.BigInt.karatsuba_(n,l,r),J=Jmat.BigInt.karatsuba_(i,l,r);return Jmat.BigInt.baseloop_(u,t.length-m,1,J,0,1,0,r,!1)}var p=Jmat.BigInt.baseloop_(n,0,1,i,0,1,0,r,!1),s=Jmat.BigInt.baseloop_(o,0,1,l,0,1,0,r,!1),u=Jmat.BigInt.karatsuba_(n,o,r),J=Jmat.BigInt.karatsuba_(i,l,r),x=Jmat.BigInt.karatsuba_(p,s,r),f=Jmat.BigInt.baseloop_(u,0,1,J,0,1,0,r,!1),c=Jmat.BigInt.baseloop_(x,0,1,f,0,-1,0,r,!1),C=t.length-m,d=2*C,g=Jmat.BigInt.baseloop_(c,C,1,J,0,1,0,r,!1);return Jmat.BigInt.baseloop_(u,d,1,g,0,1,0,r,!1)},Jmat.BigInt.schoolmul_=function(t,a,r){if(1==t.length&&0==t[0])return[0];if(1==t.length&&1==t[0])return a;if(1==a.length&&0==a[0])return[0];if(1==a.length&&1==a[0])return t;if(t.length<a.length)return Jmat.BigInt.schoolmul_(a,t,r);for(var m=[0],e=0,n=0;n<a.length;n++){var i=a[a.length-n-1];m=Jmat.BigInt.baseloop_(t,e,i,m,0,1,0,r,!1),e++}return m},Jmat.BigInt.compare=function(t,a){return t.compare(a)},Jmat.BigInt.prototype.compare=function(t){if(t.minus!=this.minus){var a=this.sign(),r=t.sign();return a==r?0:r>a?-1:1}t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix));for(var m=Math.max(this.a.length,t.a.length),e=0;m>e;e++){var n=e-m+this.a.length,i=e-m+t.a.length,o=this.a[n]||0,l=t.a[i]||0;if(l>o)return-1*this.getSign();if(o>l)return 1*this.getSign()}return 0},Jmat.BigInt.comparer=function(t,a){return t.comparer(a)},Jmat.BigInt.prototype.comparer=function(t){if(0>t!=this.minus){var a=this.sign(),r=Math.sign(t);return a==r?0:r>a?-1:1}var m=this.getSign();t=Math.abs(t);for(var e=Jmat.BigInt.getNumDigits(this),n=0,i=0;e>i&&t>=n;i++)n*=this.radix,n+=this.a[i];return(t>n?-1:n==t?0:1)*m},Jmat.BigInt.eq=function(t,a){return 0==Jmat.BigInt.compare(t,a)},Jmat.BigInt.prototype.eq=function(t){return 0==Jmat.BigInt.compare(this,t)},Jmat.BigInt.eqr=function(t,a){return 0==Jmat.BigInt.comparer(t,a)},Jmat.BigInt.prototype.eqr=function(t){return 0==Jmat.BigInt.comparer(this,t)},Jmat.BigInt.neq=function(t,a){return 0!=Jmat.BigInt.compare(t,a)},Jmat.BigInt.prototype.neq=function(t){return 0!=Jmat.BigInt.compare(this,t)},Jmat.BigInt.neqr=function(t,a){return 0!=Jmat.BigInt.comparer(t,a)},Jmat.BigInt.prototype.neqr=function(t){return 0!=Jmat.BigInt.comparer(this,t)},Jmat.BigInt.gt=function(t,a){return Jmat.BigInt.compare(t,a)>0},Jmat.BigInt.prototype.gt=function(t){return Jmat.BigInt.compare(this,t)>0},Jmat.BigInt.gtr=function(t,a){return Jmat.BigInt.comparer(t,a)>0},Jmat.BigInt.prototype.gtr=function(t){return Jmat.BigInt.comparer(this,t)>0},Jmat.BigInt.lt=function(t,a){return Jmat.BigInt.compare(t,a)<0},Jmat.BigInt.prototype.lt=function(t){return Jmat.BigInt.compare(this,t)<0},Jmat.BigInt.ltr=function(t,a){return Jmat.BigInt.comparer(t,a)<0},Jmat.BigInt.prototype.ltr=function(t){return Jmat.BigInt.comparer(this,t)<0},Jmat.BigInt.gte=function(t,a){return Jmat.BigInt.compare(t,a)>=0},Jmat.BigInt.prototype.gte=function(t){return Jmat.BigInt.compare(this,t)>=0},Jmat.BigInt.gter=function(t,a){return Jmat.BigInt.comparer(t,a)>=0},Jmat.BigInt.prototype.gter=function(t){return Jmat.BigInt.comparer(this,t)>=0},Jmat.BigInt.lte=function(t,a){return Jmat.BigInt.compare(t,a)<=0},Jmat.BigInt.prototype.lte=function(t){return Jmat.BigInt.compare(this,t)<=0},Jmat.BigInt.lter=function(t,a){return Jmat.BigInt.comparer(t,a)<=0},Jmat.BigInt.prototype.lter=function(t){return Jmat.BigInt.comparer(this,t)<=0},Jmat.BigInt.sqrt=function(t){var a=Jmat.BigInt;if(t.eqr(0))return a(0);if(t.minus)return void 0;var r=a([0],t.radix),m=Jmat.BigInt.copystrip_(t);1==m.a.length&&1==m.a[0]&&(r=a([1],t.radix)),m.a=m.a.slice(0,Math.ceil(m.a.length/2)+1),t.radix>16&&(m.a[0]=Math.min(m.a[0],Math.ceil(Math.sqrt(m.a[0]+1))));for(var e,n=a([1],t.radix);;){var i=r.add(m).divr(2),o=i.mul(i),l=a.compare(o,t);if(0==l){e=i;break}if(0>l?r=i:m=i,a.compare(m.sub(r),n)<=0){e=r;break}}return e},Jmat.BigInt.isOdd=function(t){return t.bitand(Jmat.BigInt.ONE).eqr(1)},Jmat.BigInt.isEven=function(t){return t.bitand(Jmat.BigInt.ONE).eqr(0)},Jmat.BigInt.root=function(t,a){var r=a.toInt();return 0>=r?void 0:r>Jmat.Real.BIGGESTJSINT?t.eqr(0)?B(0):B.isEven(a)&&t.minus?void 0:B(t.minus?-1:1):Jmat.BigInt.rootr(t,r)},Jmat.BigInt.rootr=function(t,a){var r=Jmat.BigInt;if(0>=a)return void 0;if(t.eqr(0))return r(0);if(1==a)return t;if(2==a)return r.sqrt(t);if(Jmat.Real.isEven(a)&&t.minus)return void 0;if(a>r.log2(t.abs()).toInt())return r(t.minus?-1:1);var m=r([0],t.radix),e=Jmat.BigInt.copystrip_(t);1==e.a.length&&1==e.a[0]&&(m=r([1],t.radix)),e.a=e.a.slice(0,Math.ceil(e.a.length/a)+1),t.radix>16&&(e.a[0]=Math.min(e.a[0],Math.ceil(Jmat.Real.root(e.a[0]+1,a))));for(var n,i=r([1],t.radix);;){var o=m.add(e).divr(2),l=r.powr(o,a),u=r.compare(l,t);if(0==u){n=o;break}if(0>u?m=o:e=o,r.compare(e.sub(m),i)<=0){n=m;break}}return n},Jmat.BigInt.perfectsquare=function(t){var a=Jmat.BigInt;if(t.minus)return null;var r=a.bitandr(t,15);if(0!=r&&1!=r&&4!=r&&9!=r)return null;var m=a.sqrt(t);return m.mul(m).eq(t)?m:null},Jmat.BigInt.perfectpow=function(t,a,r,m){var e=Jmat.BigInt,n=m?e.cast(m):void 0,i=r?e.cast(r):void 0;if(t.minus)return void 0;if(r&&m)return[i.pow(n),i,n];if(r){if(t.lter(1)&&a)return[i.mul(i),i,e(2)];var o="number"!=typeof r?r:i.toInt(),l=e.logr(t,o);a&&(l=l.addr(1));var u=i.pow(l);return[u,i,l]}if(m){var o="number"!=typeof m?m:n.toInt(),J=e.rootr(t,o);a&&(J=J.addr(1));var u=J.powr(o);return[u,J,n]}if(t.ltr(5)){var o=t.toInt();return a?0==o?[e(1),e(1),e(2)]:4==o?[e(8),e(2),e(3)]:[e(4),e(2),e(2)]:0==o?void 0:4==t?[e(4),e(2),e(2)]:[e(1),e(1),e(2)]}var l=e.log2(t).toInt();a&&l++;for(var p=t,s=0,x=e(0),f=e(0),c=2;l>=c;c++)if(c>5&&c%5==0)c++;else if(c>3&&c%3==0)c++;else{var J=e.rootr(t,c);J.eqr(2)&&(c=l),a&&(J=J.addr(1));var u=J.powr(c),C=t.sub(u).abs();if(C.lt(p)&&(p=C,s=c,x=J,f=u,C.eqr(0)))break;c>2&&c++}if(2==s||3==s||5==s){var d=Jmat.BigInt.perfectpow(x);d[0].eq(x)&&(x=d[1],s*=d[2].toInt())}return[f,x,e(s)]},Jmat.BigInt.mulmany_=function(t){if(0==t.length)return Jmat.BigInt.ONE;for(;t.length>1;){for(var a=Math.floor(t.length/2),r=[],m=0;a>m;m++)r.push(t[m].mul(t[t.length-m-1]));t.length%2==1&&r.push(t[a]),t=r}return t[0]},Jmat.BigInt.factorial=function(t){var a=Jmat.BigInt,r=t.toInt();if(r==1/0)return void 0;if(20>r)return a(Jmat.Real.factorial(r));for(var m=Jmat.Real.eratosthenes(r),e=[],n=0;n<m.length;n++){for(var i=m[n],o=Math.floor(r/i),l=0;o>0;)l+=o,o=Math.floor(o/i);e[n]=a.powr(a(i),l)}return a.mulmany_(e)},Jmat.BigInt.primorial=function(t){var a=Jmat.BigInt,r=t.toInt();if(r==1/0)return void 0;var m=Jmat.Real.eratosthenes(r);return a.mulmany_(m)},Jmat.BigInt.nearestPrime=function(t){var a=Jmat.BigInt;if(t.lter(2))return a(2);if(t.lter(4))return a(3);var r=a.previousPrime(t),m=t.sub(r);return a.previousPrime(t.add(m).subr(1))},Jmat.BigInt.nextPrime=function(t){var a=Jmat.BigInt;if(t.ltr(2))return a(2);if(t.ltr(3))return a(3);var r=t.modr(6).toInt(),m=2;for(0==r||5==r?(t=t.addr(0==r?1:2),m=4):t=t.addr(5-r);;){if(a.isPrime(t))return t;t=t.addr(m),m^=6}},Jmat.BigInt.previousPrime=function(t){var a=Jmat.BigInt;if(t.lter(7))return t.lter(2)?void 0:a(t.lter(3)?2:t.lter(5)?3:5);var r=t.modr(6).toInt(),m=2;for(0==r||1==r?(t=t.subr(r+1),m=4):t=t.subr(r-1);;){if(a.isPrime(t))return t;t=t.subr(m),m^=6}},Jmat.BigInt.min=function(t,a){return t.lt(a)?t:a},Jmat.BigInt.max=function(t,a){return t.gt(a)?t:a},Jmat.BigInt.primeCache_=[],Jmat.BigInt.factorize=function(t){var a=Jmat.BigInt;if(t.eqr(0))return[a(0)];if(t.eqr(1))return[a(1)];for(var r=function(t){if(a.isPrime(t))return t;for(var m=Math.min(1e6,a.sqrt(t).toInt()),e=1,n=0;n>=a.primeCache_.length&&(a.primeCache_[n]=Jmat.Real.nextPrime(e)),e=a.primeCache_[n],n++,!(e!=e||e>m);)if(t.modr(e).eqr(0))return a(e);var i=a.perfectpow(t);return i[0].eq(t)&&i[1].lt(t)?r(i[1]):a(0)},m=[];;){var e=r(t);if(e.eqr(0))return m.push(a(0)),m;if(m.push(e),e.eqr(t))return m;t=t.div(e)}},Jmat.BigInt.logy=function(t,a){return Jmat.BigInt.logr(t,a.toInt())},Jmat.BigInt.logr=function(t,a){if(t.eqr(a))return Jmat.BigInt(1);if(t.minus||0>a)return void 0;if(t.eqr(0))return void 0;if(1==a)return t;if(2==a)return Jmat.BigInt.log2(t);var r=Jmat.BigInt.convertBase(t,a),m=Jmat.BigInt.fromInt(Jmat.BigInt.getNumDigits(r)-1,t.radix);return m},Jmat.BigInt.log2=function(t){if(t.minus)return void 0;var a=Jmat.BigInt.getNumBits(t);return 0==a?void 0:Jmat.BigInt.fromInt(a-1)},Jmat.BigInt.log10=function(t){return Jmat.BigInt.logr(t,10)},Jmat.BigInt.rlog2=function(t){var a=Jmat.BigInt.getNumBits(t);return a>128?(t=Jmat.BigInt.rshift(t,a-128),Jmat.Real.log2(t.toInt())+a-128):Jmat.Real.log2(t.toInt())},Jmat.BigInt.rlog=function(t){return Jmat.BigInt.rlog2(t)*Math.LN2},Jmat.BigInt.rlog10=function(t){return Jmat.BigInt.rlog2(t)/3.321928094887362},Jmat.BigInt.div=function(t,a){return t.div(a)},Jmat.BigInt.prototype.div=function(t){return t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix)),Jmat.BigInt.divmod_(this,t)[0]},Jmat.BigInt.mod=function(t,a){return t.mod(a)},Jmat.BigInt.prototype.mod=function(t){return t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix)),Jmat.BigInt.divmod_(this,t)[1]},Jmat.BigInt.divmod=function(t,a){return t.divmod(a)},Jmat.BigInt.prototype.divmod=function(t){return t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix)),t.abs().ltr(65536)?Jmat.BigInt.divsmall_(this,t.toInt()):Jmat.BigInt.divmod_(this,t)},Jmat.BigInt.divr=function(t,a){return 0==a?void 0:1==a?t:-1==a?t.neg():t.abs().ltr(Math.abs(a))?Jmat.BigInt(0):t.eqr(a)?Jmat.BigInt(1):Math.abs(a)<65536?Jmat.BigInt.divsmall_(t,a)[0]:Jmat.BigInt.div(t,Jmat.BigInt(a))},Jmat.BigInt.prototype.divr=function(t){return Jmat.BigInt.divr(this,t)},Jmat.BigInt.half_=function(t){if(Jmat.Real.isPOT(t.radix)){var a=t.a[t.a.length-1]%2;return[Jmat.BigInt.rshift(t,1),Jmat.BigInt(a)]}for(var r=[],m=t.radix,e=0,n=0;n<t.a.length;n++){var i=t.a[n]+e;e=Jmat.Real.isOdd(i)?m:0;var o=Math.floor(i/2);(o>0||r.length>0)&&r.push(o)}return[new Jmat.BigInt(r,m,t.minus),0==e?Jmat.BigInt(0,m):Jmat.BigInt(1,m)]},Jmat.BigInt.divsmall_=function(t,a){if(a==t.radix)return[t.rshift_radix(t),Jmat.BigInt(0)];if(2==a)return Jmat.BigInt.half_(t);if(-2==a){var r=Jmat.BigInt.half_(t);return[r[0].neg(),r[1].neg()]}var m=t.minus,e=0>a,n=t.minus!=0>a;a=Math.abs(a);for(var i=[],o=t.radix,l=0,u=0;u<t.a.length;u++){var J=t.a[u]+l*o;l=J%a;var p=Math.floor(J/a);(p>0||i.length>0)&&i.push(p)}var s=Jmat.BigInt(l,o);return l&&(m&&e?s=s.neg():e?s=s.subr(a):m&&(s=s.subr(a).neg())),[new Jmat.BigInt(i,o,n),s]},Jmat.BigInt.modr=function(t,a){return 0==a?void 0:1==a||-1==a?Jmat.BigInt(0):Math.abs(a)<t.radix&&t.radix%a==0?Jmat.BigInt(Jmat.Real.mod(t.a[t.a.length-1],a)):Math.abs(a)<65536?Jmat.BigInt.divsmall_(t,a)[1]:Jmat.BigInt.mod(t,Jmat.BigInt(a))},Jmat.BigInt.prototype.modr=function(t){return Jmat.BigInt.modr(this,t)},Jmat.BigInt.leemondiv_=function(t,a,r){var m,e,n,i,o,l,u,J,p=Jmat.BigInt,s=t.radix,x=t.radix-1,f=p.copy(t);for(t=t.strip(),a=p.copystrip_(a),e=a.a.length,J=a.a[a.a.length-1-e+1],u=0;J;u++)J>>=1;for(u=r-u,a=a.lshift(u),f=f.lshift(u),a.a.splice(0,0,0),m=Math.max(e,f.a.length);f.a.length<t.a.length+1;)f.a.splice(0,0,0);for(var c=p(0,s),n=0;n<t.a.length;n++)c.a[n]=0;for(c.a.splice(0,0,0);;){var C=a.lshift_radix(m-e);if(C.gt(f))break;f=f.sub(C),c.a[c.a.length-m+e-1]++}for(n=m-1;n>=e;n--){var d=f.a.length-1,g=c.a.length-1,v=a.a.length-1;for(f.a[d-n]==a.a[v-(e-1)]?c.a[g-(n-e)]=x:c.a[g-(n-e)]=Math.floor((f.a[d-n]*s+f.a[d-(n-1)])/a.a[v-(e-1)]);o=(e>1?a.a[v-(e-2)]:0)*c.a[g-(n-e)],l=o>>r,o&=x,i=l+c.a[g-(n-e)]*a.a[v-(e-1)],l=i>>r,i&=x,l==f.a[d-n]?i==f.a[d-(n-1)]?o>(n>1?f.a[d-(n-2)]:0):i>f.a[d-(n-1)]:l>f.a[d-n];)c.a[g-(n-e)]--;var h=a.lshift_radix(n-e),I=h.mulr(c.a[g-(n-e)]);f.lt(I)?(f.a=Jmat.BigInt.baseloop_(f.a,0,1,h.a,0,1,0,s,!0),f.a=Jmat.BigInt.baseloop_(f.a,0,1,I.a,0,-1,0,s,!0),c.a[g-(n-e)]--):f.a=Jmat.BigInt.baseloop_(f.a,0,1,I.a,0,-1,0,s,!0)}return f=f.rshift(u),[c,f]},Jmat.BigInt.divmod_=function(t,a,r){var m=Jmat.BigInt;if(a.eqr(0))return void 0;if(a.eqr(1))return[t,m(0)];if(a.eqr(-1))return[t.neg(),m(0)];if(a.abs().ltr(65536))return Jmat.BigInt.divsmall_(t,a.toInt());if(a.abs().gt(t.abs()))return[m(0),t];if(a.eq(t))return[m(1),m(0)];var e=t.minus!=a.minus;t=t.abs(),a=a.abs(),r||(t=m.cast(t,m.ARRAYBASE_),a=m.cast(a,m.ARRAYBASE_));var n=m.leemondiv_(t,a,r||m.ARRAYBASE_BITS_),i=n[0],o=n[1];return i=i.strip(),o=o.strip(),e&&(i=i.neg(),o=o.add(a),o.minus&&o.eqr(0)&&(o.minus=!1)),[i,o]},Jmat.BigInt.pow=function(t,a){var r=a;a=Jmat.BigInt.cast(a,2);var m=t.radix;if(a.minus)return Jmat.BigInt(0,m);var e=!1;t.minus&&a.modr(2).eqr(1)&&(e=!0),t=t.abs();for(var n=Jmat.BigInt.maybecopystrip_(a.a,a!=r),i=Jmat.BigInt(1,m),o=t,l=n.length,u=0;l>u;u++)0==n[u]?(o=i.mul(o),i=i.mul(i)):(i=i.mul(o),o=o.mul(o));return e&&(i=i.neg()),i},Jmat.BigInt.prototype.pow=function(t){return Jmat.BigInt.pow(this,t)},Jmat.BigInt.powr=function(t,a){return Jmat.BigInt.pow(t,Jmat.BigInt.fromInt(a))},Jmat.BigInt.prototype.powr=function(t){return Jmat.BigInt.pow(this,Jmat.BigInt.fromInt(t))},Jmat.BigInt.gcd=function(t,a){var r=Jmat.BigInt;for(t=t.abs(),a=a.abs();;){if(a.eqr(0))return t;var m=r.mod(t,a);t=a,a=m}},Jmat.BigInt.egcd=function(t,a){for(var r,m=Jmat.BigInt,e=m(0),n=m(1),i=m(1),o=m(0),l=t,u=a;!l.eqr(0);){var J=u.div(l);r=l,l=u.sub(J.mul(l)),u=r,r=e,e=n.sub(J.mul(e)),n=r,r=i,i=o.sub(J.mul(i)),o=r}return(i.sign()!=t.sign()||e.sign()!=a.sign())&&(r=i,i=e,e=r,r=o,o=n,n=r,i.sign()!=t.sign()&&(i=i.neg()),e.sign()!=a.sign()&&(e=e.neg())),[u,n,o,i,e]},Jmat.BigInt.invmod=function(t,a){for(var r,m=Jmat.BigInt,e=a,n=m(1),i=m(0);;){if(t.eqr(1)){r=n;break}if(t.eqr(0)){r=m(0);break}var o=a.divmod(t);if(i=i.sub(n.mul(o[0])),a=o[1],a.eqr(1)){r=i;break}if(a.eqr(0)){r=m(0);break}o=t.divmod(a),n=n.sub(i.mul(o[0])),t=o[1]}return r.minus&&(r=e.add(r)),r},Jmat.BigInt.monred_=function(t,a,r,m,e){var n=t.mul(e).bitand(r),i=t.add(n.mul(m)).rshift(a);return i.gte(m)&&(i=i.sub(m)),i},Jmat.BigInt.genmonred_=function(t){var a=Jmat.BigInt.getNumBits(t),r=Jmat.BigInt.lshift(Jmat.BigInt(1),a),m=r.subr(1),e=Jmat.BigInt.invmod(t,r).neg().bitand(m),n=r.lshift(a).mod(t);return function(r,i){return i?Jmat.BigInt.monred_(r.mul(n),a,m,t,e):Jmat.BigInt.monred_(r,a,m,t,e)}},Jmat.BigInt.modpow=function(t,a,r,m){var e=Jmat.BigInt,n=a;a=e.cast(a,2);var i=e.maybecopystrip_(a.a,a!=n),o=e.ONE,l=t,u=i.length;if(r.modr(2).eqr(1)&&u>1){var J=m||e.genmonred_(r);o=J(o,!0),l=J(l,!0);for(var p=0;u>p;p++)0==i[p]?(l=o.mul(l),o=o.mul(o)):(o=o.mul(l),l=l.mul(l)),o=J(o),l=J(l);return o=J(o)}for(var p=0;u>p;p++)0==i[p]?(l=o.mul(l).mod(r),o=o.mul(o).mod(r)):(o=o.mul(l).mod(r),l=l.mul(l).mod(r));return o;
},Jmat.BigInt.randomBits=function(t){for(var a=Jmat.BigInt([],Jmat.BigInt.ARRAYBASE_),r=Math.ceil(t/Jmat.BigInt.ARRAYBASE_BITS_),m=0;r>m;m++)a.a[m]=Math.floor(Jmat.BigInt.ARRAYBASE_*Math.random());for(var e=t*(Jmat.BigInt.ARRAYBASE_BITS_-1)%Jmat.BigInt.ARRAYBASE_BITS_,n=Jmat.BigInt.ARRAYBASE_-1,m=0;e>m;m++)n=Math.floor(n/2);return n+1<Jmat.BigInt.ARRAYBASE_&&(a.a[0]&=n),a},Jmat.BigInt.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],Jmat.BigInt.isPrimeSimple=function(t){if(t=Jmat.BigInt.cast(t),t.ltr(2))return 0;for(var a=0;a<Jmat.BigInt.firstPrimes_.length;a++){if(t.eqr(Jmat.BigInt.firstPrimes_[a]))return 1;if(0==t.modr(Jmat.BigInt.firstPrimes_[a]).toInt())return 0}return-1},Jmat.BigInt.isPrimeMillerRabin=function(t,a){for(var r=Jmat.BigInt,m=t.divr(2),e=r.ONE;r.bitand(m,r.ONE).eqr(0);)m=m.divr(2),e=e.addr(1);for(var n=r.genmonred_(t),i=function(t,a,m,e){for(var i,o=r.modpow(e,m,t,n);!a.eqr(0);){if(i=o.mul(o).mod(t),i.eqr(1)&&!o.eqr(1)&&!o.eq(t.subr(1)))return!1;o=i,a=a.subr(1)}return i.eqr(1)},o=0;o<a.length;o++)if(!i(t,e,m,r.cast(a[o])))return!1;return!0},Jmat.BigInt.chooseMillerRabinBase_=function(t){var a,r=Jmat.BigInt.getNumBits(t);if(64>=r)a=t.ltr(1373653)?[2,3]:t.ltr(9080191)?[31,73]:t.ltr(4759123141)?[2,7,61]:t.ltr(1122004669633)?[2,13,23,1662803]:t.ltr(2152302898747)?[2,3,5,7,11]:t.ltr(3474749660383)?[2,3,5,7,11,13]:t.ltr(341550071728321)?[2,3,5,7,11,13,17]:t.ltr(0xd655278977733)?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022];else{a=[2,3];for(var m=0;18>m;m++)a.push(Jmat.BigInt.randomBits(r-1))}return a},Jmat.BigInt.isPrime=function(t){var a=Jmat.BigInt.isPrimeSimple(t);if(-1!=a)return!!a;var r=Jmat.BigInt.chooseMillerRabinBase_(t);return Jmat.BigInt.isPrimeMillerRabin(t,r)},Jmat.BigInt.d_=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Jmat.BigInt.di_=function(t){var a=t.charCodeAt(0);return 57>=a?a-48:(a>90&&(a-=32),a-65+10)},Jmat.BigInt.mirror_=function(t){for(var a=0;a<t.length/2;a++){var r=t[a];t[a]=t[t.length-a-1],t[t.length-a-1]=r}},Jmat.BigInt.getNumBits=function(t){var a=t.radix&&0==(t.radix&t.radix-1);a||(t=Jmat.BigInt.cast(t,Jmat.BigInt.ARRAYBASE_));var r=Jmat.BigInt.maybecopystrip_(t.a);if(0==r.length)return 0;var m=Jmat.Real.ilog2(r[0])+1;if(r.length>0){var e=Jmat.Real.ilog2(t.radix);m+=e*(r.length-1)}return m},Jmat.BigInt.getNumDigits=function(t){for(var a=0;a<t.a.length&&0==t.a[a];)a++;return t.a.length-a},Jmat.BigInt.stripInPlace_=function(t){for(;0==t[0]&&t.length>1;)t.shift()},Jmat.BigInt.copystrip_=function(t){for(var a=0,r=0;r<t.a.length&&0==t.a[r];r++)a++;var m=new Array(t.a.length-a);if(0==m.length)return new Jmat.BigInt([0],t.radix);for(var r=0;r<m.length;r++)m[r]=t.a[r+a];return Jmat.BigInt(m,t.radix)},Jmat.BigInt.maybecopystrip_=function(t,a){return t.length<=1||0!=t[0]?t:(a||(t=Jmat.BigInt.copyarray_(t)),Jmat.BigInt.stripInPlace_(t),t)},Jmat.BigInt.strip=function(t){return t.strip()},Jmat.BigInt.prototype.strip=function(){return this.a.length<=1||0!=this.a[0]?this:Jmat.BigInt.copystrip_(this)},Jmat.BigInt.copyarray_=function(t){return t.slice(0)},Jmat.BigInt.FORMAT_UNKNOWN_=0,Jmat.BigInt.FORMAT_BIGINT_=1,Jmat.BigInt.FORMAT_ARRAY_=2,Jmat.BigInt.FORMAT_STRING_=3,Jmat.BigInt.getFormat=function(t){return"string"==typeof t?Jmat.BigInt.FORMAT_STRING_:"[object Array]"===toString.call(t)?Jmat.BigInt.FORMAT_ARRAY_:t instanceof Jmat.BigInt?Jmat.BigInt.FORMAT_BIGINT_:Jmat.BigInt.FORMAT_UNKNOWN_},Jmat.BigInt.toFormat=function(t,a,r){if(void 0==t)return void 0;if(a==Jmat.BigInt.getFormat(t)){if(void 0==r)return t;if(a==Jmat.BigInt.FORMAT_BIGINT_)return t.minus==r?t:t.neg();if(a==Jmat.BigInt.FORMAT_STRING_)return"-"==t[0]==r?t:r?"-"+t:t.substr(1)}return t=Jmat.BigInt.cast(t),void 0!=r&&t.minus!=r&&(t=t.neg()),a==Jmat.BigInt.FORMAT_BIGINT_?t:a==Jmat.BigInt.FORMAT_ARRAY_?t.a:a==Jmat.BigInt.FORMAT_STRING_?t.toString():a==Jmat.BigInt.FORMAT_UNKNOWN_?t.toString():t},Jmat.BigInt.enrichFunction_=function(t,a,r,m){if(3==m)return Jmat.BigInt.enrichFunction_(a,r,0),void(r>1&&Jmat.BigInt.enrichFunction_(a,r-1,2));if(4==m)return Jmat.BigInt.enrichFunction_(a,r,1),void(r>1&&Jmat.BigInt.enrichFunction_(a,r-1,2));var e=2==m?Jmat.BigInt.prototype[a]:Jmat.BigInt[a],n=function(){for(var t=Jmat.BigInt.getFormat(arguments[0]),a=0;r>a;a++)arguments[a]=Jmat.BigInt.cast(arguments[a]);var n=e.apply(this,arguments);return 1==m?Jmat.BigInt.toFormat(n,t):n};2==e.length&&2==r&&1==m&&(n=function(t,a){var r=e(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a));return Jmat.BigInt.toFormat(r,Jmat.BigInt.getFormat(t))}),1==e.length&&1==r&&2==m&&(n=function(t){return e.call(this,Jmat.BigInt.cast(t))}),2==m?t.prototype[a]=n:t[a]=n},Jmat.BigInt.enrichFunctions_=function(){var t=0,a=!0;if(a){Jmat.BigIntC=function(){return Jmat.BigInt.apply(this,arguments)};for(var r in Jmat.BigInt)Jmat.BigIntC[r]=Jmat.BigInt[r];for(var r in Jmat.BigInt.prototype)Jmat.BigIntC.prototype[r]=Jmat.BigInt.prototype[r]}var m=a?Jmat.BigIntC:Jmat.BigInt;Jmat.BigInt.enrichFunction_(m,"add",2,1+t),Jmat.BigInt.enrichFunction_(m,"addr",1,1+t),Jmat.BigInt.enrichFunction_(m,"sub",2,1+t),Jmat.BigInt.enrichFunction_(m,"subr",1,1+t),Jmat.BigInt.enrichFunction_(m,"mul",2,1+t),Jmat.BigInt.enrichFunction_(m,"mulr",1,1+t),Jmat.BigInt.enrichFunction_(m,"div",2,1+t),Jmat.BigInt.enrichFunction_(m,"divr",1,1+t),Jmat.BigInt.enrichFunction_(m,"mod",2,1+t),Jmat.BigInt.enrichFunction_(m,"modr",1,1+t),Jmat.BigInt.enrichFunction_(m,"divmod",2,0+t),Jmat.BigInt.enrichFunction_(m,"lshift",1,1+t),Jmat.BigInt.enrichFunction_(m,"rshift",1,1+t),Jmat.BigInt.enrichFunction_(m,"bitand",2,1+t),Jmat.BigInt.enrichFunction_(m,"bitor",2,1+t),Jmat.BigInt.enrichFunction_(m,"bitxor",2,1+t),Jmat.BigInt.enrichFunction_(m,"bitneg",1,1+t),Jmat.BigInt.enrichFunction_(m,"bitnot",1,1+t),Jmat.BigInt.enrichFunction_(m,"abs",1,1+t),Jmat.BigInt.enrichFunction_(m,"neg",1,1+t),Jmat.BigInt.enrichFunction_(m,"sign",1,0),Jmat.BigInt.enrichFunction_(m,"getSign",1,0),Jmat.BigInt.enrichFunction_(m,"nonZero",1,0),Jmat.BigInt.enrichFunction_(m,"compare",2,0+t),Jmat.BigInt.enrichFunction_(m,"comparer",1,0+t),Jmat.BigInt.enrichFunction_(m,"sqrt",1,1),Jmat.BigInt.enrichFunction_(m,"root",2,1),Jmat.BigInt.enrichFunction_(m,"rootr",1,1),Jmat.BigInt.enrichFunction_(m,"logy",2,1),Jmat.BigInt.enrichFunction_(m,"logr",1,1),Jmat.BigInt.enrichFunction_(m,"log2",1,1),Jmat.BigInt.enrichFunction_(m,"log10",1,1),Jmat.BigInt.enrichFunction_(m,"rlog2",1,0),Jmat.BigInt.enrichFunction_(m,"rlog",1,0),Jmat.BigInt.enrichFunction_(m,"rlog10",1,0),Jmat.BigInt.enrichFunction_(m,"pow",2,1+t),Jmat.BigInt.enrichFunction_(m,"powr",1,1+t),Jmat.BigInt.enrichFunction_(m,"gcd",2,1),Jmat.BigInt.enrichFunction_(m,"egcd",2,0),Jmat.BigInt.enrichFunction_(m,"invmod",2,1),Jmat.BigInt.enrichFunction_(m,"modpow",3,1),Jmat.BigInt.enrichFunction_(m,"isPrimeSimple",1,0),Jmat.BigInt.enrichFunction_(m,"isPrimeMillerRabin",1,0),Jmat.BigInt.enrichFunction_(m,"isPrime",1,0),Jmat.BigInt.enrichFunction_(m,"perfectpow",1,0),Jmat.BigInt.enrichFunction_(m,"nextPrime",1,1),Jmat.BigInt.enrichFunction_(m,"factorize",1,0),Jmat.BigInt.enrichFunction_(m,"factorial",1,1),Jmat.BigInt.enrichFunction_(m,"primorial",1,1)},Jmat.BigInt.enrichFunctions_(),Jmat.Quaternion=function(t,a,r,m){return this instanceof Jmat.Quaternion?(this.w=t,this.x=a,this.y=r,this.z=m,void 0):Jmat.Quaternion.make(t,a,r,m)},Jmat.Quaternion.make=function(t,a,r,m){return void 0==t?new Jmat.Quaternion(0,0,0,0):"number"==typeof t?new Jmat.Quaternion(t,a||0,r||0,m||0):"string"==typeof t?Jmat.Quaternion.parse(t):void 0!=t.re?new Jmat.Quaternion(t.re,t.im||0,a&&a.re||0,a&&a.im||0):t.e&&2==t.w&&2==t.h?Jmat.Quaternion.from2x2(t):t.e&&4==t.w&&4==t.h?Jmat.Quaternion.from4x4(t):Jmat.Quaternion.copy(t)},Jmat.Quaternion.cast=function(t){return t&&void 0!=t.w?t:void 0==t?Jmat.Quaternion(0):Jmat.Quaternion(t)},Jmat.Quaternion.copy=function(t){return new Jmat.Quaternion(t.w,t.x,t.y,t.z)},Jmat.Quaternion.toString=function(t,a){if(!t)return 0==t?"invalid0":""+t;var r=a?Jmat.Complex.formatFloat_(t.w,a):""+t.w,m=a?Jmat.Complex.formatFloat_(t.x,a):""+t.x,e=a?Jmat.Complex.formatFloat_(t.x,a):""+t.y,n=a?Jmat.Complex.formatFloat_(t.x,a):""+t.z,i="";return 0!=t.w&&(i+=r),0!=t.x&&(i+=(0==i.length||t.x<0?m:"+"+m)+"i"),0!=t.y&&(i+=(0==i.length||t.y<0?e:"+"+e)+"j"),0!=t.z&&(i+=(0==i.length||t.z<0?n:"+"+n)+"k"),i},Jmat.Quaternion.prototype.toString=function(t){return Jmat.Quaternion.toString(this,t)},Jmat.Quaternion.parse=function(t){t=t.replace(/ /g,"");for(var a=t.split(/\b/),r=[],m=!1,e=0;e<a.length;e++){var n=a[e];0!=e&&(m||"-"!=n[0]&&"+"!=n[0])||r.push(""),r[r.length-1]+=n,m="e"==n[n.length-1]||"E"==n[n.length-1]}for(var i=0,o=0,l=0,u=0,e=0;e<r.length;e++){var n=r[e],J=n[n.length-1];"i"==J||"j"==J||"k"==J?(n=n.substr(0,n.length-1),(""==n||"+"==n)&&(n="1"),"-"==n&&(n="-1"),"i"==J&&(o=parseFloat(n)),"j"==J&&(l=parseFloat(n)),"k"==J&&(u=parseFloat(n))):i=parseFloat(n)}return new Jmat.Quaternion(i,o,l,u)},Jmat.Quaternion.add=function(t,a){return new Jmat.Quaternion(t.w+a.w,t.x+a.x,t.y+a.y,t.z+a.z)},Jmat.Quaternion.prototype.add=function(t){return new Jmat.Quaternion(this.w+t.w,this.x+t.x,this.y+t.y,this.z+t.z)},Jmat.Quaternion.sub=function(t,a){return new Jmat.Quaternion(t.w-a.w,t.x-a.x,t.y-a.y,t.z-a.z)},Jmat.Quaternion.prototype.sub=function(t){return new Jmat.Quaternion(this.w-t.w,this.x-t.x,this.y-t.y,this.z-t.z)},Jmat.Quaternion.mul=function(t,a){var r=t.w*a.w-t.x*a.x-t.y*a.y-t.z*a.z,m=t.w*a.x+t.x*a.w+t.y*a.z-t.z*a.y,e=t.w*a.y-t.x*a.z+t.y*a.w+t.z*a.x,n=t.w*a.z+t.x*a.y-t.y*a.x+t.z*a.w;return new Jmat.Quaternion(r,m,e,n)},Jmat.Quaternion.prototype.mul=function(t){return Jmat.Quaternion.mul(this,t)},Jmat.Quaternion.mulr=function(t,a){return new Jmat.Quaternion(t.w*a,t.x*a,t.y*a,t.z*a)},Jmat.Quaternion.prototype.mulr=function(t){return new Jmat.Quaternion(this.w*t,this.x*t,this.y*t,this.z*t)},Jmat.Quaternion.divr=function(t,a){return new Jmat.Quaternion(t.w/a,t.x/a,t.y/a,t.z/a)},Jmat.Quaternion.prototype.divr=function(t){return new Jmat.Quaternion(this.w/t,this.x/t,this.y/t,this.z/t)},Jmat.Quaternion.addr=function(t,a){return new Jmat.Quaternion(t.w+a,t.x,t.y,t.z)},Jmat.Quaternion.prototype.addr=function(t){return new Jmat.Quaternion(this.w+t,this.x,this.y,this.z)},Jmat.Quaternion.subr=function(t,a){return new Jmat.Quaternion(t.w-a,t.x,t.y,t.z)},Jmat.Quaternion.prototype.subr=function(t){return new Jmat.Quaternion(this.w-t,this.x,this.y,this.z)},Jmat.Quaternion.rsub=function(t,a){return new Jmat.Quaternion(a-t.w,-t.x,-t.y,-t.z)},Jmat.Quaternion.prototype.rsub=function(t){return new Jmat.Quaternion(t-this.w,-this.x,-this.y,-this.z)},Jmat.Quaternion.neg=function(t){return Jmat.Quaternion(-t.w,-t.x,-t.y,-t.z)},Jmat.Quaternion.prototype.neg=function(){return Jmat.Quaternion(-this.w,-this.x,-this.y,-this.z)},Jmat.Quaternion.conj=function(t){return Jmat.Quaternion(t.w,-t.x,-t.y,-t.z)},Jmat.Quaternion.prototype.conj=function(){return Jmat.Quaternion(this.w,-this.x,-this.y,-this.z)},Jmat.Quaternion.abs=function(t){return Jmat.Quaternion(t.abs())},Jmat.Quaternion.prototype.abs=function(){return Math.sqrt(this.abssq())},Jmat.Quaternion.abssq=function(t){return Jmat.Quaternion(t.abssq())},Jmat.Quaternion.prototype.abssq=function(){return this.w==-(1/0)||this.x==-(1/0)||this.y==-(1/0)||this.z==-(1/0)?1/0:this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z},Jmat.Quaternion.absv=function(t){return Jmat.Quaternion(t.absv())},Jmat.Quaternion.prototype.absv=function(){return Math.sqrt(this.absvsq())},Jmat.Quaternion.absvsq=function(t){return Jmat.Quaternion(t.abssq())},Jmat.Quaternion.prototype.absvsq=function(){return this.x==-(1/0)||this.y==-(1/0)||this.z==-(1/0)?1/0:this.x*this.x+this.y*this.y+this.z*this.z},Jmat.Quaternion.arg=function(t){return Jmat.Quaternion(t.arg())},Jmat.Quaternion.prototype.arg=function(){return Math.atan2(this.absv(),this.w)},Jmat.Quaternion.inv=function(t){return t.conj().divr(t.abssq())},Jmat.Quaternion.prototype.inv=function(){return this.conj().divr(this.abssq())},Jmat.Quaternion.div=function(t,a){return t.mul(a.inv())},Jmat.Quaternion.prototype.div=function(t){return this.mul(t.inv())},Jmat.Quaternion.leftdiv=function(t,a){return t.inv().mul(a)},Jmat.Quaternion.prototype.leftdiv=function(t){return this.inv().mul(t)},Jmat.Quaternion.sign=function(t){var a=t.abs();return 0==a?t:t.divr(a)},Jmat.Quaternion.normalize=Jmat.Quaternion.sign,Jmat.Quaternion.prototype.normalize=function(){return Jmat.Quaternion.sign(this)},Jmat.Quaternion.to2x2=function(t){var a=Jmat.Complex;return Jmat.Matrix([[a(t.w,t.x),a(t.y,t.z)],[a(-t.y,t.z),a(t.w,-t.x)]])},Jmat.Quaternion.from2x2=function(t){var a=t.e[0][0],r=t.e[0][1];return new Jmat.Quaternion(a.re,a.im,r.re,r.im)},Jmat.Quaternion.to4x4=function(t){return Jmat.Matrix([[t.w,t.x,t.y,t.z],[-t.x,t.w,-t.z,t.y],[-t.y,t.z,t.w,-t.x],[-t.z,-t.y,t.x,t.w]])},Jmat.Quaternion.from4x4=function(t){var a=t.e[0];return new Jmat.Quaternion(a[0].re,a[1].re,a[2].re,a[3].re)},Jmat.Quaternion.to3x3rot=function(t){var a=t.w*t.w,r=t.x*t.x,m=t.y*t.y,e=t.z*t.z;return Jmat.Matrix([[a+r-m-e,2*t.x*t.y-2*t.w*t.z,2*t.x*t.z+2*t.w*t.y],[2*t.x*t.y+2*t.w*t.z,a-r+m-e,2*t.y*t.z-2*t.w*t.x],[2*t.x*t.z-2*t.w*t.y,2*t.y*t.z+2*t.w*t.x,a-r-m+e]])},Jmat.Quaternion.from3x3rot=function(t){var a=t.e,r=1+a[0][0].re+a[1][1].re+a[2][2].re;if(r>1e-7){var m=2*Math.sqrt(r);return new Jmat.Quaternion(.25*m,(a[2][1].re-a[1][2].re)/m,(a[0][2].re-a[2][0].re)/m,(a[1][0].re-a[0][1].re)/m)}if(a[0][0].re>a[1][1].re&&a[0][0].re>a[2][2].re){var m=2*Math.sqrt(1+a[0][0].re-a[1][1].re-a[2][2].re);return new Jmat.Quaternion((a[2][1].re-a[1][2].re)/m,.25*m,(a[1][0].re+a[0][1].re)/m,(a[0][2].re-a[2][0].re)/m)}if(a[1][1].re>a[2][2].re){var m=2*Math.sqrt(1+a[1][1].re-a[0][0].re-a[2][2].re);return new Jmat.Quaternion((a[0][2].re-a[2][0].re)/m,(a[1][0].re+a[0][1].re)/m,.25*m,(a[2][1].re+a[1][2].re)/m)}var m=2*Math.sqrt(1+a[2][2].re-a[0][0].re-a[1][1].re);return new Jmat.Quaternion((a[1][0].re-a[0][1].re)/m,(a[0][2].re+a[2][0].re)/m,(a[2][1].re+a[1][2].re)/m,.5*m)},Jmat.Quaternion.prototype.getVector=function(){return Jmat.Matrix([[this.x],[this.y],[this.z]])},Jmat.Quaternion.prototype.qvector=function(){return new Jmat.Quaternion(0,this.x,this.y,this.z)},Jmat.Quaternion.exp=function(t){var a=Math.exp(t.w),r=t.absv(),m=Math.cos(r),e=Math.sin(r),n=a*e/r;return new Jmat.Quaternion(a*m,n*t.x,n*t.y,n*t.z)},Jmat.Quaternion.log=function(t){var a=t.abs(),r=t.absv();if(0==r)return new Jmat.Quaternion(Math.log(t.w),0,0,0);var m=Math.acos(t.w/a),e=m/r;return new Jmat.Quaternion(Math.log(a),e*t.x,e*t.y,e*t.z)},Jmat.Quaternion.logy=function(t,a){return Jmat.Quaternion.log(t).div(Jmat.Quaternion.log(a))},Jmat.Quaternion.logr=function(t,a){return Jmat.Quaternion.log(t).divr(Math.log(a))},Jmat.Quaternion.log2=function(t){return Jmat.Quaternion.log(t).divr(Math.LN2)},Jmat.Quaternion.log10=function(t){return Jmat.Quaternion.log(t).divr(Math.LN10)},Jmat.Quaternion.pow=function(t,a){var r=Jmat.Quaternion;return r.exp(r.log(t).mul(a))},Jmat.Quaternion.prototype.pow=function(t){return Jmat.Quaternion.pow(this,t)},Jmat.Quaternion.powr=function(t,a){var r=Jmat.Quaternion;return r.exp(r.log(t).mulr(a))},Jmat.Quaternion.prototype.powr=function(t){return Jmat.Quaternion.powr(this,t)},Jmat.Quaternion.sqrt=function(t){return t.powr(.5)},Jmat.Quaternion.eq=function(t,a){return t&&a?t.w==a.w&&t.x==a.x&&t.y==a.y&&t.z==a.z:t==a},Jmat.Quaternion.prototype.eq=function(t){return t&&this.w==t.w&&this.x==t.x&&this.y==t.y&&this.z==t.z},Jmat.Quaternion.eqr=function(t,a){return t&&a?t.w==a&&0==t.x&&0==t.y&&0==t.z:t==a},Jmat.Quaternion.prototype.eqr=function(t){return this.w==t&&0==this.x&&0==this.y&&0==this.z},Jmat.Quaternion.near=function(t,a,r){return t.w-r<=a.w&&t.w+r>=a.w&&t.x-r<=a.x&&t.x+r>=a.x&&t.y-r<=a.y&&t.x+r>=a.y&&t.z-r<=a.z&&t.x+r>=a.z},Jmat.Quaternion.relnear=function(t,a,r){return t.eq(a)?!0:t.sub(a).abs()<Math.max(t.abs(),a.abs())*r},Jmat.Quaternion.ONE=new Jmat.Quaternion(1,0,0,0),Jmat.Quaternion.I=new Jmat.Quaternion(0,1,0,0),Jmat.Quaternion.J=new Jmat.Quaternion(0,0,1,0),Jmat.Quaternion.K=new Jmat.Quaternion(0,0,0,1),Jmat.Quaternion.sin=function(t){var a=t.absv(),r=Math.sin(t.w)*Jmat.Real.cosh(a),m=Math.cos(t.w)*Jmat.Real.sinh(a);return new Jmat.Quaternion(r,m*t.x/a,m*t.y/a,m*t.z/a)},Jmat.Quaternion.cos=function(t){var a=t.absv();if(0==a)return Jmat.Quaternion(Math.cos(t.w),0,0,0);var r=Math.cos(t.w)*Jmat.Real.cosh(a),m=Math.sin(t.w)*Jmat.Real.sinh(a);return new Jmat.Quaternion(r,-m*t.x/a,-m*t.y/a,-m*t.z/a)},Jmat.Quaternion.tan=function(t){var a=Jmat.Quaternion;return a.sin(t).div(a.cos(t))},Jmat.Quaternion.asin=function(t){var a=0==t.absvsq()?Jmat.Quaternion.I:t.qvector().divr(t.absv());return a.mul(Jmat.Quaternion.asinh(t.mul(a))).neg()},Jmat.Quaternion.acos=function(t){var a=0==t.absvsq()?Jmat.Quaternion.I:t.qvector().divr(t.absv());return a.mul(Jmat.Quaternion.acosh(t)).neg()},Jmat.Quaternion.atan=function(t){var a=0==t.absvsq()?Jmat.Quaternion.I:t.qvector().divr(t.absv());return a.conj().mul(Jmat.Quaternion.atanh(t.mul(a)))},Jmat.Quaternion.sinh=function(t){var a=Jmat.Quaternion.exp(t),r=Jmat.Quaternion.inv(a);return a.sub(r).divr(2)},Jmat.Quaternion.cosh=function(t){var a=Jmat.Quaternion.exp(t),r=Jmat.Quaternion.inv(a);return a.add(r).divr(2)},Jmat.Quaternion.tanh=function(t){var a=Jmat.Quaternion.exp(t),r=Jmat.Quaternion.inv(a);return a.sub(r).div(a.add(r))},Jmat.Quaternion.asinh=function(t){return Jmat.Quaternion.log(t.add(Jmat.Quaternion.sqrt(t.mul(t).addr(1))))},Jmat.Quaternion.acosh=function(t){return Jmat.Quaternion.log(t.add(Jmat.Quaternion.sqrt(t.subr(1)).mul(Jmat.Quaternion.sqrt(t.addr(1)))))},Jmat.Quaternion.atanh=function(t){return Jmat.Quaternion.log(t.addr(1).div(t.rsub(1))).mulr(.5)},Jmat.Quaternion.isReal=function(t){return 0==t.x&&0==t.y&&0==t.z},Jmat.Quaternion.isNaN=function(t){return isNaN(t.w)||isNaN(t.x)||isNaN(t.y)||isNaN(t.z)},Jmat.Quaternion.isInf=function(t){return Math.abs(t.w)==1/0||Math.abs(t.x)==1/0||Math.abs(t.y)==1/0||Math.abs(t.z)==1/0},Jmat.Quaternion.isInfOrNaN=function(t){return!t||Jmat.Quaternion.isNaN(t)||Jmat.Quaternion.isInf(t)},Jmat.Quaternion.lambertwb=function(t,a){return Jmat.Complex.lambertwb_generic_(Jmat.Quaternion,t,a)},Jmat.Quaternion.lambertw=function(t){return Jmat.Quaternion.lambertwb(0,t)},Jmat.Quaternion.lambertwm=function(t){return Jmat.Quaternion.lambertwb(-1,t)};var Real=Jmat.Real,Complex=Jmat.Complex,Matrix=Jmat.Matrix,BigInt=Jmat.BigIntC||Jmat.BigInt,Quaternion=Jmat.Quaternion;["gamma","factorial","lambertw","erf","erfc"].map(function(t){Math[t]||(Math[t]=Jmat.Real[t])}),["sinh","cosh","tanh","asinh","acosh","atanh","clz32","log2","log10","log1p","expm1"].map(function(t){Math[t]||(Math[t]=Jmat.Real[t])});
//# sourceMappingURL=jmat.map
