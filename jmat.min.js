function Jmat(){}Jmat.Real=function(){},Jmat.Real.cast=function(t){return t&&void 0!=t.re?t.re:void 0==t?0:t},Jmat.Real.caststrict=function(t){return t&&void 0!=t.re?0==t.im?t.re:NaN:void 0==t?0:t},Jmat.Real.SQRT2=Math.sqrt(2),Jmat.Real.SQRTPI=Math.sqrt(Math.PI),Jmat.Real.EM=.5772156649015329,Jmat.Real.APERY=1.2020569,Jmat.Real.BIGGESTJSINT=9007199254740992,Jmat.Real.BIGGESTJSPRIME=9007199254740881,Jmat.Real.isInt=function(t){return t==Math.floor(t)},Jmat.Real.isPositiveInt=function(t){return t==Math.floor(t)&&t>0},Jmat.Real.isNegativeInt=function(t){return t==Math.floor(t)&&0>t},Jmat.Real.isPositiveIntOrZero=function(t){return t==Math.floor(t)&&t>=0},Jmat.Real.isNegativeIntOrZero=function(t){return t==Math.floor(t)&&0>=t},Jmat.Real.isOdd=function(t){return 1==Math.abs(t%2)},Jmat.Real.isEven=function(t){return t%2==0},Jmat.Real.isPOT=function(t){return 0!=t&&0==(t&t-1)},Jmat.Real.isInfOrNaN=function(t){return t==1/0||t==-(1/0)||isNaN(t)},Jmat.Real.dist=function(t,a){return Math.abs(t-a)},Jmat.Real.mod=function(t,a){return t-Math.floor(t/a)*a},Jmat.Real.rem=function(t,a){return t%a},Jmat.Real.wrap=function(t,a,r){if(a==r)return a;var e=Math.min(a,r),m=Math.max(a,r);return e+Jmat.Real.mod(t-e,m-e)},Jmat.Real.clamp=function(t,a,r){var e=Math.min(a,r),m=Math.max(a,r);return Math.max(e,Math.min(m,t))},Jmat.Real.idiv=function(t,a){return Math.floor(t/a)},Jmat.Real.gamma=function(t){if(t==1/0)return 1/0;if(Jmat.Real.useFactorialLoop_(t-1))return Jmat.Real.factorial(t-1);if(.5==t)return Jmat.Real.SQRTPI;var a=function(t){if(0>=t&&t==Math.round(t))return 1/0;if(.5>t)return Math.PI/(Math.sin(Math.PI*t)*a(1-t));var r=7,e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];t-=1;for(var m=e[0],n=1;r+2>n;n++)m+=e[n]/(t+n);var i=t+r+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,t+.5)*Math.exp(-i)*m};return a(t)},Jmat.Real.factorialmem_=[1],Jmat.Real.useFactorialLoop_=function(t){return Jmat.Real.isPositiveIntOrZero(t)&&200>t},Jmat.Real.factorial=function(t){if(!Jmat.Real.useFactorialLoop_(t))return Jmat.Real.gamma(t+1);if(Jmat.Real.factorialmem_[t])return Jmat.Real.factorialmem_[t];for(var a=Jmat.Real.factorialmem_[Jmat.Real.factorialmem_.length-1],r=Jmat.Real.factorialmem_.length;t>=r;r++)a*=r,Jmat.Real.factorialmem_[r]=a;return a},Jmat.Real.isPowerOf=function(t,a){var r=Jmat.Real;if(t==a)return 1;if(0>=a)return 0;if(0>=t)return 0;if(1==t)return 0;if(a>t)return 0;if(r.isPOT(t)&&r.isPOT(a)){var e=r.ilog2(t),m=r.ilog2(a);return e%m==0?e/m:0}if(r.isPOT(t)!=r.isPOT(a))return 0;if(r.isEven(t)!=r.isEven(a))return 0;for(var n=a,i=[],o=a,l=1;t>n;){if(i.push(o),n*=o,l*=2,n==t)return l;o*=o}if(n==1/0)return 0;for(;i.length>0;){var u=i.pop();if(n>t?(n/=u,l-=1<<i.length):(n*=u,l+=1<<i.length),n==t)return l}return 0},Jmat.Real.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],Jmat.Real.isPrimeInit_=function(t){if(t==1/0||t!=t)return NaN;if(t!=Math.round(t))return 0;if(2>t)return 0;if(t>Jmat.Real.BIGGESTJSINT)return NaN;for(var a=0;a<Jmat.Real.firstPrimes_.length;a++){if(t==Jmat.Real.firstPrimes_[a])return 1;if(t%Jmat.Real.firstPrimes_[a]==0)return 0}return-1},Jmat.Real.isPrimeSlow_=function(t){var a=Jmat.Real.isPrimeInit_(t);if(-1!=a)return a;var r=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1],e=Math.ceil(Math.sqrt(t))+6;for(r=6*Math.floor(r/6);e>r;){if(t%(r-1)==0||t%(r+1)==0)return 0;r+=6}return 1},Jmat.Real.isPrimeMillerRabin_=function(t){var a=Jmat.Real.isPrimeInit_(t);if(-1!=a)return a;var r;r=1373653>t?[2,3]:9080191>t?[31,73]:4759123141>t?[2,7,61]:1122004669633>t?[2,13,23,1662803]:2152302898747>t?[2,3,5,7,11]:3474749660383>t?[2,3,5,7,11,13]:341550071728321>t?[2,3,5,7,11,13,17]:0xd655278977733>t?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022];for(var e=Math.floor(t/2),m=1;!(1&e);)e=Math.floor(e/2),++m;for(var n=function(t,a,r){return t+a<Jmat.Real.BIGGESTJSINT?(t+a)%r:t+a>r?(t-r+a)%r:(t%r+a%r)%r},i=function(t,a,r){if(t*a<Jmat.Real.BIGGESTJSINT)return t*a%r;for(var e=0,m=t%r;a>0;)1&a&&(e=n(e,m,r)),m=n(m,m,r),a=Math.floor(a/2);return e%r},o=function(t,a,r){for(var e=1;a>0;)1&a&&(e=i(e,t,r)),t=i(t,t,r),a=Math.floor(a/2);return e},l=function(t,a,r,e){for(var m=o(e,r,t);a;){var n=i(m,m,t);if(1==n&&1!=m&&m!=t-1)return!1;m=n,a--}return 1==n},u=0;u<r.length;u++)if(!l(t,m,e,r[u]))return 0;return 1},Jmat.Real.isPrime=function(t){return 15e5>t?Jmat.Real.isPrimeSlow_(t):Jmat.Real.isPrimeMillerRabin_(t)},Jmat.Real.eratosthenes=function(t){if(2>t)return[];for(var a=[2],r=[],e=Math.floor(Math.sqrt(t)),m=Math.ceil(t/2),n=0;m>n;n++)r[n]=!0;for(var i=3;e>=i;i+=2){var n=Math.floor(i/2);if(r[n])for(var o=n+i;m>o;o+=i)r[o]=!1}for(var n=1;t>=n;n++)r[n]&&a.push(2*n+1);return a},Jmat.Real.smallestPrimeFactor=function(t){if(t==1/0||t!=t)return NaN;if(t!=Math.round(t))return NaN;if(1>t)return NaN;if(t>Jmat.Real.BIGGESTJSINT)return NaN;if(1==t)return 1;for(var a=0;a<Jmat.Real.firstPrimes_.length;a++){if(t==Jmat.Real.firstPrimes_[a])return t;if(t%Jmat.Real.firstPrimes_[a]==0)return Jmat.Real.firstPrimes_[a]}var r=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1],e=Math.ceil(Math.sqrt(t));for(r=6*Math.floor(r/6);e>r;){if(t%(r-1)==0)return r-1;if(t%(r+1)==0)return r+1;r+=6}return t},Jmat.Real.factorize=function(t){if(t>Jmat.Real.BIGGESTJSINT)return void 0;var t=Math.round(t),a=[];if(0>t&&(t=-t,a.push(-1)),2>=t)return(0==a.length||1!=t)&&a.push(t),a;for(;!(1>t);){var r=Jmat.Real.smallestPrimeFactor(t);if(a.push(r),t==r)break;t=Math.round(t/r)}return a},Jmat.Real.primeCount=function(t){var a=[0,2,3,5,7,11,13,17],r=function(t){if(t<a.length)return a[t];for(var r=a[a.length-1]+2,e=a.length-1;;){if(Jmat.Real.isPrime(r)&&(a.push(r),e++,e==t))return r;r+=2}},e={},m=function(t,a){if(0==a)return Math.floor(t);if(1==a)return Math.floor((t+1)/2);if(e[t]&&void 0!=e[t][a])return e[t][a];var n=m(t,a-1)-m(Math.floor(t/r(a)),a-1);return e[t]||(e[t]={}),e[t][a]=n,n},n={},i=function(t){if(t>1e9)return NaN;if(2>t)return 0;if(3>t)return 1;if(5>t)return 2;var a=Math.floor(t);if(n[a])return n[a];for(var e=Math.floor(i(Math.pow(t,.25))),o=Math.floor(i(Math.sqrt(t))),l=Math.floor(i(Math.pow(t,1/3))),u=m(a,e)+Math.floor((o+e-2)*(o-e+1)/2),J=e+1;o>=J;J++){var s=a/r(J);if(u-=i(s),l>=J)for(var p=i(Math.sqrt(s)),x=J;p>=x;x++)u-=i(s/r(x))-x+1}return n[a]=u,u};return i(t)},Jmat.Real.nearestPrime=function(t){var a=Math.round(t);if(7>a)return 2>=a?2:4>=a?3:5;if(a==1/0||a!=a)return NaN;if(a>=9007199254740881)return NaN;if(Jmat.Real.isPrime(a))return a;for(var r=a%6,e=6-r,m=0,n=0;;){if(Jmat.Real.isPrime(a-m-r+1)?n=a-m-r+1:Jmat.Real.isPrime(a-m-r-1)&&(n=a-m-r-1),(!n||a-n>m+e-1)&&Jmat.Real.isPrime(a+m+e-1)?n=a+m+e-1:(!n||a-n>m+e+1)&&Jmat.Real.isPrime(a+m+e+1)&&(n=a+m+e+1),n)return n;m+=6}},Jmat.Real.nextPrime=function(t){var a=Math.floor(t);if(2>a)return 2;if(3>a)return 3;if(a==1/0||a!=a)return NaN;if(a>=9007199254740881)return NaN;var r=a%6,e=2;for(0==r||5==r?(a+=0==r?1:2,e=4):a+=5-r;;){if(Jmat.Real.isPrime(a))return a;a+=e,e^=6}},Jmat.Real.previousPrime=function(t){var a=Math.ceil(t);if(2>=a)return NaN;if(3>=a)return 2;if(5>=a)return 3;if(7>=a)return 5;if(a==1/0||a!=a)return NaN;if(a>Jmat.Real.BIGGESTJSINT)return NaN;var r=a%6,e=2;for(0==r||1==r?(a-=r+1,e=4):a-=r-1;;){if(Jmat.Real.isPrime(a))return a;a-=e,e^=6}},Jmat.Real.eulerTotient=function(t){if(0>=t)return NaN;for(var a=Math.floor(t),r=Jmat.Real.factorize(a),e=-1,m=a,n=0;n<r.length;n++)if(e!=r[n]){if(1==r[n])break;e=r[n],m*=1-1/r[n]}return m},Jmat.Real.pascal_triangle_cache_=[[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1],[1,7,21,35,35,21,7,1]],Jmat.Real.pascal_triangle=function(t,a){if(0>t||0>a||a>t)return NaN;if(t>180)return NaN;for(var r=Jmat.Real.pascal_triangle_cache_;r.length<=t;){var e=r.length,m=e+1;r[e]=[];for(var n=0;m>n;n++)r[e][n]=0==n||n==m-1?1:r[e-1][n-1]+r[e-1][n]}return r[t][a]},Jmat.Real.gcd=function(t,a){if(!Jmat.Real.isInt(t)||!Jmat.Real.isInt(a))return NaN;if(Math.abs(t)>Jmat.Real.BIGGESTJSINT||Math.abs(a)>Jmat.Real.BIGGESTJSINT)return NaN;for(;;){if(0==a)return Math.abs(t);var r=Jmat.Real.mod(t,a);t=a,a=r}},Jmat.Real.lcm=function(t,a){return Math.abs(t*a)/Jmat.Real.gcd(t,a)},Jmat.Real.decompose=function(t,a){a||(a=1e5);var r=0>t;r&&(t=-t);var e=Math.floor(t),m=t-e;if(0==m)return[t,1];for(var n,i=0,o=1,l=1,u=1;a>=o&&a>=u;){var J=(i+l)/(o+u);if(m==J){n=a>=o+u?[i+l,o+u]:u>o?[l,u]:[i,o];break}m>J?(i+=l,o+=u):(l=i+l,u=o+u)}return n||(n=o>a?[l,u]:[i,o]),n[0]+=e*n[1],r&&(n[0]=-n[0]),n},Jmat.Real.decomposeSemiFast=function(t,a){var r=1e3;if(r>a)return Jmat.Real.decompose(t,a);var e=Jmat.Real.decompose(t,r),m=e[0]/e[1];if(m==t)return e;var n=Jmat.Real.decomposeFast(t,r),i=n[0]/n[1];return Math.abs(t-m)<Math.abs(t-i)?e:n},Jmat.Real.decomposeFast=function(t,a){a||(a=1e5);var r=a-1;if(r>=t&&t>=-r&&(-1/r>t||t>1/r)){var e=0>t;e&&(t=-t);var m=Math.floor(t),n=t-m,i=a;n=Math.floor(n*i);var o=Jmat.Real.gcd(n,i);return i/=o,n/=o,n+=m*i,e&&(n=-n),[n,i]}return[t,1]},Jmat.Real.near=function(t,a,r){return t>=a-r&&a+r>=t},Jmat.Real.relnear=function(t,a,r){if(t==a)return!0;if(0==t||0==a)return!1;if(0>t!=0>a)return!1;t=Math.abs(t),a=Math.abs(a);var e=t>a?t/a:a/t;return 1+r>e},Jmat.Real.frac=function(t){return t-Math.floor(t)},Jmat.Real.fracn=function(t){return t>0?t-Math.floor(t):-(-t-Math.floor(-t))},Jmat.Real.lambertw=function(t){if(isNaN(t))return NaN;if(t==1/0||t==-(1/0))return 1/0;if(t>=-1/Math.E&&703>=t){for(var a=10>t?0:Math.log(t)-Math.log(Math.log(t)),r=Math.max(30,t>0?10+Math.floor(t):30),e=0;r>e;e++){var m=Math.exp(a);a-=(a*m-t)/(m+a*m)}return a}if(t>0)for(var n=1,i=0,o=Math.log(t)-Math.log(Math.log(t));;){if(0==n||.5*n==n||o+n==o)return o;var l=o*Math.exp(o);if(Jmat.Real.near(l,t,1e-15))return o;l>t?(o-=n,-1==i&&(n*=.5),i=1):(o+=n,1==i&&(n*=.5),i=-1)}return NaN},Jmat.Real.logy=function(t,a){return Math.log(t)/Math.log(a)},Jmat.Real.clz32=Math.clz32||function(t){for(var a=0;t>0;)t=Math.floor(t/2),a++;return 32-a},Jmat.Real.log2=Math.log2||function(t){return Math.log(t)/Math.LN2},Jmat.Real.ilog2=function(t){return 0>=t?NaN:2147483648>t?31-Jmat.Real.clz32(t):Math.floor(Jmat.Real.log2(Math.floor(t)+.5))},Jmat.Real.getNumBits=function(t){return Jmat.Real.ilog2(Math.abs(t))+1},Jmat.Real.log10=Math.log10||function(t){return Math.log(t)/Math.LN10},Jmat.Real.root=function(t,a){return Math.pow(t,1/a)},Jmat.Real.dawson=function(t){var a=t*t,r=a*a,e=r*a,m=e*a,n=m*a,i=n*a,o=.1049934947,l=.0424060604,u=.0072644182,J=.0005064034,s=.0001789971,p=.7715471019,x=.2909738639,f=.0694555761,c=.0140005442,C=.0008327945,d=1+o*a+l*r+u*e+J*m+s*n,v=1+p*a+x*r+f*e+c*m+C*n+2*s*i;return d/v*t},Jmat.Real.erfi=function(t){var a=!1;0>t&&(t=-t,a=!0);var r=0,e=1/Jmat.Real.SQRTPI;if(.5>=t){var m=t*t*t,n=m*t*t,i=n*t*t,o=2*t+2/3*m+.2*n+1/21*i;r=e*o}else if(t>=5){var l=1/t,u=l*l*l,J=u*l*l,s=J*l*l,p=Math.exp(t*t),o=l+.5*u+.75*J+15/8*s;r=e*p*o}else r=2/Jmat.Real.SQRTPI*Math.exp(t*t)*Jmat.Real.dawson(t);return a&&(r=-r),r},Jmat.Real.erf=function(t){var a=0>t;if(a&&(t=-t),0==t)return 0;var r=1/(1+.3275911*t),e=r*(.254829592+r*(-.284496736+r*(1.421413741+r*(-1.453152027+1.061405429*r)))),m=1-e*Math.exp(-(t*t));return a&&(m=-m),m},Jmat.Real.erfc=function(t){var a=0>t;a&&(t=-t);var r;if(.5>=t){var e=t*t,m=t*e,n=m*e,i=n*e;r=1-2/Jmat.Real.SQRTPI*(t-m/3+n/10+i/42)}else if(t>=5){var e=t*t,o=e*e,l=o*e,u=l*e;r=Math.exp(-(t*t))/(t*Jmat.Real.SQRTPI)*(1-.5/e+.75/o-15/8/l+6.5625/u)}else{var J=1/(1+.3275911*t),s=J*(.254829592+J*(-.284496736+J*(1.421413741+J*(-1.453152027+1.061405429*J))));r=s*Math.exp(-(t*t))}return a&&(r=2-r),r},Jmat.Real.dms=function(t){var a=0>t;a&&(t=-t);var r=Math.floor(t),e=Math.floor(60*t-60*r),m=Math.floor(3600*t-3600*r-60*e),n=r+e/100+m/1e4;return a&&(n=-n),n},Jmat.Real.dd=function(t){var a=0>t;a&&(t=-t);var r=Math.floor(t),e=Math.floor(100*t-100*r),m=Math.floor(1e4*t-1e4*r-100*e),n=r+e/60+m/3600;return a&&(n=-n),n},Jmat.Real.round=function(t){var a=Math.floor(t),r=t-a;return.5==r?a%2==0?a:a+1:.5>r?a:a+1},Jmat.Real.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)},Jmat.Real.lerp=function(t,a,r){return(1-r)*t+r*a},Jmat.Real.sinh=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2},Jmat.Real.cosh=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2},Jmat.Real.tanh=Math.tanh||function(t){return(Math.exp(2*t)-1)/(Math.exp(2*t)+1)},Jmat.Real.asinh=Math.asinh||function(t){return t==-(1/0)?t:Math.log(t+Math.sqrt(t*t+1))},Jmat.Real.acosh=Math.acosh||function(t){return Math.log(t+Math.sqrt(t*t-1))},Jmat.Real.atanh=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},Jmat.Real.hypot=function(t,a,r){t=Math.abs(t),a=Math.abs(a);var e=Math.min(t,a);return t=Math.max(t,a),t==1/0?1/0:(e/=t,t*Math.sqrt(1+e*e))},Jmat.Real.abs=Math.abs,Jmat.Real.floor=Math.floor,Jmat.Real.ceil=Math.ceil,Jmat.Real.min=Math.min,Jmat.Real.max=Math.max,Jmat.Real.exp=Math.exp,Jmat.Real.log=Math.log,Jmat.Real.sqrt=Math.sqrt,Jmat.Real.pow=Math.pow,Jmat.Real.sin=Math.sin,Jmat.Real.cos=Math.cos,Jmat.Real.tan=Math.tan,Jmat.Real.asin=Math.asin,Jmat.Real.acos=Math.acos,Jmat.Real.atan=Math.atan,Jmat.Real.atan2=Math.atan2,Jmat.Real.isLeapYear=function(t){return t%400==0||t%4==0&&t%100!=0},Jmat.Real.montharray_=[-1,31,28,31,30,31,30,31,31,30,31,30,31],Jmat.Real.monthLength=function(t,a){return a&&2==t?29:Jmat.Real.montharray_[t]},Jmat.Real.numDaysSince0=function(t,a,r){var e=Jmat.Real,m=0==t?0:e.idiv(t-1,4)-e.idiv(t-1,100)+e.idiv(t-1,400)+1,n=365*t+m,i=a>2?Jmat.Real.isLeapYear(t)?1:2:0,o=a>8&&a%2==1?1:0,l=30*(a-1)+e.idiv(a,2)-i+o;return n+l+r-1},Jmat.Real.daysSince0ToDate=function(t){var a=Math.floor(t/365.2425),r=Jmat.Real.isLeapYear(a);t-=Jmat.Real.numDaysSince0(a,1,1);for(var e=0,m=1;12>=m;m++){e++;var n=Jmat.Real.monthLength(m,r);if(!(t>=n))break;t-=n}return[a,e,t+1]},Jmat.Real.dayOfWeek=function(t,a,r){var e=Jmat.Real;return r+=3>a?t--:t-2,(e.idiv(23*a,9)+r+4+e.idiv(t,4)-e.idiv(t,100)+e.idiv(t,400))%7},Jmat.Real.argmax=function(t,a,r){for(var e=r(t),m=t,n=t+1;a>n;n++){var i=r(n);i>e&&(e=i,m=n)}return m},Jmat.Complex=function(t,a){return this instanceof Jmat.Complex?(this.re=t,void(this.im=a)):Jmat.Complex.make(t,a)},Jmat.Complex.make=function(t,a){return void 0==t?new Jmat.Complex(0,0):"number"==typeof t?new Jmat.Complex(t,void 0==a?0:a):"string"==typeof t?Jmat.Complex.parse(t):new Jmat.Complex(t.re,t.im)},Jmat.Complex.newr=function(t){return new Jmat.Complex(t,0)},Jmat.Complex.newi=function(t){return new Jmat.Complex(0,t)},Jmat.Complex.polar=function(t,a){return new Jmat.Complex(t*Math.cos(a),t*Math.sin(a))},Jmat.Complex.cast=function(t){return t&&void 0!=t.re?t:void 0==t?Jmat.Complex(0):Jmat.Complex(t)},Jmat.Complex.copy=function(t){return new Jmat.Complex(t.re,t.im)},Jmat.Complex.formatFloat_=function(t,a){var r=Math.pow(10,a||0);return String(Math.round(t*r)/r)},Jmat.Complex.toString=function(t,a){if(!t)return 0==t?"invalid0":""+t;var r=a?Jmat.Complex.formatFloat_(t.re,a):""+t.re,e=a?Jmat.Complex.formatFloat_(t.im,a):""+t.im;return 0==t.im||"0"==e?""+r:0==t.re?""+e+"i":t.im<0?""+r+e+"i":""+r+"+"+e+"i"},Jmat.Complex.prototype.toString=function(t){return Jmat.Complex.toString(this,t)},Jmat.Complex.parse=function(t){var a=t.indexOf("i");if(-1==a)return Jmat.Complex(parseFloat(t));if("i"==t)return Jmat.Complex(0,1);t=t.substr(0,a),t=t.replace(/ /g,""),("+"==t[a-1]||"-"==t[a-1])&&(t+="1");for(var r=1;r<t.length;r++)if(("+"==t[r]||"-"==t[r])&&"e"!=t[r-1]&&"E"!=t[r-1])return Jmat.Complex(parseFloat(t.substr(0,r)),parseFloat(t.substr(r)));return Jmat.Complex(0,parseFloat(t))},Jmat.Complex.ZERO=Jmat.Complex(0),Jmat.Complex.ONE=Jmat.Complex(1),Jmat.Complex.TWO=Jmat.Complex(2),Jmat.Complex.I=Jmat.Complex.newi(1),Jmat.Complex.PI=Jmat.Complex(Math.PI),Jmat.Complex.E=Jmat.Complex(Math.E),Jmat.Complex.SQRT2=Jmat.Complex(Math.sqrt(2)),Jmat.Complex.SQRTPI=Jmat.Complex(Math.sqrt(Math.PI)),Jmat.Complex.INVSQRT2PI=Jmat.Complex(1/Math.sqrt(2*Math.PI)),Jmat.Complex.EM=Jmat.Complex(Jmat.Real.EM),Jmat.Complex.APERY=Jmat.Complex(Jmat.Real.APERY),Jmat.Complex.real=function(t){return Jmat.Complex(t.re)},Jmat.Complex.prototype.real=function(){return Jmat.Complex(this.re)},Jmat.Complex.imag=function(t){return Jmat.Complex(t.im)},Jmat.Complex.prototype.imag=function(){return Jmat.Complex(this.im)},Jmat.Complex.add=function(t,a){return new Jmat.Complex(t.re+a.re,t.im+a.im)},Jmat.Complex.prototype.add=function(t){return new Jmat.Complex(this.re+t.re,this.im+t.im)},Jmat.Complex.sub=function(t,a){return new Jmat.Complex(t.re-a.re,t.im-a.im)},Jmat.Complex.prototype.sub=function(t){return new Jmat.Complex(this.re-t.re,this.im-t.im)},Jmat.Complex.mul=function(t,a){if(0==t.im&&0==a.im)return new Jmat.Complex(t.re*a.re,0);var r=t.re*a.re-t.im*a.im,e=t.im*a.re+t.re*a.im;return new Jmat.Complex(r,e)},Jmat.Complex.prototype.mul=function(t){return Jmat.Complex.mul(this,t)},Jmat.Complex.div=function(t,a){if(0==t.im&&0==a.im)return new Jmat.Complex(t.re/a.re,0);if(Jmat.Complex.isInf(t)&&!Jmat.Complex.isInfOrNaN(a))return t;var r=a.re*a.re+a.im*a.im;if((r==1/0||r==-(1/0))&&!Jmat.Complex.isInfOrNaN(t))return Jmat.Complex(0);if(0==r&&!Jmat.Complex.isInfOrNaN(t)&&(0!=t.re||0!=t.im))return new Jmat.Complex(0==t.re?0:t.re<0?-(1/0):1/0,0==t.im?0:t.im<0?-(1/0):1/0);var e=(t.re*a.re+t.im*a.im)/r,m=(t.im*a.re-t.re*a.im)/r;return new Jmat.Complex(e,m)},Jmat.Complex.prototype.div=function(t){return Jmat.Complex.div(this,t)},Jmat.Complex.addr=function(t,a){return new Jmat.Complex(t.re+a,t.im)},Jmat.Complex.prototype.addr=function(t){return new Jmat.Complex(this.re+t,this.im)},Jmat.Complex.subr=function(t,a){return new Jmat.Complex(t.re-a,t.im)},Jmat.Complex.prototype.subr=function(t){return new Jmat.Complex(this.re-t,this.im)},Jmat.Complex.rsub=function(t,a){return new Jmat.Complex(t-a.re,-a.im)},Jmat.Complex.prototype.rsub=function(t){return new Jmat.Complex(t-this.re,-this.im)},Jmat.Complex.mulr=function(t,a){return new Jmat.Complex(t.re*a,t.im*a)},Jmat.Complex.prototype.mulr=function(t){return new Jmat.Complex(this.re*t,this.im*t)},Jmat.Complex.muli=function(t,a){return new Jmat.Complex(-t.im*a,t.re*a)},Jmat.Complex.prototype.muli=function(t){return new Jmat.Complex(-this.im*t,this.re*t)},Jmat.Complex.divr=function(t,a){return new Jmat.Complex(t.re/a,t.im/a)},Jmat.Complex.prototype.divr=function(t){return new Jmat.Complex(this.re/t,this.im/t)},Jmat.Complex.rdiv=function(t,a){return new Jmat.Complex.div(Jmat.Complex(t),a)},Jmat.Complex.prototype.rdiv=function(t){return Jmat.Complex.div(Jmat.Complex(t),this)},Jmat.Complex.divi=function(t,a){return new Jmat.Complex(t.im/a,-t.re/a)},Jmat.Complex.prototype.divi=function(t){return new Jmat.Complex(this.im/t,-this.re/t)},Jmat.Complex.rotate=function(t,a){return 0==a?t:Jmat.Complex.polar(t.abs(),t.arg()+a)},Jmat.Complex.nextroot=function(t,a){var r=Jmat.Complex.rotate(t,2*Math.PI/a);return Jmat.Real.near(r.im,0,1e-14)&&(r.im=0),r},Jmat.Complex.mod=function(t,a){return 0!=t.im||0!=a.im?t.sub(Jmat.Complex.floor(t.div(a)).mul(a)):Jmat.Complex(Jmat.Real.mod(t.re,a.re))},Jmat.Complex.rem=function(t,a){return 0!=t.im||0!=a.im?t.sub(Jmat.Complex.trunc(t.div(a)).mul(a)):Jmat.Complex(t.re%a.re)},Jmat.Complex.wrap=function(t,a,r){return new Jmat.Complex(Jmat.Real.wrap(t.re,a.re,r.re),Jmat.Real.wrap(t.im,a.im,r.im))},Jmat.Complex.clamp=function(t,a,r){return new Jmat.Complex(Jmat.Real.clamp(t.re,a.re,r.re),Jmat.Real.clamp(t.im,a.im,r.im))},Jmat.Complex.bitneg=function(t){var a=Jmat.Complex(0);return a.re=~t.re,a.im=-t.im,a},Jmat.Complex.bitand=function(t,a){var r=Jmat.Complex(0);return r.re=t.re&a.re,r.im=t.im&a.im,r},Jmat.Complex.bitor=function(t,a){var r=Jmat.Complex(0);return r.re=t.re|a.re,r.im=t.im|a.im,r},Jmat.Complex.bitxor=function(t,a){var r=Jmat.Complex(0);return r.re=t.re^a.re,r.im=t.im^a.im,r},Jmat.Complex.lshift=function(t,a){var r=Jmat.Complex(0);return r.re=t.re<<a.re,r.im=t.im<<a.im,r},Jmat.Complex.rshift=function(t,a){var r=Jmat.Complex(0);return r.re=t.re>>a.re,r.im=t.im>>a.im,r},Jmat.Complex.neg=function(t){return Jmat.Complex(-t.re,-t.im)},Jmat.Complex.prototype.neg=function(){return Jmat.Complex(-this.re,-this.im)},Jmat.Complex.sign=function(t){return 0==t.im?0==t.re?Jmat.Complex(0):t.re<0?Jmat.Complex(-1):Jmat.Complex(1):t.divr(t.abs())},Jmat.Complex.csgn=function(t){return Jmat.Real.near(t.re,0,1e-15)?0==t.im?Jmat.Complex(0):t.im<0?Jmat.Complex(-1):Jmat.Complex(1):0==t.re?Jmat.Complex(0):t.re<0?Jmat.Complex(-1):Jmat.Complex(1)},Jmat.Complex.sign1=function(t){return 0==t.im?t.re<0?Jmat.Complex(-1):Jmat.Complex(1):t.divr(t.abs())},Jmat.Complex.csgn1=function(t){return Jmat.Real.near(t.re,0,1e-15)?t.im<0?Jmat.Complex(-1):Jmat.Complex(1):t.re<0?Jmat.Complex(-1):void Jmat.Complex(1)},Jmat.Complex.copysign=function(t,a){return Jmat.Complex.abs(t).mul(Jmat.Complex.sign(a))},Jmat.Complex.conj=function(t){return Jmat.Complex(t.re,-t.im)},Jmat.Complex.prototype.conj=function(){return Jmat.Complex(this.re,-this.im)},Jmat.Complex.eq=function(t,a){return t&&a?t.re==a.re&&t.im==a.im:t==a},Jmat.Complex.prototype.eq=function(t){return t&&this.re==t.re&&this.im==t.im},Jmat.Complex.eqr=function(t,a){return t.re==a&&0==t.im},Jmat.Complex.prototype.eqr=function(t){return this.re==t&&0==this.im},Jmat.Complex.powr=function(t,a){return Jmat.Complex.pow(t,Jmat.Complex(a))},Jmat.Complex.prototype.powr=function(t){return Jmat.Complex.pow(this,Jmat.Complex(t))},Jmat.Complex.inv=function(t){return Jmat.Complex.ONE.div(t)},Jmat.Complex.prototype.inv=function(){return Jmat.Complex.ONE.div(this)},Jmat.Complex.inc=function(t){return new Jmat.Complex(t.re+1,t.im)},Jmat.Complex.prototype.inc=function(){return new Jmat.Complex(this.re+1,this.im)},Jmat.Complex.dec=function(t){return new Jmat.Complex(t.re-1,t.im)},Jmat.Complex.prototype.dec=function(){return new Jmat.Complex(this.re-1,this.im)},Jmat.Complex.abs=function(t){return Jmat.Complex(t.abs())},Jmat.Complex.prototype.abs=function(){return 0==this.im?Math.abs(this.re):0==this.re?Math.abs(this.im):this.re==1/0||this.re==-(1/0)||this.im==1/0||this.im==-(1/0)?1/0:Jmat.Real.hypot(this.re,this.im)},Jmat.Complex.abssq=function(t){return Jmat.Complex(t.re*t.re+t.im*t.im)},Jmat.Complex.prototype.abssq=function(){return this.re*this.re+this.im*this.im},Jmat.Complex.arg=function(t){return Jmat.Complex(t.arg())},Jmat.Complex.prototype.arg=function(){return 0==this.im?this.re<0?Math.PI:0:Math.atan2(this.im,this.re)},Jmat.Complex.arg1=function(t){var a=t.arg();return 0>a&&(a+=2*Math.PI),a/=2*Math.PI,0>a&&(a=0),a>1&&(a=1),a},Jmat.Complex.abs1r=function(t){return Math.abs(t.re)+Math.abs(t.im)},Jmat.Complex.hypot=function(t,a){var r=Jmat.Complex;if(r.abs1r(a)>r.abs1r(t)){var e=t;t=a,a=e}if(r.isInf(t))return 1/0;var m=a.div(t);return t.mul(r.sqrt(r.abssq(m).addr(1)))},Jmat.Complex.isReal=function(t){return 0==t.im},Jmat.Complex.isImaginary=function(t){return 0==t.re},Jmat.Complex.isInt=function(t){return 0==t.im&&Jmat.Real.isInt(t.re)},Jmat.Complex.isGaussian=function(t){return Jmat.Real.isInt(t.re)&&Jmat.Real.isInt(t.im)},Jmat.Complex.isNaN=function(t){return!t||isNaN(t.re)||isNaN(t.im)},Jmat.Complex.isInf=function(t){return Math.abs(t.re)==1/0||Math.abs(t.im)==1/0},Jmat.Complex.isInfOrNaN=function(t){return!t||Jmat.Real.isInfOrNaN(t.re)||Jmat.Real.isInfOrNaN(t.im)},Jmat.Complex.isPositive=function(t){return t.re>0&&0==t.im},Jmat.Complex.isNegative=function(t){return t.re<0&&0==t.im},Jmat.Complex.isPositiveOrZero=function(t){return t.re>=0&&0==t.im},Jmat.Complex.isNegativeOrZero=function(t){return t.re<=0&&0==t.im},Jmat.Complex.isPositiveInt=function(t){return Jmat.Complex.isInt(t)&&t.re>0},Jmat.Complex.isNegativeInt=function(t){return Jmat.Complex.isInt(t)&&t.re<0},Jmat.Complex.isPositiveIntOrZero=function(t){return Jmat.Complex.isInt(t)&&t.re>=0},Jmat.Complex.isNegativeIntOrZero=function(t){return Jmat.Complex.isInt(t)&&t.re<=0},Jmat.Complex.isOdd=function(t){return Jmat.Complex.isInt(t)&&1==Math.abs(t.re%2)},Jmat.Complex.isEven=function(t){return Jmat.Complex.isInt(t)&&t.re%2==0},Jmat.Complex.pow=function(t,a){if(Jmat.Complex.isReal(t)&&Jmat.Complex.isReal(a)&&(t.re>=0||a.re==1/0||a.re==-(1/0)||Jmat.Real.isInt(a.re)))return Jmat.Complex(Math.pow(t.re,a.re));var r=t.abs(),e=t.arg(),m=Math.pow(r,a.re)*Math.exp(-a.im*e);isNaN(m)&&(m=Math.pow(1,a.re/r)*Math.exp(-a.im*e/r),m=0>m?-(1/0):m>0?1/0:NaN);var n=a.im*Math.log(r)+a.re*e;return Jmat.Complex(m*Math.cos(n),m*Math.sin(n))},Jmat.Complex.prototype.pow=function(t){return Jmat.Complex.pow(this,t)},Jmat.Complex.sin=function(t){if(0==t.im)return Jmat.Complex(Math.sin(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.exp(a),e=Jmat.Complex.inv(r);return r.sub(e).div(Jmat.Complex(0,2))},Jmat.Complex.sinc=function(t){return t.eqr(0)?Jmat.Complex(1):Jmat.Complex.sin(t).div(t)},Jmat.Complex.cos=function(t){if(0==t.im)return Jmat.Complex(Math.cos(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.exp(a),e=Jmat.Complex.inv(r);return r.add(e).mulr(.5)},Jmat.Complex.tan=function(t){if(0==t.im)return Jmat.Complex(Math.tan(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.exp(a),e=Jmat.Complex.inv(r);return r.sub(e).div(Jmat.Complex(0,2)).div(r.add(e).mulr(.5))},Jmat.Complex.asin=function(t){if(0==t.im&&t.re>=-1&&t.re<=1)return Jmat.Complex(Math.asin(t.re));var a=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(t.mul(t))),r=Jmat.Complex.log(Jmat.Complex(-t.im,t.re).add(a));return Jmat.Complex(r.im,-r.re)},Jmat.Complex.acos=function(t){if(0==t.im&&t.re>=-1&&t.re<=1)return Jmat.Complex(Math.acos(t.re));var a=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(t.mul(t))).mul(Jmat.Complex.I),r=Jmat.Complex.log(t.add(a));return Jmat.Complex(r.im,-r.re)},Jmat.Complex.atan=function(t){if(0==t.im)return Jmat.Complex(Math.atan(t.re));var a=Jmat.Complex(-t.im,t.re),r=Jmat.Complex.ONE.sub(a).div(a.inc()),e=Jmat.Complex.log(r);return Jmat.Complex(-.5*e.im,.5*e.re)},Jmat.Complex.atan2=function(t,a){var r=Jmat.Complex;if(r.isReal(t)&&r.isReal(a)){var e=r(0);return e.re=Math.atan2(t.re,a.re),e}return a.eqr(0)?r(Math.PI/2):r.atan(t.div(a))},Jmat.Complex.sinh=function(t){var a=Jmat.Complex.exp(t),r=Jmat.Complex.inv(a);return a.sub(r).divr(2)},Jmat.Complex.cosh=function(t){var a=Jmat.Complex.exp(t),r=Jmat.Complex.inv(a);return a.add(r).divr(2)},Jmat.Complex.tanh=function(t){var a=Jmat.Complex.exp(t),r=Jmat.Complex.inv(a);return a.sub(r).div(a.add(r))},Jmat.Complex.asinh=function(t){return Jmat.Complex.log(t.add(Jmat.Complex.sqrt(t.mul(t).addr(1))))},Jmat.Complex.acosh=function(t){return Jmat.Complex.log(t.add(Jmat.Complex.sqrt(t.subr(1)).mul(Jmat.Complex.sqrt(t.addr(1)))))},Jmat.Complex.atanh=function(t){return Jmat.Complex.log(t.addr(1).div(t.rsub(1))).mulr(.5)},Jmat.Complex.logsin=function(t){if(t.im>-10&&t.im<10)return Jmat.Complex.log(Jmat.Complex.sin(t));var a=Jmat.Complex(.69314718056,1.570796326795),r=Jmat.Complex(Jmat.Real.wrap(t.re,-Math.PI/2,3*Math.PI/2),t.im);return t.im>0?Jmat.Complex.newi(Jmat.Complex.PI).sub(Jmat.Complex.I.mul(r)).sub(a):Jmat.Complex.I.mul(r).sub(a)},Jmat.Complex.logcos=function(t){return Jmat.Complex.logsin(t.rsub(Math.PI/2))},Jmat.Complex.floor=function(t){var a=Jmat.Complex(0);return a.re=Math.floor(t.re),a.im=Math.floor(t.im),a},Jmat.Complex.ceil=function(t){var a=Jmat.Complex(0);return a.re=Math.ceil(t.re),a.im=Math.ceil(t.im),a},Jmat.Complex.round=function(t){var a=Jmat.Complex(0);return a.re=Jmat.Real.round(t.re),a.im=Jmat.Real.round(t.im),a},Jmat.Complex.trunc=function(t){var a=Jmat.Complex(0);return a.re=t.re<0?Math.ceil(t.re):Math.floor(t.re),a.im=t.im<0?Math.ceil(t.im):Math.floor(t.im),a},Jmat.Complex.frac=function(t){return Jmat.Complex(Jmat.Real.frac(t.re),Jmat.Real.frac(t.im))},Jmat.Complex.fracn=function(t){return Jmat.Complex(Jmat.Real.fracn(t.re),Jmat.Real.fracn(t.im))},Jmat.Complex.lerp=function(t,a,r){return r.rsub(1).mul(t).add(r.mul(a))},Jmat.Complex.exp=function(t){if(0==t.im)return Jmat.Complex(Math.exp(t.re));var a=Math.exp(t.re);return new Jmat.Complex(a*Math.cos(t.im),a*Math.sin(t.im))},Jmat.Complex.expm1=function(t){return t.abssq()<1e-5?t.add(t.mul(t).divr(2)).add(t.mul(t).mul(t).divr(6)):Jmat.Complex.exp(t).subr(1)},Jmat.Complex.log=function(t){return t.eqr(-(1/0))?Jmat.Complex(1/0):Jmat.Complex.isReal(t)&&t.re>=0?Jmat.Complex(Math.log(t.re)):Jmat.Complex(Math.log(t.abs()),t.arg())},Jmat.Complex.log1p=function(t){return t.abssq()<1e-8?t.mulr(-.5).addr(1).mul(t):Jmat.Complex.log(t.addr(1))},Jmat.Complex.logy=function(t,a){return Jmat.Complex.log(t).div(Jmat.Complex.log(a))},Jmat.Complex.logr=function(t,a){return Jmat.Complex.log(t).divr(Math.log(a))},Jmat.Complex.log2=function(t){return Jmat.Complex.log(t).divr(Math.LN2)},Jmat.Complex.log10=function(t){return Jmat.Complex.log(t).divr(Math.LN10)},Jmat.Complex.sqrt=function(t){if(Jmat.Complex.isReal(t)){var a=Jmat.Complex(0);return t.re>=0||t.re!=t.re?a.re=Math.sqrt(t.re):a.im=Math.sqrt(-t.re),a}return t.pow(Jmat.Complex(.5))},Jmat.Complex.root=function(t,a){return t.pow(Jmat.Complex(Jmat.Complex.inv(a)))},Jmat.Complex.rootr=function(t,a){return t.pow(Jmat.Complex(1/a))},Jmat.Complex.toInt=function(t){return Math.round(t.re)},Jmat.Complex.infNormalize=function(t){return Jmat.Complex.isNaN(t)?Jmat.Complex(NaN):t.re==1/0?t.im==1/0?Jmat.Complex(1,1):t.im==-(1/0)?Jmat.Complex(1,-1):Jmat.Complex(1,0):t.re==-(1/0)?t.im==1/0?Jmat.Complex(-1,1):t.im==-(1/0)?Jmat.Complex(-1,-1):Jmat.Complex(-1,0):t.im==1/0?t.re==1/0?Jmat.Complex(1,1):t.re==-(1/0)?Jmat.Complex(-1,1):Jmat.Complex(0,1):t.im==-(1/0)?t.re==1/0?Jmat.Complex(1,-1):t.re==-(1/0)?Jmat.Complex(-1,-1):Jmat.Complex(0,-1):t.divr(t.abs())},Jmat.Complex.calcCache_=function(t,a,r,e){if(e){for(var m=0;e>m;m++)if(t.eq(r[2*m+1]))return r[2*m+2];var n=r[0]||0;n++,n>=e&&(n=0);var i=a(t);return r[2*n+1]=t,r[2*n+2]=i,r[0]=n,i}if(t.eq(r[0]))return r[1];var i=a(t);return r[0]=t,r[1]=i,i},Jmat.Complex.gamma=function(t){if(t.re==1/0)return Jmat.Complex(1/0);if(Jmat.Complex.isNegativeIntOrZero(t))return Jmat.Complex(1/0,1/0);if(0==t.im)return Jmat.Complex(Jmat.Real.gamma(t.re));var a=function(t){if(t.re<.5){var r=Jmat.Complex.PI.div(Jmat.Complex.sin(Jmat.Complex.PI.mul(t))).div(a(Jmat.Complex.ONE.sub(t)));return Jmat.Complex.isNaN(r)&&(r=Jmat.Complex(0)),r}var e=7,m=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];t=t.subr(1);for(var n=Jmat.Complex(m[0]),i=1;e+2>i;i++)n=n.add(Jmat.Complex(m[i]).div(t.addr(i)));var o=t.addr(e+.5),l=Math.sqrt(2*Math.PI),u=o.pow(t.addr(.5)),J=Jmat.Complex.exp(o.neg()),r=u.mul(J).mul(n).mulr(l);return r};return a(t)},Jmat.Complex.factorial=function(t){return Jmat.Complex.gamma(Jmat.Complex.inc(t))},Jmat.Complex.isPrime=function(t){return Jmat.Complex.isReal(t)?Jmat.Real.isPrime(t.re):0},Jmat.Complex.decompose=function(t,a){if(Math.abs(t.re)>=Math.abs(t.im)){var r=Jmat.Real.decompose(t.re,a),e=Math.round(t.im*r[1]);return[Jmat.Complex(r[0],e),Jmat.Complex(r[1])]}var r=Jmat.Real.decompose(t.im,a),m=Math.round(t.re*r[1]);return[Jmat.Complex(m,r[0]),Jmat.Complex(r[1])]},Jmat.Complex.permutation=function(t,a){return Jmat.Complex.gammaDiv_(t.inc(),t.sub(a).inc())},Jmat.Complex.binomial=function(t,a){if(Jmat.Complex.isPositiveIntOrZero(t)&&Jmat.Complex.isPositiveIntOrZero(a)&&a.re<=t.re&&t.re<30)return Jmat.Complex(Jmat.Real.pascal_triangle(t.re,a.re));var r=Jmat.Complex.gammaDiv12_(t.inc(),a.inc(),t.sub(a).inc());return r.re>100&&Jmat.Complex.isPositiveInt(t)&&Jmat.Complex.isPositiveInt(a)&&t.re>a.re&&(r=Jmat.Complex.round(r)),r},Jmat.Complex.stirling2=function(t,a){if(!Jmat.Complex.isInt(a))return Jmat.Complex(NaN);var r=Jmat.Complex.ZERO,e=Jmat.Real.isOdd(a.re)?-1:1,m=Jmat.Complex(0);for(m.re=0;m.re<=a.re;m.re++)r=r.add(Jmat.Complex.binomial(a,m).mul(m.pow(t)).mulr(e)),e*=-1;return r.div(Jmat.Complex.factorial(a))},Jmat.Complex.manhattan=function(t,a){return Math.max(Math.abs(t.re-a.re),Math.abs(t.im-a.im))},Jmat.Complex.near=function(t,a,r){var e=void 0==r?1e-15:r;return t.re-e<=a.re&&t.re+e>=a.re&&t.im-e<=a.im&&t.im+e>=a.im},Jmat.Complex.nearr=function(t,a,r){var e=void 0==r?1e-15:r;return t.re-e<=a&&t.re+e>=a&&t.im-e<=0&&t.im+e>=0;
},Jmat.Complex.relnear=function(t,a,r){return t.eq(a)?!0:t.sub(a).abs()<Math.max(t.abs(),a.abs())*r},Jmat.Complex.lambertwb_generic_=function(t,a,r){if(t.isReal(r)&&r.re>-.36&&0==a)return t(Jmat.Real.lambertw(r));if(!Jmat.Real.isInt(a))return t(NaN);if(t.isNaN(r))return NaN;if(t.isInf(r))return t(1/0);if(0==a&&r.eqr(0))return t(0);if(0!=a&&r.eqr(0))return t(-(1/0));var e=t.log(r).add(t(0,a*Math.PI*2));0==a&&r.abs()<1.2&&(e=t.sqrt(r.mulr(5.43656365691809).addr(2)).add(t(-1,a*Math.PI*2))),0!=a&&0==r.im&&(r.im+=1e-14);for(var m=36,n=0;m>n;n++){var i=t.exp(e),o=e.mul(i),l=o.sub(r),u=i.mul(e.addr(1)),J=e.addr(2).mul(l).div(e.mulr(2).addr(2));e=e.sub(l.div(u.sub(J)));var s=t.log(r.div(e));if(t.near(s,e,1e-16)||t.near(o,r,1e-16))break;if(n+1==m&&!t.near(s,e,1)&&!t.near(o,r,1))return t(NaN)}return 0==r.im&&r.re>=0&&(e.im=0),e},Jmat.Complex.lambertwb=function(t,a){return Jmat.Complex.lambertwb_generic_(Jmat.Complex,t,a)},Jmat.Complex.lambertw=function(t){return Jmat.Complex.lambertwb(0,t)},Jmat.Complex.lambertwm=function(t){return Jmat.Complex.lambertwb(-1,t)},Jmat.Complex.faddeeva=function(t){var a=2/Jmat.Real.SQRTPI,r=t.re*t.re+t.im*t.im*2;if(3.5>r){for(var e=Jmat.Complex.ZERO,m=1,n=1,i=Jmat.Complex.I.mul(t).neg(),o=i,l=0;20>l;l++)l>0&&(n*=l,m=-m,o=o.mul(i).mul(i)),e=e.add(o.mulr(m/(n*(2*l+1))));var u=Jmat.Complex.exp(t.mul(t).neg());return u.sub(u.mul(e).mulr(a))}for(var J=Jmat.Complex(Math.abs(t.re),Math.abs(t.im)),s=40>r?40:80>r?20:10,p=Jmat.Complex(0),l=0;s>l;l++){var x=Jmat.Complex(J.im+p.re,J.re-p.im);p=x.mulr(.5/x.abssq())}if(p=p.mulr(a),0==J.im&&(p.re=Math.exp(-J.re*J.re)),t.im<0){var u=Jmat.Complex.exp(J.mul(J).neg()).mulr(2);p=u.sub(p),t.re>0&&(p.im=-p.im)}else t.re<0&&(p.im=-p.im);return p},Jmat.Complex.erfcx=function(t){return Jmat.Complex.faddeeva(Jmat.Complex(-t.im,t.re))},Jmat.Complex.erf=function(t){if(0==t.im)return Jmat.Complex(Jmat.Real.erf(t.re));if(0==t.re)return Jmat.Complex.I.mulr(Jmat.Real.erfi(t.im));var a=Jmat.Complex.exp(t.mul(t).neg());return t.re>=0?Jmat.Complex.ONE.sub(a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I)))):a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I.neg()))).sub(Jmat.Complex.ONE)},Jmat.Complex.erfc=function(t){if(0==t.im)return Jmat.Complex(Jmat.Real.erfc(t.re));var a=Jmat.Complex.exp(t.mul(t).neg());return t.re>=0?a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I))):Jmat.Complex.TWO.sub(a.mul(Jmat.Complex.faddeeva(t.mul(Jmat.Complex.I.neg()))))},Jmat.Complex.erfi=function(t){return Jmat.Complex.isReal(t)?Jmat.Complex(Jmat.Real.erfi(t.re)):Jmat.Complex.erf(t.mul(Jmat.Complex.I)).mul(Jmat.Complex.I).neg()},Jmat.Complex.dawson=function(t){if(Jmat.Complex.isReal(t))return Jmat.Complex(Jmat.Real.dawson(t.re));var a=Jmat.Complex.faddeeva(t),r=Jmat.Complex.exp(t.mul(t).neg());return r.sub(a).mul(Jmat.Complex.I.mulr(Jmat.Real.SQRTPI/2))},Jmat.Complex.random=function(t,a){return t=void 0==t?0:t,a=void 0==a?1:a,Jmat.Complex.polar(Math.random()*(a-t)+t,Math.random()*Math.PI*2)},Jmat.Matrix=function(t,a,r){if(!(this instanceof Jmat.Matrix))return Jmat.Matrix.make.apply(this,arguments);this.h=t,this.w=a,this.e=[];for(var e=0;t>e;e++)this.e[e]=[]},Jmat.Matrix.make=function(t,a,r){if(!t)return new Jmat.Matrix(0,0);if(t instanceof Jmat.Matrix)return Jmat.Matrix.copy(t);if("string"==typeof t)return Jmat.Matrix.parse(t);var e=function(t,a,r){return t&&void 0!=t[a]?Jmat.Complex.cast(void 0==t[a][r]?t[a]:t[a][r]):Jmat.Complex()},m=function(t,a,r){return t&&void 0!=t[a]?Jmat.Real.cast(void 0==t[a][r]?t[a]:t[a][r]):0},n=function(t,a,r,e){return new Jmat.Complex(m(t,r,e),m(a,r,e))},i=function(t){return t&&void 0!=t[0]?void 0==t[0].length?1:t[0].length:0},o=function(t,a,r,m,i){var o;if(m>=0&&r.length<t*a){if(o=Jmat.Matrix.zero(t,a),m>=0&&r.length-m==1){for(var l=0;a>l&&t>l;l++)o.e[l][l]=Jmat.Complex.cast(r[m]);return o}if(m>=0&&r.length-m==Math.min(t,a)){for(var l=0;a>l&&t>l;l++)o.e[l][l]=Jmat.Complex.cast(r[l+m]);return o}return null}o=new Jmat.Matrix(t,a);for(var u=0;u<o.h;u++)for(var l=0;l<o.w;l++)0>m?o.e[u][l]=i?n(r,i,u,l):e(r,u,l):o.e[u][l]=Jmat.Complex.cast(r[u*a+l+m]);return o};if("undefined"!=typeof t&&t.length||"undefined"!=typeof a&&a.length){var l=Math.max(t&&t.length||0,a&&a.length||0),u=Math.max(i(t),i(a));return o(l,u,t,-1,a)}if(void 0!=t&&void 0==a){var J=new Jmat.Matrix(1,1);return J.e[0][0]=Jmat.Complex.cast(t),J}if(void 0!=t&&void 0!=a){if(void 0==r)return new Jmat.Matrix(t,a);var l=t,u=a;return r&&r.length?o(l,u,r,0):o(l,u,arguments,2)}return new Jmat.Matrix(0,0)},Jmat.Matrix.toString=function(t,a){if(!t)return""+t;for(var r="[",e=0;e<t.h;e++){r+="[";for(var m=0;m<t.w;m++){var n=t.e[e][m];r+=Jmat.Complex.toString(n,a),m+1<t.w&&(r+=", ")}r+="]",e+1<t.h&&(r+=", ")}return r+"]"},Jmat.Matrix.prototype.toString=function(t){return Jmat.Matrix.toString(this,t)},Jmat.Matrix.toCurly=function(t,a){return Jmat.Matrix.toString(t,a).replace(/\[/g,"{").replace(/\]/g,"}")},Jmat.Matrix.prototype.toCurly=function(t){return Jmat.Matrix.toCurly(this,t)},Jmat.Matrix.toSemi=function(t,a){if(!t)return""+t;for(var r="[",e=0;e<t.h;e++){for(var m=0;m<t.w;m++){var n=t.e[e][m];r+=Jmat.Complex.toString(n,a),m+1<t.w&&(r+=" ")}e+1<t.h&&(r+="; ")}return r+"]"},Jmat.Matrix.prototype.toSemi=function(t){return Jmat.Matrix.toSemi(this,t)},Jmat.Matrix.parse=function(t){for(var a=[],r=[a],e="",m=1;m<t.length-1&&r.length>0;m++){var n=t.charAt(m);if("["==n){var i=[];r[r.length-1].push(i),r.push(i)}else"]"==n?(""!=e&&(r[r.length-1].push(Jmat.Complex.parse(e)),e=""),r.pop()):","==n?""!=e&&(r[r.length-1].push(Jmat.Complex.parse(e)),e=""):e+=n}return""!=e&&r[r.length-1].push(Jmat.Complex.parse(e)),Jmat.Matrix.make(a)},Jmat.Matrix.render=function(t,a){if(!t)return""+t;if(!Jmat.Matrix.isValid(t)){t=Jmat.Matrix.copy(t);for(var r=0;r<t.h;r++)for(var e=0;e<t.w;e++)t.e[r][e]||(t.e[r][e]=Jmat.Complex(NaN))}a=void 0==a?Jmat.Matrix.isInteger(t)?0:3:a;for(var m="",n=Jmat.Matrix.isReal(t),i=[],o=[],r=0;r<t.h;r++){i.push([]);for(var e=0;e<t.w;e++){0==r&&o.push([0,0]);var l=[t.e[r][e].re.toFixed(a),Math.abs(t.e[r][e].im).toFixed(a)];o[e]=[Math.max(l[0].length,o[e][0]),Math.max(l[1].length,o[e][1])],i[r].push(l)}}for(var r=0;r<t.h;r++){var u="";u+="|"+(r+1==t.h?"_":" ");for(var e=0;e<t.w;e++){for(var l=i[r][e][0];l.length<o[e][0];)l=" "+l;if(!n){for(var J=t.e[r][e].im<0,s=i[r][e][1];s.length<o[e][1];)s="0"+s;s=(J?"-":"+")+s,l+=s+"i"}u+=l+(r+1==t.h&&e+1==t.w?"_":" ")}if(u+="|",0==r){for(var p=" _";p.length+2<u.length;)p+=" ";p+="_",m+=p+"\n"}m+=u+"\n"}return m},Jmat.Matrix.prototype.render=function(t){return Jmat.Matrix.render(this,t)},Jmat.Matrix.cast=function(t){return t instanceof Jmat.Matrix?t:Jmat.Matrix.make(t)},Jmat.Matrix.copy=function(t){for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var e=0;e<t.w;e++)t.e[r][e]?a.e[r][e]=Jmat.Complex(t.e[r][e].re,t.e[r][e].im):a.e[r][e]=t.e[r][e];return a},Jmat.Matrix.identity=function(t,a){for(var r=a||t,e=new Jmat.Matrix(t,r),m=0;t>m;m++)for(var n=0;r>n;n++)e.e[m][n]=Jmat.Complex(n==m?1:0);return e},Jmat.Matrix.zero=function(t,a){for(var r=a||t,e=new Jmat.Matrix(t,r),m=0;t>m;m++)for(var n=0;r>n;n++)e.e[m][n]=Jmat.Complex(0);return e},Jmat.Matrix.add=function(t,a){if(t.w!=a.w||t.h!=a.h)return null;for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].add(a.e[e][m]);return r},Jmat.Matrix.prototype.add=function(t){return Jmat.Matrix.add(this,t)},Jmat.Matrix.sub=function(t,a){if(t.w!=a.w||t.h!=a.h)return null;for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].sub(a.e[e][m]);return r},Jmat.Matrix.prototype.sub=function(t){return Jmat.Matrix.sub(this,t)},Jmat.Matrix.n3mul_=function(t,a){if(t.w!=a.h)return null;for(var r=new Jmat.Matrix(t.h,a.w),e=0;e<t.h;e++)for(var m=0;m<a.w;m++){for(var n=Jmat.Complex(0),i=0;i<t.w;i++)n=n.add(t.e[e][i].mul(a.e[i][m]));r.e[e][m]=n}return r},Jmat.Matrix.strassen_=function(t,a){var r=Jmat.Matrix;if(t.w<128||a.w<128)return r.n3mul_(t,a);if(t.w!=a.h)return null;if(t.w!=t.h||a.w!=a.h)return r.n3mul_(t,a);if(1&t.w||1&a.w)return r.n3mul_(t,a);var e=r.submatrix(t,0,t.h/2,0,t.w/2),m=r.submatrix(t,0,t.h/2,t.w/2,t.w),n=r.submatrix(t,t.h/2,t.h,0,t.w/2),i=r.submatrix(t,t.h/2,t.h,t.w/2,t.w),o=r.submatrix(a,0,a.h/2,0,a.w/2),l=r.submatrix(a,0,a.h/2,a.w/2,a.w),u=r.submatrix(a,a.h/2,a.h,0,a.w/2),J=r.submatrix(a,a.h/2,a.h,a.w/2,a.w),s=e.add(i).mul(o.add(J)),p=n.add(i).mul(o),x=e.mul(l.sub(J)),f=i.mul(u.sub(o)),c=e.add(m).mul(J),C=n.sub(e).mul(o.add(l)),d=m.sub(i).mul(u.add(J)),v=s.add(f).sub(c).add(d),g=x.add(c),h=p.add(f),I=s.sub(p).add(x).add(C),_=v;return _=r.augment(_,g,0,v.w),_=r.augment(_,h,v.h,0),_=r.augment(_,I,v.h,v.w)},Jmat.Matrix.mul=function(t,a){return Jmat.Matrix.strassen_(t,a)},Jmat.Matrix.prototype.mul=function(t){return Jmat.Matrix.mul(this,t)},Jmat.Matrix.mulc=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].mul(a);return r},Jmat.Matrix.prototype.mulc=function(t){return Jmat.Matrix.mulc(this,t)},Jmat.Matrix.mulr=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].mulr(a);return r},Jmat.Matrix.prototype.mulr=function(t){return Jmat.Matrix.mulr(this,t)},Jmat.Matrix.elmul=function(t,a){if(t.w!=a.w||t.h!=a.h)return null;for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].mul(a.e[e][m]);return r},Jmat.Matrix.div=function(t,a){if(t.w!=a.h)return null;var r=new Jmat.Matrix(t.h,a.w);a=Jmat.Matrix.inv(a);for(var e=0;e<t.h;e++)for(var m=0;m<a.w;m++){for(var n=Jmat.Complex(0),i=0;i<t.w;i++)n=n.add(t.e[e][i].mul(a.e[i][m]));r.e[e][m]=n}return r},Jmat.Matrix.prototype.div=function(t){return Jmat.Matrix.div(this,t)},Jmat.Matrix.eldiv=function(t,a){if(t.w!=a.w||t.h!=a.h)return null;for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].div(a.e[e][m]);return r},Jmat.Matrix.leftdiv=function(t,a){if(t.w!=a.h)return null;var r=new Jmat.Matrix(t.h,a.w);a=Jmat.Matrix.inv(a);for(var e=0;e<a.h;e++)for(var m=0;m<t.w;m++){for(var n=Jmat.Complex(0),i=0;i<a.w;i++)n=n.add(a.e[e][i].mul(t.e[i][m]));r.e[e][m]=n}return r},Jmat.Matrix.prototype.leftdiv=function(t){return Jmat.Matrix.leftdiv(this,t)},Jmat.Matrix.divc=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].div(a);return r},Jmat.Matrix.prototype.divc=function(t){return Jmat.Matrix.divc(this,t)},Jmat.Matrix.divr=function(t,a){for(var r=new Jmat.Matrix(t.h,t.w),e=0;e<t.h;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[e][m].divr(a);return r},Jmat.Matrix.prototype.divr=function(t){return Jmat.Matrix.divr(this,t)},Jmat.Matrix.isReal=function(t){for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++){var e=t.e[a][r];if(0!=e.im)return!1}return!0},Jmat.Matrix.isValid=function(t){if(!(t&&t.w&&t.h&&t.e&&t.e.length))return!1;for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++){var e=t.e[a][r];if(!e)return!1;if(e.re==1/0||e.re==-(1/0)||e.re!=e.re)return!1;if(e.im==1/0||e.im==-(1/0)||e.im!=e.im)return!1}return!0},Jmat.Matrix.isNaN=function(t){for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++)if(Jmat.Complex.isNaN(t.e[a][r]))return!0;return!1},Jmat.Matrix.isInfOrNaN=function(t){for(var a=0;a<t.h;a++)for(var r=0;r<t.w;r++)if(Jmat.Complex.isInfOrNaN(t.e[a][r]))return!0;return!1},Jmat.Matrix.isSquare=function(t){return t.w==t.h},Jmat.Matrix.isSingular=function(t,a){var r=void 0==a?1e-15:a,e=Jmat.Matrix.conditionNumber(t);return Jmat.Matrix.isSquare(t)&&e.abs()>=1/r},Jmat.Matrix.isInvertible=function(t,a){var r=void 0==a?1e-15:a;return Jmat.Matrix.isSquare(t)&&!Jmat.Matrix.isSingular(t,r)},Jmat.Matrix.isIdentity=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=0;m<t.w;m++){var n=m==e?1:0;if(!Jmat.Complex.nearr(t.e[e][m],n,r))return!1}return!0},Jmat.Matrix.isDiagonal=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=0;m<t.w;m++)if(m!=e&&!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isZero=function(t,a){for(var r=void 0==a?1e-15:a,e=0;e<t.h;e++)for(var m=0;m<t.w;m++)if(!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isSymmetrical=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=e+1;m<t.w;m++)if(!Jmat.Complex.near(t.e[e][m],t.e[m][e],r))return!1;return!0},Jmat.Matrix.isHermitian=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=e;m<t.w;m++)if(!Jmat.Complex.near(t.e[e][m],Jmat.Complex.conj(t.e[m][e]),r))return!1;return!0},Jmat.Matrix.isSkewSymmetrical=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=e;m<t.w;m++)if(!Jmat.Complex.near(t.e[e][m],Jmat.Complex.neg(t.e[m][e]),r))return!1;return!0},Jmat.Matrix.isSkewHermitian=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=e;m<t.w;m++)if(!Jmat.Complex.near(t.e[e][m],Jmat.Complex.conj(t.e[m][e]).neg(),r))return!1;return!0},Jmat.Matrix.isUpperTriangular=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=0;e>m;m++)if(!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isLowerTriangular=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=e+1;m<t.w;m++)if(!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isStrictlyUpperTriangular=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=0;e>=m;m++)if(!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isStrictlyLowerTriangular=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=e;m<t.w;m++)if(!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isUpperHessenberg=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=0;e>m+1;m++)if(!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isLowerHessenberg=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=e+2;m<t.w;m++)if(!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isTridiagonal=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++)for(var m=0;m<t.w;m++)if(m!=e&&m+1!=e&&m!=e+1&&!Jmat.Complex.nearr(t.e[e][m],0,r))return!1;return!0},Jmat.Matrix.isOrthogonal=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;var e=t.mul(t.transpose());return Jmat.Matrix.isIdentity(e,r)},Jmat.Matrix.isUnitary=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;var e=t.mul(t.transjugate());return Jmat.Matrix.isIdentity(e,r)},Jmat.Matrix.isNormal=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;var e=t.transjugate();return Jmat.Matrix.near(t.mul(e),e.mul(t),r)},Jmat.Matrix.isPermutation=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e<t.h;e++){for(var m=0,n=0,i=0,o=0;o<t.w;o++)Jmat.Complex.nearr(t.e[e][o],0,r)?Jmat.Complex.nearr(t.e[e][o],1,r)?i++:n++:m++;if(1!=n||i>0)return!1}for(var o=0;o<t.w;o++){for(var m=0,n=0,i=0,e=0;e<t.h;e++)Jmat.Complex.nearr(t.e[e][o],0,r)?Jmat.Complex.nearr(t.e[e][o],1,r)?i++:n++:m++;if(1!=n||i>0)return!1}return!0},Jmat.Matrix.isToeplitz=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=0;e+1<t.h;e++)for(var m=0;m+1<t.w;m++)if(!Jmat.Complex.near(t.e[e][m],t.e[e+1][m+1],r))return!1;return!0},Jmat.Matrix.isHankel=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=1;e<t.h;e++)for(var m=0;m+1<t.w;m++)if(!Jmat.Complex.near(t.e[e][m],t.e[e-1][m+1],r))return!1;return!0},Jmat.Matrix.isFrobenius=function(t,a){var r=void 0==a?1e-15:a;if(!Jmat.Matrix.isSquare(t))return!1;for(var e=-1,m=0;m<t.h;m++)for(var n=0;n<t.w;n++){if(n==m&&!Jmat.Complex.nearr(t.e[m][n],1,r))return!1;if(n>m&&!Jmat.Complex.nearr(t.e[m][n],0,r))return!1;if(m>n&&!Jmat.Complex.nearr(t.e[m][n],0,r)){if(e>=0&&n!=e)return!1;e=n}}return!0},Jmat.Matrix.isInteger=function(t,a){for(var r=void 0==a?1e-15:a,e=0;e<t.h;e++)for(var m=0;m<t.w;m++){var n=t.e[e][m];if(!Jmat.Real.near(n.im,0,r))return!1;if(Math.abs(Math.round(n.re)-n.re)>r)return!1}return!0},Jmat.Matrix.isBinary=function(t,a){for(var r=void 0==a?1e-15:a,e=0;e<t.h;e++)for(var m=0;m<t.w;m++){var n=t.e[e][m];if(!Jmat.Real.near(n,0,r)&&!Jmat.Real.near(n,1,r))return!1}return!0},Jmat.Matrix.isInvolutory=function(t,a){return Jmat.Matrix.isSquare(t)?Jmat.Matrix.isIdentity(t.mul(t),a):!1},Jmat.Matrix.isIdempotent=function(t,a){return Jmat.Matrix.isSquare(t)?Jmat.Matrix.near(t,t.mul(t),a):!1},Jmat.Matrix.isNilpotent=function(t,a){var r=Jmat.Matrix,e=void 0==a?1e-15:a;if(!r.isSquare(t))return!1;for(var m=t.w,n=1;;){if(!r.trace(t).eqr(0,e))return!1;if(r.isZero(t,e))return!0;if(n>=m)break;t=t.mul(t),n*=2}return!1},Jmat.Matrix.getProperties=function(t){var a=Jmat.Matrix,r={};if(r.dimensions=""+t.h+"x"+t.w,r.height=t.h,r.width=t.w,r.square=a.isSquare(t),r.zero=a.isZero(t),r.real=a.isReal(t),r.rank=a.rank(t),r.frobeniusNorm=a.norm(t),r.spectralNorm=a.norm2(t),r.conditionNumber=a.conditionNumber(t),r.NaN=a.isNaN(t),r.identity=a.isIdentity(t),r.diagonal=a.isDiagonal(t),r.tridiagonal=a.isTridiagonal(t),r.symmetrical=a.isSymmetrical(t),r.hermitian=a.isHermitian(t),r.skewHermitian=a.isSkewHermitian(t),r.skewSymmetrical=a.isSkewSymmetrical(t),r.upperTriangular=a.isUpperTriangular(t),r.lowerTriangular=a.isLowerTriangular(t),r.strictlyUpperTriangular=a.isStrictlyUpperTriangular(t),r.strictlyLowerTriangular=a.isStrictlyLowerTriangular(t),r.upperHessenberg=a.isUpperHessenberg(t),r.lowerHessenberg=a.isLowerHessenberg(t),r.singular=a.isSingular(t),r.invertible=a.isInvertible(t),r.determinant=a.determinant(t),r.trace=a.trace(t),r.orthogonal=a.isOrthogonal(t),r.unitary=a.isUnitary(t),r.normal=a.isNormal(t),r.permutation=a.isPermutation(t),r.toeplitz=a.isToeplitz(t),r.hankel=a.isHankel(t),r.frobenius=a.isFrobenius(t),r.integer=a.isInteger(t),r.binary=a.isBinary(t),r.involutory=a.isInvolutory(t),r.idempotent=a.isIdempotent(t),r.hermitian){var e=a.definiteness(t);e==a.INDEFINITE?r.indefinite=!0:e==a.POSITIVE_DEFINITE?r.positiveDefinite=r.positiveSemidefinite=!0:e==a.NEGATIVE_DEFINITE?r.negativeDefinite=r.negativeSemidefinite=!0:e==a.POSITIVE_SEMI_DEFINITE||r.zero?r.positiveSemidefinite=!0:(e==a.NEGATIVE_SEMI_DEFINITE||r.zero)&&(r.negativeSemidefinite=!0)}return r},Jmat.Matrix.summary=function(t){var a=Jmat.Matrix.getProperties(t),r=function(t){return"NaN"!=t&&(t=t.replace(/([A-Z])/g," $1").toLowerCase()),t=t.replace("hessenberg","Hessenberg"),t=t.replace("frobenius","Frobenius"),t=t.replace("toeplitz","Toeplitz"),t=t.replace("hankel","Hankel"),t=t.replace("frobenius","Frobenius")},e=["height","width","zero","real","NaN","rank","frobeniusNorm","spectralNorm","conditionNumber","integer","binary"],m=["identity","symmetrical","hermitian","skewSymmetrical","skewHermitian","diagonal","tridiagonal","upperTriangular","lowerTriangular","strictlyUpperTriangular","strictlyLowerTriangular","upperHessenberg","lowerHessenberg","singular","invertible","determinant","trace","orthogonal","unitary","normal","permutation","toeplitz","hankel","indefinite","positiveDefinite","negativeDefinite","positiveSemidefinite","negativeSemidefinite","frobenius","involutory","idempotent"],n={square:"non-square",real:"complex"};a.small2x2=t.w<=2&&t.h<=2,a.small1x1=t.w<=1&&t.h<=1,a.realsym=a.real&&a.symmetrical,a.realskewsym=a.real&&a.skewSymmetrical;for(var i={strictlyUpperTriangular:["zero"],strictlyLowerTriangular:["zero"],upperTriangular:["diagonal","strictlyUpperTriangular"],lowerTriangular:["diagonal","frobenius","strictlyLowerTriangular"],upperHessenberg:["upperTriangular","tridiagonal"],lowerHessenberg:["lowerTriangular","tridiagonal"],diagonal:["small1x1","identity","zero"],tridiagonal:["small2x2","diagonal"],orthogonal:["normal","identity"],unitary:["normal"],normal:["identity","zero"],hermitian:["normal"],hermitian:["realsym"],skewHermitian:["realskewsym"],symmetrical:["diagonal"],skewSymmetrical:["zero"],permutation:["identity"],invertible:["identity"],singular:["zero"],real:["integer"],toeplitz:["identity","zero"],hankel:["zero"],frobenius:["identity"],positiveDefinite:["identity"],negativeSemidefinite:["zero","negativeDefinite"],positiveSemidefinite:["zero","positiveDefinite"],integer:["binary"],binary:["identity","zero"],involutory:["identity"],idempotent:["identity"]},o=a.dimensions+", "+(a.square?"square":n.square),l=0;l<e.length+m.length;l++){var u=l<e.length?e[l]:m[l-e.length];if(a[u]===!0){if(i[u]){for(var J=!1,s=0;s<i[u].length;s++)a[i[u][s]]===!0&&(J=!0);if(J)continue}o+=", "+r(u)}a[u]===!1&&n[u]&&(o+=", "+r(n[u]))}var p=a.square?", determinant "+a.determinant:"";return o=""+o+" matrix with rank "+a.rank+p+" and condition number "+a.conditionNumber+".\n"},Jmat.Matrix.prototype.summary=function(){return Jmat.Matrix.summary(this)},Jmat.Matrix.render_summary=function(t){return t.render()+"\n"+t.summary()},Jmat.Matrix.prototype.render_summary=function(){return Jmat.Matrix.render_summary(this)},Jmat.Matrix.transpose=function(t){for(var a=new Jmat.Matrix(t.w,t.h),r=0;r<t.h;r++)for(var e=0;e<t.w;e++)a.e[e][r]=t.e[r][e];return a},Jmat.Matrix.prototype.transpose=function(){return Jmat.Matrix.transpose(this)},Jmat.Matrix.neg=function(t){for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var e=0;e<t.w;e++)a.e[r][e]=t.e[r][e].neg();return a},Jmat.Matrix.prototype.neg=function(){return Jmat.Matrix.neg(this)},Jmat.Matrix.conj=function(t){for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var e=0;e<t.w;e++)a.e[r][e]=Jmat.Complex.conj(t.e[r][e]);return a},Jmat.Matrix.prototype.conj=function(){return Jmat.Matrix.conj(this)},Jmat.Matrix.transjugate=function(t){return Jmat.Matrix.conj(Jmat.Matrix.transpose(t))},Jmat.Matrix.prototype.transjugate=function(){return Jmat.Matrix.transjugate(this)},Jmat.Matrix.doolittle_lup_=function(t){if(t.h!=t.w)return null;var a=Jmat.Matrix,r=Jmat.Complex;t=a.copy(t);for(var e=[],m=0,n=0;n<t.h;n++){for(var i=n,o=t.e[i][n].abs(),l=n+1;l<t.h;l++)t.e[l][n].abs()>o&&(o=t.e[l][n].abs(),i=l);if(e[n]=i,i!=n){for(var l=0;l<t.h;l++){var u=t.e[i][l];t.e[i][l]=t.e[n][l],t.e[n][l]=u}m^=1}for(var l=n+1;l<t.h;l++)t.e[l][n]=t.e[l][n].div(t.e[n][n]),r.isNaN(t.e[l][n])&&(t.e[l][n]=r(0));for(var l=n+1;l<t.h;l++)for(var J=n+1;J<t.h;J++)t.e[l][J]=t.e[l][J].sub(t.e[l][n].mul(t.e[n][J]))}return[t,e,m]},Jmat.Matrix.lu=function(t){var a=Jmat.Matrix,r=Jmat.Complex,e=a.doolittle_lup_(t);if(!e)return e;t=e[0];for(var m=e[1],n=a.identity(t.w),i=a.zero(t.w),o=0;o<t.h;o++)for(var l=0;l<t.w;l++)l>=o?i.e[o][l]=t.e[o][l]:n.e[o][l]=t.e[o][l];for(var u=a.zero(t.w),J=[],s=0;s<t.h;s++)J[s]=s;for(var s=0;s<t.h;s++){var p=J[s];J[s]=J[m[s]],J[m[s]]=p}for(var s=0;s<t.h;s++)u.e[J[s]][s]=r(1);return{p:u,l:n,u:i}},Jmat.Matrix.subrow=function(t,a){if(t.h<2)return null;for(var r=new Jmat.Matrix(t.h-1,t.w),e=0;e<t.h-1;e++)for(var m=0;m<t.w;m++)r.e[e][m]=t.e[a>e?e:e+1][m];return r},Jmat.Matrix.subcol=function(t,a){if(t.w<2)return null;for(var r=new Jmat.Matrix(t.h,t.w-1),e=0;e<t.h;e++)for(var m=0;m<t.w-1;m++)r.e[e][m]=t.e[e][a>m?m:m+1];return r},Jmat.Matrix.minorsub=function(t,a,r){if(t.h<2||t.w<2)return null;for(var e=new Jmat.Matrix(t.h-1,t.w-1),m=0;m<t.h-1;m++)for(var n=0;n<t.w-1;n++)e.e[m][n]=t.e[a>m?m:m+1][r>n?n:n+1];return e},Jmat.Matrix.submatrix=function(t,a,r,e,m){if(0>e||0>a||e>t.w||a>t.h)return null;if(0>m||0>r||m>t.w||r>t.h)return null;var n=m-e,i=r-a;if(0>=n||0>=i||n>t.w||i>t.h)return null;for(var o=new Jmat.Matrix(i,n),l=0;i>l;l++)for(var u=0;n>u;u++)o.e[l][u]=t.e[a+l][e+u];return o},Jmat.Matrix.minor=function(t,a,r){if(t.h<2||t.w<2||t.w!=t.h)return Jmat.Complex(NaN);var e=Jmat.Matrix.minorsub(t,a,r);return Jmat.Matrix.determinant(e)},Jmat.Matrix.cofactor=function(t,a,r){var e=Jmat.Matrix.minor(t,a,r),m=0==(a+r&1)?1:-1;return e.mulr(m)},Jmat.Matrix.determinant=function(t){if(t.w!=t.h)return NaN;if(1==t.w)return t.e[0][0];if(2==t.w)return t.e[0][0].mul(t.e[1][1]).sub(t.e[0][1].mul(t.e[1][0]));for(var a=Jmat.Matrix.doolittle_lup_(t),r=Jmat.Complex(1),e=0;e<t.w;e++)r=r.mul(a[0].e[e][e]);return 1&a[2]&&(r=r.neg()),r},Jmat.Matrix.adj=function(t){if(t.w!=t.h)return NaN;if(1==t.w)return Jmat.Matrix.identity(1,1);for(var a=new Jmat.Matrix(t.h,t.w),r=0;r<t.h;r++)for(var e=0;e<t.w;e++)a.e[r][e]=Jmat.Matrix.cofactor(t,e,r);return a},Jmat.Matrix.inv=function(t){return t.w!=t.h?null:Jmat.Matrix.mulc(Jmat.Matrix.adj(t),Jmat.Complex.inv(Jmat.Matrix.determinant(t)))},Jmat.Matrix.pseudoinverse_=function(t){for(var a=Jmat.Matrix.svd(t),r=Math.min(a.s.w,a.s.h),e=1e-15,m=0;r>m;m++)a.s.e[m][m]=Math.abs(a.s.e[m][m].re)<e?a.s.e[m][m]:Jmat.Complex.inv(a.s.e[m][m]);return a.s=Jmat.Matrix.transpose(a.s),Jmat.Matrix.mul(Jmat.Matrix.mul(a.v,a.s),Jmat.Matrix.transjugate(a.u))},Jmat.Matrix.pseudoinverse=function(t){var a=Jmat.Matrix.inv(t);return Jmat.Matrix.isValid(a)?a:Jmat.Matrix.pseudoinverse_(t)},Jmat.Matrix.getFirstNonZeroDigit_=function(t){if(0==t)return 0;0>t&&(t=-t);for(var a=0;100>a;a++)if(1>t)t*=10;else{if(!(t>=10))return Math.floor(t);t/=10}return 0},Jmat.Matrix.getDebugNumber=function(t){for(var a=t.w+10*t.h,r=.1,e=0;e<t.h;e++)for(var m=0;m<t.w;m++){var n=Jmat.Matrix.getFirstNonZeroDigit_(t.e[e][m].re);a+=n*r,r/=10}return r*=10,a=Math.round(a/r)*r,Jmat.Complex(a)},Jmat.Matrix.norm=function(t){for(var a=0,r=0;r<t.h;r++)for(var e=0;e<t.w;e++){var m=t.e[r][e];a+=m.abssq()}return a=Math.sqrt(a),Jmat.Complex(a)},Jmat.Matrix.maxcolnorm=function(t){for(var a=0,r=0;r<t.w;r++){for(var e=0,m=0;m<t.h;m++)e+=t.e[m][r].abssq();e>a&&(a=e)}return Jmat.Complex(a)},Jmat.Matrix.maxrownorm=function(t){for(var a=0,r=0;r<t.h;r++){for(var e=0,m=0;m<t.w;m++)e+=t.e[r][m].abssq();e>a&&(a=e)}return Jmat.Complex(a)},Jmat.Matrix.norm2=function(t){var a=Jmat.Matrix.svd(t);return a.s.e[0][0]},Jmat.Matrix.conditionNumber=function(t){var a=Jmat.Matrix.svd(t),r=Math.min(t.w,t.h),e=a.s.e[0][0].div(a.s.e[r-1][r-1]);return Jmat.Complex.isNaN(e)&&(e=Jmat.Complex(1/0)),e},Jmat.Matrix.rank=function(t,a){for(var r=void 0==a?1e-14:a,e=Jmat.Matrix.svd(t).s,m=0,n=Math.min(e.w,e.h),i=0;n>i;i++)Jmat.Real.near(e.e[i][i].re,0,r)||m++;return Jmat.Complex(m)},Jmat.Matrix.trace=function(t){if(t.w!=t.h)return Jmat.Complex(NaN);for(var a=Jmat.Complex.ZERO,r=0;r<t.w;r++)a=a.add(t.e[r][r]);return a},Jmat.Matrix.col=function(t,a){for(var r=new Jmat.Matrix(t.h,1),e=0;e<t.h;e++)r.e[e][0]=t.e[e][a];return r},Jmat.Matrix.row=function(t,a){for(var r=new Jmat.Matrix(1,t.w),e=0;e<t.w;e++)r.e[0][e]=t.e[a][e];return r},Jmat.Matrix.setCol=function(t,a,r){for(var e=0;e<t.h;e++)t.e[e][r]=a.e[e][0]},Jmat.Matrix.setRow=function(t,a,r){for(var e=0;e<t.w;e++)t.e[r][e]=a.e[0][e]},Jmat.Matrix.overlap=function(t,a,r,e){for(var m=Math.max(r+a.h,t.h)-Math.min(0,r),n=Math.max(e+a.w,t.w)-Math.min(0,e),i=Jmat.Matrix.zero(m,n),o=0;o<t.h;o++)for(var l=0;l<t.w;l++){var u=0>e?l-e:l,J=0>r?o-r:o;i.e[J][u]=t.e[o][l]}for(var o=0;o<a.h;o++)for(var l=0;l<a.w;l++){var u=0>e?l:l+e,J=0>r?o:o+r;i.e[J][u]=i.e[J][u].add(a.e[o][l])}return i},Jmat.Matrix.insert=function(t,a,r,e){for(var m=Jmat.Matrix.copy(t),n=0;n<a.h;n++)for(var i=0;i<a.w;i++){var o=i+e,l=n+r;o>=0&&o<t.w&&l>=0&&l<t.h&&(m.e[l][o]=a.e[n][i])}return m},Jmat.Matrix.augment=function(t,a,r,e){for(var m=Math.max(r+a.h,t.h)-Math.min(0,r),n=Math.max(e+a.w,t.w)-Math.min(0,e),i=Jmat.Matrix.zero(m,n),o=0;o<t.h;o++)for(var l=0;l<t.w;l++){var u=0>e?l-e:l,J=0>r?o-r:o;i.e[J][u]=t.e[o][l]}for(var o=0;o<a.h;o++)for(var l=0;l<a.w;l++){var u=0>e?l:l+e,J=0>r?o:o+r;i.e[J][u]=a.e[o][l]}return i},Jmat.Matrix.getHouseholderVector_=function(t,a){var r=Jmat.Matrix,e=Jmat.Complex,m=t.e[0][0].eqr(0)?e(-1):e.sign(t.e[0][0]),n=r.identity(t.h,1).mulc(m.mul(r.norm(t))).add(t),i=r.isZero(n,1e-30);i||(n=n.divc(r.norm(n)));var o;if(i)o=e(0);else if(a)o=e(2);else{var l=r.mul(r.row(r.transjugate(t),0),n),u=r.mul(r.transjugate(n),r.col(t,0));o=l.e[0][0].div(u.e[0][0]).addr(1)}return[n,o]},Jmat.Matrix.getGivensParams_=function(t,a){if(a.eqr(0))return[Jmat.Complex(1),Jmat.Complex(0),t];var r=Jmat.Complex.hypot(t,a),e=t.div(r),m=a.div(r).neg();return[e,m,r]},Jmat.Matrix.givensPre_=function(t,a,r,e,m){for(var n=0;n<t.w;n++){var i=t.e[a][n],o=t.e[r][n];t.e[a][n]=i.mul(e.conj()).add(o.mul(m.neg().conj())),t.e[r][n]=i.mul(m).add(o.mul(e))}},Jmat.Matrix.givensPost_=function(t,a,r,e,m){for(var n=0;n<t.h;n++){var i=t.e[n][a],o=t.e[n][r];t.e[n][a]=i.mul(e).add(o.mul(m.neg())),t.e[n][r]=i.mul(m.conj()).add(o.mul(e.conj()))}},Jmat.Matrix.toHessenberg=function(t){var a=Jmat.Matrix,r=a.transjugate;if(t.h!=t.w)return null;for(var e=Jmat.Matrix.isReal(t),m=a.copy(t),n=0;n+2<t.w;n++){var i=a.submatrix(m,n+1,m.h,n,n+1),o=a.getHouseholderVector_(i,e),l=o[0],u=o[1],J=a.submatrix(m,n+1,m.h,n,m.w);J=J.sub(l.mul(r(l)).mul(J).mulc(u)),m=a.insert(m,J,n+1,n),J=a.submatrix(m,0,m.h,n+1,m.w),J=J.sub(J.mul(l).mul(r(l)).mulc(u)),m=a.insert(m,J,0,n+1)}for(var s=0;s<m.h;s++)for(var i=0;i<Math.max(s-1,0);i++)m.e[s][i]=Jmat.Complex(0);return m},Jmat.Matrix.qr_hessenberg_=function(t){for(var a=Jmat.Matrix,r=Jmat.Complex,e=Math.min(t.h-1,t.w),m=a.copy(t),n=a.identity(t.h,t.h),i=0;e>i;i++){var o=a.getGivensParams_(m.e[i][i],m.e[i+1][i]);a.givensPre_(m,i,i+1,o[0],o[1]),m.e[i+1][i]=r(0),a.givensPost_(n,i,i+1,o[0],o[1])}return{q:n,r:m}},Jmat.Matrix.qr_general_=function(t){var a=Jmat.Matrix,r=a.transjugate,e=Jmat.Matrix.isReal(t),m=t.h,n=t.w,i=[],o=[];if(t.h<t.w)return null;for(var l=a.copy(t),u=0;n>u;u++){var J=a.submatrix(l,u,l.h,u,u+1),s=a.getHouseholderVector_(J,e);i[u]=s[0],o[u]=s[1];var p=a.submatrix(l,u,m,u,n);p=p.sub(i[u].mul(r(i[u])).mul(p).mulc(o[u])),l=a.insert(l,p,u,u)}for(var x=a.identity(m,m),u=n-1;u>=0;u--){var f=a.submatrix(x,u,m,0,m);f=f.sub(i[u].mul(r(i[u])).mul(f).mulc(o[u])),x=a.insert(x,f,u,0)}return{q:x,r:l}},Jmat.Matrix.qr=function(t){return Jmat.Matrix.isUpperHessenberg(t,1e-18)?Jmat.Matrix.qr_hessenberg_(t):Jmat.Matrix.qr_general_(t)},Jmat.Matrix.eig11=function(t){if(1!=t.w||1!=t.h)return null;var a={};return a.l=new Jmat.Matrix(1,1),a.l.e[0][0]=Jmat.Complex(t.e[0][0]),a.v=new Jmat.Matrix(1,1),a.v.e[0][0]=Jmat.Complex(1),a},Jmat.Matrix.eigval22=function(t){if(2!=t.w||2!=t.h)return null;var a=Jmat.Complex(1),r=t.e[0][0].neg().sub(t.e[1][1]),e=t.e[0][0].mul(t.e[1][1]).sub(t.e[0][1].mul(t.e[1][0])),m=Jmat.Complex.sqrt(r.mul(r).sub(a.mul(e).mulr(4))),n=r.neg().add(m).div(a.mulr(2)),i=r.neg().sub(m).div(a.mulr(2));return i.abssq()>n.abssq()?[i,n]:[n,i]},Jmat.Matrix.eig22=function(t){if(2!=t.w||2!=t.h)return null;var a=Jmat.Matrix.eigval22(t),r=a[0],e=a[1],m=t.e[0][1].div(r.sub(t.e[0][0])),n=Jmat.Complex(1),i=t.e[0][1].div(e.sub(t.e[0][0])),o=Jmat.Complex(1),l={};return l.l=new Jmat.Matrix(2,1),l.l.e[0][0]=r,l.l.e[1][0]=e,l.v=new Jmat.Matrix(2,2),l.v.e[0][0]=m,l.v.e[1][0]=n,l.v.e[0][1]=i,l.v.e[1][1]=o,l},Jmat.Matrix.eigval_=function(t){for(var a=Jmat.Complex,r=Jmat.Matrix,e=1.2e-16,m=t.w,n=a(0),i=a(0),o=a(0),l=a(0),u=a(0),J=[],s=0;m>s;s++)J[s]=a(0);for(;m>0;)for(var p=0;30>=p;p++){if(30==p)return null;var x;for(x=m-1;x>=1;x--)if(a.abs1r(t.e[x][x-1])<=e*(a.abs1r(t.e[x-1][x-1])+a.abs1r(t.e[x][x]))){t.e[x][x-1]=a(0);break}if(x==m-1){J[m-1]=t.e[m-1][m-1].add(i),m--;break}10==p||20==p?(n.re=Math.abs(t.e[m-1][m-2].re)+Math.abs(t.e[m-2][m-3].re),n.im=Math.abs(t.e[m-1][m-2].im)+Math.abs(t.e[m-2][m-3].im)):(n=t.e[m-1][m-1],o=t.e[m-2][m-1].mul(t.e[m-1][m-2]),o.eqr(0)||(l=t.e[m-2][m-2].sub(n).divr(2),u=a.sqrt(l.mul(l).add(o)),l.re*u.re+l.im*u.im<0&&(u=u.neg()),o=o.div(l.add(u)),n=n.sub(o)));for(var s=0;m>s;s++)t.e[s][s]=t.e[s][s].sub(n);i=i.add(n);for(var f=[],c=0;m>c+1;c++)f[c]=r.getGivensParams_(t.e[c][c],t.e[c+1][c]),r.givensPre_(t,c,c+1,f[c][0],f[c][1]),t.e[c+1][c]=a(0),t.e[c][c]=f[c][2];for(var c=0;m>c+1;c++)r.givensPost_(t,c,c+1,f[c][0],f[c][1])}return J},Jmat.Matrix.eigval=function(t){var a=Jmat.Matrix;if(t.w!=t.h||t.w<1)return null;var r=t.w;if(1==r)return[t.e[0][0]];
if(2==r)return a.eigval22(t);var e=a.toHessenberg(t),m=a.eigval_(e);return m.sort(function(t,a){return a.abssq()-t.abssq()}),m},Jmat.Matrix.eigenVectorFor=function(t,a,r){var e=Jmat.Matrix;if(t.w!=t.h||t.w<1)return null;var m=t.w,n=void 0==r?1:r;t=e.copy(t);for(var i=0;m>i;i++)t.e[i][i]=t.e[i][i].sub(a);var o=e.zero(m,1),l=e.solve(t,o,.01);if(l)2==n&&(l=l.divc(e.norm(l))),1==n&&(l.e[m-1][0].eqr(0)||(l=l.divc(l.e[m-1][0])));else{l=e.zero(m,1);for(var i=0;m>i;i++)l.e[i][j]=Jmat.Complex(NaN,NaN)}return l},Jmat.Matrix.eig=function(t,a){var r=Jmat.Matrix;if(t.w!=t.h||t.w<1)return null;var e=t.w;if(1==e)return r.eig11(t);if(2==e)return r.eig22(t);var m=r.eigval(t);m.sort(function(t,a){return a.abssq()-t.abssq()});for(var n=null,n=new r(e,e),i=0;e>i;i++){var o=r.eigenVectorFor(t,m[i],a);r.setCol(n,o,i)}return{l:m,v:n}},Jmat.Matrix.evd=function(t){var a=Jmat.Matrix.eig(t);return{v:a.v,d:Jmat.Matrix.diag(a.l)}},Jmat.Matrix.definiteness_=function(t,a){var r=void 0==a?1e-12:a,e=Jmat.Matrix.eigval(t);if(!e)return null;for(var m=[!1,!1,!1],n=0;n<e.length;n++)Jmat.Real.near(e[n].re,0,r)?m[1]=!0:e[n].re>0?m[2]=!0:m[0]=!0;return m},Jmat.Matrix.INDEFINITE=0,Jmat.Matrix.POSITIVE_DEFINITE=1,Jmat.Matrix.POSITIVE_SEMI_DEFINITE=2,Jmat.Matrix.NEGATIVE_DEFINITE=3,Jmat.Matrix.NEGATIVE_SEMI_DEFINITE=4,Jmat.Matrix.definiteness=function(t,a){if(!Jmat.Matrix.isHermitian(t,a))return null;var r=Jmat.Matrix.definiteness_(t,a);return!r[2]||r[0]||r[1]?!r[0]||r[2]||r[1]?r[0]?r[2]?r[0]&&r[2]?Jmat.Matrix.INDEFINITE:null:Jmat.Matrix.NEGATIVE_SEMI_DEFINITE:Jmat.Matrix.POSITIVE_SEMI_DEFINITE:Jmat.Matrix.NEGATIVE_DEFINITE:Jmat.Matrix.POSITIVE_DEFINITE},Jmat.Matrix.arrayToCol=function(t){for(var a=new Jmat.Matrix(t.length,1),r=0;r<t.length;r++)a.e[r][0]=Jmat.Complex.cast(t[r]);return a},Jmat.Matrix.arrayToRow=function(t){for(var a=new Jmat.Matrix(1,t.length),r=0;r<t.length;r++)a.e[0][r]=Jmat.Complex.cast(t[r]);return a},Jmat.Matrix.arrayToDiag=function(t){for(var a=new Jmat.Matrix(t.length,t.length),r=0;r<t.length;r++)a.e[r][r]=Jmat.Complex.cast(t[r]);return a},Jmat.Matrix.diag=function(t){for(var a=t.w*t.h,r=Jmat.Matrix.zero(a,a),e=0,m=0;m<t.h;m++)for(var n=0;n<t.w;n++)r.e[e][e]=t.e[m][n],e++;return r},Jmat.Matrix.get1=function(t,a){var r=a%t.w,e=Math.floor(a/t.w);return t.e[e][r]},Jmat.Matrix.prototype.get1=function(t){return Jmat.Matrix.get1(this,t)},Jmat.Matrix.set1=function(t,a,r){var e=a%t.w,m=Math.floor(a/t.w);t.e[m][e]=r},Jmat.Matrix.cross=function(t,a){if(t.w*t.h!=3||a.w*a.h!=3)return Jmat.Matrix(NaN);var r=new Jmat.Matrix(t.h,t.w);return Jmat.Matrix.set1(r,0,t.get1(1).mul(a.get1(2)).sub(t.get1(2).mul(a.get1(1)))),Jmat.Matrix.set1(r,1,t.get1(2).mul(a.get1(0)).sub(t.get1(0).mul(a.get1(2)))),Jmat.Matrix.set1(r,2,t.get1(0).mul(a.get1(1)).sub(t.get1(1).mul(a.get1(0)))),r},Jmat.Matrix.dot=function(t,a){if((t.w!=a.w||t.h!=a.h)&&(t.w!=a.h||t.h!=a.w||1!=t.w&&1!=t.h))return Jmat.Matrix(NaN);for(var r=t.w*t.h,e=Jmat.Complex(0),m=0;r>m;m++)e=e.add(t.get1(m).mul(a.get1(m).conj()));return e},/*
@license
License of Jmat.Matrix.zsvdc_: this function is from linpack, from http://www.netlib.org/linpack/
The license is not mentioned directly in the source code or the website, but
has been said to now be a variant of the BSD license: see
https://bugzilla.redhat.com/show_bug.cgi?id=1000829.
Here is the original author comment from zsvdc.f:
    linpack. this version dated 03/19/79 .
             correction to shift calculation made 2/85.
    g.w. stewart, university of maryland, argonne national lab.
*/
Jmat.Matrix.zsvdc_=function(t,a,r,e,m,n,i,o,l,u,J,s){var p,x,f,c,C,d,v,g,h,I,_,b,M,w,B,R,N,y,q,E,Q,O,S,P,A,T,z,F,k,Z,j,D,Y,G,V,H,L,W,U,K,X,$=30,tt=function(t){return t.re},at=function(t){return Math.abs(t.re)+Math.abs(t.im)},rt=function(t){return at(t)<1e-150},et=function(t,a){return a.eqr(0)?Jmat.Complex(0):a.mulr(t.abs()/a.abs())},mt=function(t,a){return 0==a?0:0>a?-Math.abs(t):Math.abs(t)},j=function(t,a,r){for(var e=Jmat.Complex(0),m=0;t>m;m++){var n=a[r+m];e=e.add(n.mul(n.conj()))}return Jmat.Complex.sqrt(e)},nt=function(t,a,r,e,m,n){for(var i=0;t>i;i++)m[n+i]=m[n+i].add(r[e+i].mul(a))},it=function(t,a,r,e,m){for(var n=Jmat.Complex(0),i=0;t>i;i++)n=n.add(a[r+i].conj().mul(e[m+i]));return n},ot=function(t,a,r,e){for(var m=0;t>m;m++)r[e+m]=r[e+m].mul(a)},lt=function(t,a){var r=Math.abs(t),e=Math.abs(a),m=mt(Math.sqrt(t*t+a*a),r>e?t:a),n=0==m?1:t/m,i=0==m?0:a/m,o=r>e?i:0==m?0:0==n?1:1/n;return[m,o,n,i]},ut=function(t,a,r,e,m,n,i){for(var o=0;t>o;o++){var l=a[r+o],u=e[m+o];a[r+o]=l.mulr(n).add(u.mulr(i)),e[m+o]=u.mulr(n).sub(l.mulr(i))}},Jt=function(t,a,r,e,m){for(var n=0;t>n;n++){var i=a[n+r];a[n+r]=e[n+m],e[n+m]=i}},st=!1,pt=!1;for(c=Math.floor(s%100/10),q=c>1?Math.min(r,e):r,0!=c&&(st=!0),s%10!=0&&(pt=!0),Q=0,y=Math.min(r-1,e),E=Math.max(0,Math.min(e-2,r)),M=Math.max(y,E),g=0;M>g;g++){for(_=g+1,y>g&&(m[g]=Jmat.Complex(j(r-g,t,g+g*a)),rt(m[g])||(rt(t[g+g*a])||(m[g]=et(m[g],t[g+g*a])),O=Jmat.Complex(1).div(m[g]),ot(r-g,O,t,g+g*a),t[g+g*a]=t[g+g*a].addr(1)),m[g]=m[g].neg()),f=_;e>f;f++)y>g&&(rt(m[g])||(O=it(r-g,t,g+g*a,t,g+f*a).neg().div(t[g+g*a]),nt(r-g,O,t,g+g*a,t,g+f*a))),n[f]=t[g+f*a].conj();if(st&&y>g)for(p=g;r>p;p++)i[p+g*o]=t[p+g*a];if(E>g){if(n[g]=Jmat.Complex(j(e-g-1,n,_)),rt(n[g])||(rt(n[_])||(n[g]=et(n[g],n[_])),O=Jmat.Complex(1).div(n[g]),ot(e-g-1,O,n,_),n[_]=Jmat.Complex(1).add(n[_])),n[g]=n[g].conj().neg(),r>_&&!rt(n[g])){for(f=_;r>f;f++)J[f]=Jmat.Complex(0);for(f=_;e>f;f++)nt(r-g-1,n[f],t,_+f*a,J,_);for(f=_;e>f;f++)nt(r-g-1,n[f].neg().div(n[_]).conj(),J,_,t,_+f*a)}if(pt)for(p=_;e>p;p++)l[p+g*u]=n[p]}}if(w=Math.min(e,r+1),e>y&&(m[y]=t[y+y*a]),w>r&&(m[w-1]=Jmat.Complex(0)),w>E+1&&(n[E]=t[E+(w-1)*a]),n[w-1]=Jmat.Complex(0),st){for(f=y;q>f;f++){for(p=0;r>p;p++)i[p+f*o]=Jmat.Complex(0);i[f+f*o]=Jmat.Complex(1)}for(h=0;y>h;h++)if(g=y-h-1,0==at(m[g])){for(p=0;r>p;p++)i[p+g*o]=Jmat.Complex(0);i[g+g*o]=Jmat.Complex(1)}else{for(_=g+1,f=_;q>f;f++)O=it(r-g,i,g+g*o,i,g+f*o).neg().div(i[g+g*o]),nt(r-g,O,i,g+g*o,i,g+f*o);for(ot(r-g,Jmat.Complex(-1),i,g+g*o),i[g+g*o]=i[g+g*o].inc(),p=0;g>p;p++)i[p+g*o]=Jmat.Complex(0)}}if(pt)for(h=0;e>h;h++){if(g=e-h-1,_=g+1,E>g&&!rt(n[g]))for(f=_;e>f;f++)O=it(e-_,l,_+g*u,l,_+f*u).neg().div(l[_+g*u]),nt(e-_,O,l,_+g*u,l,_+f*u);for(p=0;e>p;p++)l[p+g*u]=Jmat.Complex(0);l[g+g*u]=Jmat.Complex(1)}for(p=0;w>p&&(rt(m[p])||(O=Jmat.Complex.abs(m[p]),S=m[p].div(O),m[p]=O,w>p+1&&(n[p]=n[p].div(S)),st&&ot(r,S,i,p*o)),p+1!=w);p++)rt(n[p])||(O=Jmat.Complex.abs(n[p]),S=O.div(n[p]),n[p]=O,m[p+1]=m[p+1].mul(S),pt&&ot(e,S,l,(p+1)*u));for(B=w,x=0;0!=w;){if(x>=$){Q=w;break}for(h=1;w>=h&&(g=w-h,0!=g);h++)if(U=m[g-1].abs()+m[g].abs(),K=U+n[g-1].abs(),K==U){n[g-1]=Jmat.Complex(0);break}if(g==w-1)d=4;else{for(_=g+1,N=w+1,I=_;N>=I&&(b=w-I+_,b!=g);I++)if(U=0,b!=w&&(U+=n[b-1].abs()),b!=g+1&&(U+=n[b-2].abs()),K=U+m[b-1].abs(),K==U){m[b-1]=Jmat.Complex(0);break}b==g?d=3:b==w?d=1:(d=2,g=b)}if(g++,1==d)for(R=w-1,k=tt(n[w-2]),n[w-2]=Jmat.Complex(0),v=g;R>=v;v++)C=R-v+g,W=tt(m[C-1]),X=lt(W,k),W=X[0],k=X[1],T=X[2],H=X[3],m[C-1]=Jmat.Complex(W),C!=g&&(k=-H*tt(n[C-2]),n[C-2]=n[C-2].mulr(T)),pt&&ut(e,l,(C-1)*u,l,(w-1)*u,T,H);else if(2==d)for(k=tt(n[g-2]),n[g-2]=Jmat.Complex(0),C=g;w>=C;C++)W=tt(m[C-1]),X=lt(W,k),W=X[0],k=X[1],T=X[2],H=X[3],m[C-1]=Jmat.Complex(W),k=-H*tt(n[C-1]),n[C-1]=n[C-1].mulr(T),st&&ut(r,i,(C-1)*o,i,(g-2)*o,T,H);else if(3==d){for(D=Math.max(Math.max(Math.max(Math.max(m[w-1].abs(),m[w-2].abs()),n[w-2].abs()),m[g-1].abs()),n[g-1].abs()),V=tt(m[w-1])/D,L=tt(m[w-2])/D,F=tt(n[w-2])/D,G=tt(m[g-1])/D,z=tt(n[g-1])/D,P=((L+V)*(L-V)+F*F)/2,A=V*F*V*F,Y=0,(0!=P||0!=A)&&(Y=Math.sqrt(P*P+A),0>P&&(Y=-Y),Y=A/(P+Y)),k=(G+V)*(G-V)+Y,Z=G*z,R=w-1,C=g;R>=C;C++)X=lt(k,Z),k=X[0],Z=X[1],T=X[2],H=X[3],C!=g&&(n[C-2]=Jmat.Complex(k)),k=T*tt(m[C-1])+H*tt(n[C-1]),n[C-1]=n[C-1].mulr(T).sub(m[C-1].mulr(H)),Z=H*tt(m[C]),m[C]=m[C].mulr(T),pt&&ut(e,l,(C-1)*u,l,C*u,T,H),X=lt(k,Z),k=X[0],Z=X[1],T=X[2],H=X[3],m[C-1]=Jmat.Complex(k),k=T*tt(n[C-1])+H*tt(m[C]),m[C]=n[C-1].mulr(-H).add(m[C].mulr(T)),Z=H*tt(n[C]),n[C]=n[C].mulr(T),st&&r>C&&ut(r,i,(C-1)*o,i,C*o,T,H);n[w-2]=Jmat.Complex(k),x++}else if(4==d){for(tt(m[g-1])<0&&(m[g-1]=m[g-1].neg(),pt&&ot(e,Jmat.Complex(-1),l,(g-1)*u));g!=B&&!(tt(m[g])<=tt(m[g-1]));)O=m[g-1],m[g-1]=m[g],m[g]=O,pt&&e>g&&Jt(e,l,(g-1)*u,l,g*u),st&&r>g&&Jt(r,i,(g-1)*o,i,g*o),g++;x=0,w--}}return Q},Jmat.Matrix.svd=function(t){for(var a=[],r=0;r<t.h;r++)for(var e=0;e<t.w;e++)a[r+e*t.h]=t.e[r][e];var m=[],n=[],i=[],o=[];Jmat.Matrix.zsvdc_(a,t.h,t.h,t.w,m,o,n,t.h,i,t.w,[],11);for(var l=1e-15,u=0;u<m.length;u++)Math.abs(m[u])<l&&(m[u]=0);for(var J={u:new Jmat.Matrix(t.h,t.h),s:new Jmat.Matrix(t.h,t.w),v:new Jmat.Matrix(t.w,t.w)},r=0;r<t.h;r++)for(var e=0;e<t.h;e++)J.u.e[r][e]=n[r+e*t.h];for(var r=0;r<t.h;r++)for(var e=0;e<t.w;e++)J.s.e[r][e]=e==r?Jmat.Complex(m[e]):Jmat.Complex(0);for(var r=0;r<t.w;r++)for(var e=0;e<t.w;e++)J.v.e[r][e]=i[r+e*t.w];return J},Jmat.Matrix.eq=function(t,a){if(t.w!=a.w||t.h!=a.h)return!1;for(var r=0;r<t.h;r++)for(var e=0;e<t.w;e++)if(!t.e[r][e].eq(a.e[r][e]))return!1;return!0},Jmat.Matrix.near=function(t,a,r){if(t.w!=a.w||t.h!=a.h)return!1;for(var e=0;e<t.h;e++)for(var m=0;m<t.w;m++){var n=t.e[e][m],i=a.e[e][m];if(!Jmat.Complex.near(n,i,r))return!1}return!0},Jmat.Matrix.relnear=function(t,a,r){if(t.w!=a.w||t.h!=a.h)return!1;for(var e=0;e<t.h;e++)for(var m=0;m<t.w;m++){var n=t.e[e][m],i=a.e[e][m];if(!Jmat.Complex.relnear(n,i,r))return!1}return!0},Jmat.Matrix.solve=function(t,a,r){var e=Jmat.Matrix;if(t.h!=a.h)return void 0;var m=void 0==r?1e-12:r;if(e.isZero(a)){var n=e.svd(t);return Jmat.Complex.nearr(n.s.e[n.s.h-1][n.s.h-1],0,m)?e.col(n.v,t.w-1):null}var i=e.doolittle_lup_(t);if(!i)return null;for(var o=i[0],l=i[1],u=o.h,J=e(u,1),s=0;u>s;s++){if(l[s]!=s){var p=a.e[s][0];a.e[s][0]=a.e[l[s]][0],a.e[l[s]][0]=p}J.e[s][0]=a.e[s][0];for(var x=0;s>x;x++)J.e[s][0]=J.e[s][0].sub(J.e[x][0].mul(o.e[s][x]))}for(var s=u-1;s>=0;s--){if(l[s]!=s){var p=a.e[s][0];a.e[s][0]=a.e[l[s]][0],a.e[l[s]][0]=p}for(var x=s+1;u>x;x++)J.e[s][0]=J.e[s][0].sub(J.e[x][0].mul(o.e[s][x]));o.e[s][s].eqr(0)||(J.e[s][0]=J.e[s][0].div(o.e[s][s]))}return J},Jmat.Matrix.rref=function(t){var a=Jmat.Complex,r=t.h,e=t.w;t=Jmat.Matrix.copy(t);for(var m=function(t,a,r){for(var m=0;e>m;m++){var n=t.e[a][m];t.e[a][m]=t.e[r][m],t.e[r][m]=n}},n=function(t,a,r,m){for(var n=a;e>n;n++)t.e[r][n]=t.e[r][n].mul(m)},i=function(t,a,r,e,m){for(var n=t.e[0].length,i=a;n>i;i++)t.e[m][i]=t.e[m][i].sub(t.e[r][i].mul(e))},o=[],l=0,u=0;e>u;u++){var J=Jmat.Real.argmax(l,r,function(a){return t.e[a][u].abssq()});if(!t.e[J][u].eqr(0)){J!=l&&m(t,l,J),n(t,u,l,t.e[l][u].inv());for(var s=l+1;r>s;s++)t.e[s][u].eqr(0)||(i(t,u+1,l,t.e[s][u],s),t.e[s][u]=a(0));if(o.push(u),l++,l>=r)break}}for(var u=0;u<o.length;u++)for(var p=o[u],x=u-1;x>=0;x--)t.e[x][p].eqr(0)||(i(t,p+1,u,t.e[x][p],x),t.e[x][p]=a(0));return t},Jmat.Matrix.random=function(t,a,r,e,m,n){var i=Jmat.Complex;r=r||a||Math.floor(10*Math.random()+2),a=a||Math.floor(10*Math.random()+2),n=void 0==n?1:n,e=void 0==e?0:e,m=void 0==m?1:m,t=t||{real:!0};for(var o=t.real||t.integer,l=t.integer,u=t.binary,J=t.hermitian,s=function(t){if(n>=1||Math.random()<n){if(u)return i(Math.random()>.5?1:0);var a=t?i(Math.random()*(m-e)+e):i.random(e,m);return l?i(Math.floor(a.re)):a}return i(0)},p=Jmat.Matrix(a,r),x=0;a>x;x++)for(var f=0;r>f;f++)J&&x>f?p.e[x][f]=p.e[f][x].conj():J&&f==x?p.e[x][f]=s(!0):p.e[x][f]=s(o);return p},/*
@license
License of the kiss_ and kf_ functions below (converted from C to JavaScript):
Kiss FFT
Copyright (c) 2003-2010, Mark Borgerding
All rights reserved.
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
* Neither the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
Jmat.Matrix.kiss_fft_state_=function(t,a){this.nfft=t,this.inverse=a,this.factors=[],this.twiddles=[]},Jmat.Matrix.kf_bfly2_=function(t,a,r,e,m){for(var n=0,i=0;m>i;i++){var o=t[a+i+m].mul(e.twiddles[n]);n+=r,t[a+i+m]=t[a+i].sub(o),t[a+i]=t[a+i].add(o)}},Jmat.Matrix.kf_bfly4_=function(t,a,r,e,m){for(var n=[],i=2*m,o=3*m,l=0,u=0,J=0,s=0;m>s;s++)n[0]=t[a+s+m].mul(e.twiddles[l]),n[1]=t[a+s+i].mul(e.twiddles[u]),n[2]=t[a+s+o].mul(e.twiddles[J]),n[5]=t[a+s].sub(n[1]),t[a+s]=t[a+s].add(n[1]),n[3]=n[0].add(n[2]),n[4]=n[0].sub(n[2]),t[a+s+i]=t[a+s].sub(n[3]),l+=r,u+=2*r,J+=3*r,t[a+s]=t[a+s].add(n[3]),e.inverse?(t[a+s+m].re=n[5].re-n[4].im,t[a+s+m].im=n[5].im+n[4].re,t[a+s+o].re=n[5].re+n[4].im,t[a+s+o].im=n[5].im-n[4].re):(t[a+s+m].re=n[5].re+n[4].im,t[a+s+m].im=n[5].im-n[4].re,t[a+s+o].re=n[5].re-n[4].im,t[a+s+o].im=n[5].im+n[4].re)},Jmat.Matrix.kf_bfly3_=function(t,a,r,e,m){for(var n=m,i=2*m,o=0,l=0,u=[],J=e.twiddles[r*m],s=0;n>s;s++)u[1]=t[a+s+m].mul(e.twiddles[o]),u[2]=t[a+s+i].mul(e.twiddles[l]),u[3]=u[1].add(u[2]),u[0]=u[1].sub(u[2]),o+=r,l+=2*r,t[a+s+m].re=t[a+s].re-u[3].re/2,t[a+s+m].im=t[a+s].im-u[3].im/2,u[0]=u[0].mulr(J.im),t[a+s]=t[a+s].add(u[3]),t[a+s+i].re=t[a+s+m].re+u[0].im,t[a+s+i].im=t[a+s+m].im-u[0].re,t[a+s+m].re-=u[0].im,t[a+s+m].im+=u[0].re},Jmat.Matrix.kf_bfly5_=function(t,a,r,e,m){for(var n=[],i=e.twiddles[r*m],o=e.twiddles[2*r*m],l=2*m,u=3*m,J=4*m,s=0;m>s;++s)n[0]=Jmat.Complex(t[a+s]),n[1]=t[a+m+s].mul(e.twiddles[s*r]),n[2]=t[a+l+s].mul(e.twiddles[2*s*r]),n[3]=t[a+u+s].mul(e.twiddles[3*s*r]),n[4]=t[a+J+s].mul(e.twiddles[4*s*r]),n[7]=n[1].add(n[4]),n[10]=n[1].sub(n[4]),n[8]=n[2].add(n[3]),n[9]=n[2].sub(n[3]),t[a+s].re+=n[7].re+n[8].re,t[a+s].im+=n[7].im+n[8].im,n[5]=Jmat.Complex(0),n[5].re=n[0].re+n[7].re*i.re+n[8].re*o.re,n[5].im=n[0].im+n[7].im*i.re+n[8].im*o.re,n[6]=Jmat.Complex(0),n[6].re=n[10].im*i.im+n[9].im*o.im,n[6].im=-n[10].re*i.im-n[9].re*o.im,t[a+m+s]=n[5].sub(n[6]),t[a+J+s]=n[5].add(n[6]),n[11]=Jmat.Complex(0),n[11].re=n[0].re+n[7].re*o.re+n[8].re*i.re,n[11].im=n[0].im+n[7].im*o.re+n[8].im*i.re,n[12]=Jmat.Complex(0),n[12].re=-n[10].im*o.im+n[9].im*i.im,n[12].im=n[10].re*o.im-n[9].re*i.im,t[a+l+s]=n[11].add(n[12]),t[a+u+s]=n[11].sub(n[12])},Jmat.Matrix.kf_bfly_generic_=function(t,a,r,e,m,n){var i,o,l,u,J,s=e.nfft,p=[];for(i=0;m>i;++i){for(o=i,l=0;n>l;++l)p[l]=Jmat.Complex(t[a+o]),o+=m;for(o=i,l=0;n>l;++l){var x=0;for(t[a+o]=p[0],u=1;n>u;++u)x+=r*o,x>=s&&(x-=s),J=p[u].mul(e.twiddles[x]),t[a+o]=t[a+o].add(J);o+=m}}},Jmat.Matrix.kf_work_=function(t,a,r,e,m,n,i,o,l){var u=i[o+0],J=i[o+1],s=0;if(1==J)for(var p=0;u*J>p;p++)t[p+a]=Jmat.Complex(r[e+s]),s+=m*n;else for(var p=0;u*J>p;p+=J)Jmat.Matrix.kf_work_(t,a+p,r,e+s,m*u,n,i,o+2,l),s+=m*n;switch(u){case 2:Jmat.Matrix.kf_bfly2_(t,a,m,l,J);break;case 3:Jmat.Matrix.kf_bfly3_(t,a,m,l,J);break;case 4:Jmat.Matrix.kf_bfly4_(t,a,m,l,J);break;case 5:Jmat.Matrix.kf_bfly5_(t,a,m,l,J);break;default:Jmat.Matrix.kf_bfly_generic_(t,a,m,l,J,u)}},Jmat.Matrix.kf_factor_=function(t,a){var r=0,e=4,m=Math.floor(Math.sqrt(t));do{for(;t%e!=0;){switch(e){case 4:e=2;break;case 2:e=3;break;default:e+=2}e>m&&(e=t)}t=Math.floor(t/e),a[r+0]=e,a[r+1]=t,r+=2}while(t>1)},Jmat.Matrix.kiss_fft_alloc_=function(t,a){for(var r=new Jmat.Matrix.kiss_fft_state_(t,a),e=0;t>e;++e){var m=2*-Math.PI*e/t;r.inverse&&(m*=-1),r.twiddles[e]=new Jmat.Complex(Math.cos(m),Math.sin(m))}return Jmat.Matrix.kf_factor_(t,r.factors),r},Jmat.Matrix.kiss_fft_=function(t,a,r){Jmat.Matrix.kf_work_(r,0,a,0,1,1,t.factors,0,t)},Jmat.Matrix.matrixfft_=function(t,a){var r=new Jmat.Matrix(t.h,t.w);if(t.w>1)for(var e=0;e<t.h;e++){for(var m=[],n=0;n<t.w;n++)m[n]=Jmat.Complex(0);var i=Jmat.Matrix.kiss_fft_alloc_(t.w,a);Jmat.Matrix.kiss_fft_(i,t.e[e],m);for(var n=0;n<t.w;n++)r.e[e][n]=m[n]}else r=t;var o=new Jmat.Matrix(t.h,t.w);if(t.h>1)for(var e=0;e<t.w;e++){for(var l=Jmat.Matrix.transpose(Jmat.Matrix.col(r,e)),m=[],n=0;n<t.h;n++)m[n]=Jmat.Complex(0);var i=Jmat.Matrix.kiss_fft_alloc_(t.h,a);Jmat.Matrix.kiss_fft_(i,l.e[0],m);for(var n=0;n<t.h;n++)o.e[n][e]=m[n]}else o=r;var u=1/Math.sqrt(t.w*t.h);return o=Jmat.Matrix.mulr(o,u)},Jmat.Matrix.fft=function(t){return Jmat.Matrix.matrixfft_(t,0)},Jmat.Matrix.ifft=function(t){return Jmat.Matrix.matrixfft_(t,1)},Jmat.Matrix.exp=function(t){if(t.h!=t.w)return null;for(var a=t.add(Jmat.Matrix.identity(t.w,t.w)),r=t,e=1,m=2;20>=m;m++)e*=m,r=r.mul(t),a=a.add(r.mulr(1/e));return a},Jmat.Matrix.cos=function(t){if(t.h!=t.w)return null;for(var a=Jmat.Matrix.identity(t.w,t.w),r=t.mul(t),e=null,m=1,n=1,i=0;20>i;i++)0==i?m=2:m*=(2*i+1)*(2*i+2),n=-n,e=null==e?r:e.mul(r),a=a.add(e.mulr(n/m));return a},Jmat.Matrix.sin=function(t){if(t.h!=t.w)return null;for(var a=t,r=t.mul(t),e=t,m=1,n=1,i=0;20>i;i++)m*=(2*i+2)*(2*i+3),n=-n,e=e.mul(r),a=a.add(e.mulr(n/m));return a},Jmat.Matrix.sqrt=function(t){if(t.h!=t.w)return null;for(var a=Jmat.Matrix.evd(t),r=a.v,e=a.d,m=0;m<e.w;m++)e.e[m][m]=Jmat.Complex.sqrt(e.e[m][m]);return r.mul(e).mul(Jmat.Matrix.inv(r))},Jmat.Matrix.log=function(t){if(t.h!=t.w)return null;for(var a=Jmat.Matrix.evd(t),r=a.v,e=a.d,m=0;m<e.w;m++)e.e[m][m]=Jmat.Complex.log(e.e[m][m]);return r.mul(e).mul(Jmat.Matrix.inv(r))},Jmat.Matrix.powc=function(t,a){if(t.h!=t.w)return null;for(var r=Jmat.Matrix.evd(t),e=r.v,m=r.d,n=0;n<m.w;n++)m.e[n][n]=m.e[n][n].pow(a);return e.mul(m).mul(Jmat.Matrix.inv(e))},Jmat.Quaternion=function(t,a,r,e){return this instanceof Jmat.Quaternion?(this.w=t,this.x=a,this.y=r,this.z=e,void 0):Jmat.Quaternion.make(t,a,r,e)},Jmat.Quaternion.make=function(t,a,r,e){return void 0==t?new Jmat.Quaternion(0,0,0,0):"number"==typeof t?new Jmat.Quaternion(t,a||0,r||0,e||0):"string"==typeof t?Jmat.Quaternion.parse(t):void 0!=t.re?new Jmat.Quaternion(t.re,t.im||0,a&&a.re||0,a&&a.im||0):t.e&&2==t.w&&2==t.h?Jmat.Quaternion.from2x2(t):t.e&&4==t.w&&4==t.h?Jmat.Quaternion.from4x4(t):Jmat.Quaternion.copy(t)},Jmat.Quaternion.cast=function(t){return t&&void 0!=t.w?t:void 0==t?Jmat.Quaternion(0):Jmat.Quaternion(t)},Jmat.Quaternion.copy=function(t){return new Jmat.Quaternion(t.w,t.x,t.y,t.z)},Jmat.Quaternion.toString=function(t,a){if(!t)return 0==t?"invalid0":""+t;var r=a?Jmat.Complex.formatFloat_(t.w,a):""+t.w,e=a?Jmat.Complex.formatFloat_(t.x,a):""+t.x,m=a?Jmat.Complex.formatFloat_(t.x,a):""+t.y,n=a?Jmat.Complex.formatFloat_(t.x,a):""+t.z,i="";return 0!=t.w&&(i+=r),0!=t.x&&(i+=(0==i.length||t.x<0?e:"+"+e)+"i"),0!=t.y&&(i+=(0==i.length||t.y<0?m:"+"+m)+"j"),0!=t.z&&(i+=(0==i.length||t.z<0?n:"+"+n)+"k"),i},Jmat.Quaternion.prototype.toString=function(t){return Jmat.Quaternion.toString(this,t)},Jmat.Quaternion.parse=function(t){t=t.replace(/ /g,"");for(var a=t.split(/\b/),r=[],e=!1,m=0;m<a.length;m++){var n=a[m];0!=m&&(e||"-"!=n[0]&&"+"!=n[0])||r.push(""),r[r.length-1]+=n,e="e"==n[n.length-1]||"E"==n[n.length-1]}for(var i=0,o=0,l=0,u=0,m=0;m<r.length;m++){var n=r[m],J=n[n.length-1];"i"==J||"j"==J||"k"==J?(n=n.substr(0,n.length-1),(""==n||"+"==n)&&(n="1"),"-"==n&&(n="-1"),"i"==J&&(o=parseFloat(n)),"j"==J&&(l=parseFloat(n)),"k"==J&&(u=parseFloat(n))):i=parseFloat(n)}return new Jmat.Quaternion(i,o,l,u)},Jmat.Quaternion.add=function(t,a){return new Jmat.Quaternion(t.w+a.w,t.x+a.x,t.y+a.y,t.z+a.z)},Jmat.Quaternion.prototype.add=function(t){return new Jmat.Quaternion(this.w+t.w,this.x+t.x,this.y+t.y,this.z+t.z)},Jmat.Quaternion.sub=function(t,a){return new Jmat.Quaternion(t.w-a.w,t.x-a.x,t.y-a.y,t.z-a.z)},Jmat.Quaternion.prototype.sub=function(t){return new Jmat.Quaternion(this.w-t.w,this.x-t.x,this.y-t.y,this.z-t.z)},Jmat.Quaternion.mul=function(t,a){var r=t.w*a.w-t.x*a.x-t.y*a.y-t.z*a.z,e=t.w*a.x+t.x*a.w+t.y*a.z-t.z*a.y,m=t.w*a.y-t.x*a.z+t.y*a.w+t.z*a.x,n=t.w*a.z+t.x*a.y-t.y*a.x+t.z*a.w;return new Jmat.Quaternion(r,e,m,n)},Jmat.Quaternion.prototype.mul=function(t){return Jmat.Quaternion.mul(this,t)},Jmat.Quaternion.mulr=function(t,a){return new Jmat.Quaternion(t.w*a,t.x*a,t.y*a,t.z*a)},Jmat.Quaternion.prototype.mulr=function(t){return new Jmat.Quaternion(this.w*t,this.x*t,this.y*t,this.z*t)},Jmat.Quaternion.divr=function(t,a){return new Jmat.Quaternion(t.w/a,t.x/a,t.y/a,t.z/a)},Jmat.Quaternion.prototype.divr=function(t){return new Jmat.Quaternion(this.w/t,this.x/t,this.y/t,this.z/t)},Jmat.Quaternion.addr=function(t,a){return new Jmat.Quaternion(t.w+a,t.x,t.y,t.z)},Jmat.Quaternion.prototype.addr=function(t){return new Jmat.Quaternion(this.w+t,this.x,this.y,this.z)},Jmat.Quaternion.subr=function(t,a){return new Jmat.Quaternion(t.w-a,t.x,t.y,t.z)},Jmat.Quaternion.prototype.subr=function(t){return new Jmat.Quaternion(this.w-t,this.x,this.y,this.z)},Jmat.Quaternion.rsub=function(t,a){return new Jmat.Quaternion(a-t.w,-t.x,-t.y,-t.z)},Jmat.Quaternion.prototype.rsub=function(t){return new Jmat.Quaternion(t-this.w,-this.x,-this.y,-this.z)},Jmat.Quaternion.neg=function(t){return Jmat.Quaternion(-t.w,-t.x,-t.y,-t.z)},Jmat.Quaternion.prototype.neg=function(){return Jmat.Quaternion(-this.w,-this.x,-this.y,-this.z)},Jmat.Quaternion.conj=function(t){return Jmat.Quaternion(t.w,-t.x,-t.y,-t.z)},Jmat.Quaternion.prototype.conj=function(){return Jmat.Quaternion(this.w,-this.x,-this.y,-this.z)},Jmat.Quaternion.abs=function(t){return Jmat.Quaternion(t.abs())},Jmat.Quaternion.prototype.abs=function(){return Math.sqrt(this.abssq())},Jmat.Quaternion.abssq=function(t){return Jmat.Quaternion(t.abssq())},Jmat.Quaternion.prototype.abssq=function(){return this.w==-(1/0)||this.x==-(1/0)||this.y==-(1/0)||this.z==-(1/0)?1/0:this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z},Jmat.Quaternion.absv=function(t){return Jmat.Quaternion(t.absv())},Jmat.Quaternion.prototype.absv=function(){return Math.sqrt(this.absvsq())},Jmat.Quaternion.absvsq=function(t){return Jmat.Quaternion(t.abssq())},Jmat.Quaternion.prototype.absvsq=function(){return this.x==-(1/0)||this.y==-(1/0)||this.z==-(1/0)?1/0:this.x*this.x+this.y*this.y+this.z*this.z},Jmat.Quaternion.arg=function(t){return Jmat.Quaternion(t.arg())},Jmat.Quaternion.prototype.arg=function(){return Math.atan2(this.absv(),this.w)},Jmat.Quaternion.inv=function(t){return t.conj().divr(t.abssq())},Jmat.Quaternion.prototype.inv=function(){return this.conj().divr(this.abssq())},Jmat.Quaternion.div=function(t,a){return t.mul(a.inv())},Jmat.Quaternion.prototype.div=function(t){return this.mul(t.inv())},Jmat.Quaternion.leftdiv=function(t,a){return t.inv().mul(a)},Jmat.Quaternion.prototype.leftdiv=function(t){return this.inv().mul(t)},Jmat.Quaternion.sign=function(t){var a=t.abs();return 0==a?t:t.divr(a)},Jmat.Quaternion.normalize=Jmat.Quaternion.sign,Jmat.Quaternion.prototype.normalize=function(){return Jmat.Quaternion.sign(this)},Jmat.Quaternion.to2x2=function(t){var a=Jmat.Complex;return[[a(t.w,t.x),a(t.y,t.z)],[a(-t.y,t.z),a(t.w,-t.x)]]},Jmat.Quaternion.from2x2=function(t){var a=t.e?t.e:t,r=a[0][0],e=a[0][1];return new Jmat.Quaternion(r.re,r.im,e.re,e.im)},Jmat.Quaternion.to4x4=function(t){return[[t.w,t.x,t.y,t.z],[-t.x,t.w,-t.z,t.y],[-t.y,t.z,t.w,-t.x],[-t.z,-t.y,t.x,t.w]]},Jmat.Quaternion.from4x4=function(t){var a=t.e?t.e:t;return new Jmat.Quaternion(a[0][0].re,a[0][1].re,a[0][2].re,a[0][3].re)},Jmat.Quaternion.to3x3rot=function(t){var a=t.w*t.w,r=t.x*t.x,e=t.y*t.y,m=t.z*t.z;return[[a+r-e-m,2*t.x*t.y-2*t.w*t.z,2*t.x*t.z+2*t.w*t.y],[2*t.x*t.y+2*t.w*t.z,a-r+e-m,2*t.y*t.z-2*t.w*t.x],[2*t.x*t.z-2*t.w*t.y,2*t.y*t.z+2*t.w*t.x,a-r-e+m]]},Jmat.Quaternion.from3x3rot=function(t){var a=t.e?t.e:t,r=1+a[0][0].re+a[1][1].re+a[2][2].re;if(r>1e-7){var e=2*Math.sqrt(r);return new Jmat.Quaternion(.25*e,(a[2][1].re-a[1][2].re)/e,(a[0][2].re-a[2][0].re)/e,(a[1][0].re-a[0][1].re)/e)}if(a[0][0].re>a[1][1].re&&a[0][0].re>a[2][2].re){var e=2*Math.sqrt(1+a[0][0].re-a[1][1].re-a[2][2].re);return new Jmat.Quaternion((a[2][1].re-a[1][2].re)/e,.25*e,(a[1][0].re+a[0][1].re)/e,(a[0][2].re-a[2][0].re)/e)}if(a[1][1].re>a[2][2].re){var e=2*Math.sqrt(1+a[1][1].re-a[0][0].re-a[2][2].re);return new Jmat.Quaternion((a[0][2].re-a[2][0].re)/e,(a[1][0].re+a[0][1].re)/e,.25*e,(a[2][1].re+a[1][2].re)/e)}var e=2*Math.sqrt(1+a[2][2].re-a[0][0].re-a[1][1].re);return new Jmat.Quaternion((a[1][0].re-a[0][1].re)/e,(a[0][2].re+a[2][0].re)/e,(a[2][1].re+a[1][2].re)/e,.5*e)},Jmat.Quaternion.prototype.getVector=function(){return[[this.x],[this.y],[this.z]]},Jmat.Quaternion.prototype.qvector=function(){return new Jmat.Quaternion(0,this.x,this.y,this.z)},Jmat.Quaternion.exp=function(t){var a=Math.exp(t.w),r=t.absv(),e=Math.cos(r),m=Math.sin(r),n=a*m/r;return new Jmat.Quaternion(a*e,n*t.x,n*t.y,n*t.z)},Jmat.Quaternion.log=function(t){var a=t.abs(),r=t.absv();if(0==r)return new Jmat.Quaternion(Math.log(t.w),0,0,0);var e=Math.acos(t.w/a),m=e/r;return new Jmat.Quaternion(Math.log(a),m*t.x,m*t.y,m*t.z)},Jmat.Quaternion.logy=function(t,a){return Jmat.Quaternion.log(t).div(Jmat.Quaternion.log(a))},Jmat.Quaternion.logr=function(t,a){return Jmat.Quaternion.log(t).divr(Math.log(a))},Jmat.Quaternion.log2=function(t){return Jmat.Quaternion.log(t).divr(Math.LN2)},Jmat.Quaternion.log10=function(t){return Jmat.Quaternion.log(t).divr(Math.LN10)},Jmat.Quaternion.pow=function(t,a){var r=Jmat.Quaternion;return r.exp(r.log(t).mul(a))},Jmat.Quaternion.prototype.pow=function(t){return Jmat.Quaternion.pow(this,t)},Jmat.Quaternion.powr=function(t,a){var r=Jmat.Quaternion;return r.exp(r.log(t).mulr(a))},Jmat.Quaternion.prototype.powr=function(t){return Jmat.Quaternion.powr(this,t)},Jmat.Quaternion.sqrt=function(t){return t.powr(.5)},Jmat.Quaternion.eq=function(t,a){return t&&a?t.w==a.w&&t.x==a.x&&t.y==a.y&&t.z==a.z:t==a},Jmat.Quaternion.prototype.eq=function(t){return t&&this.w==t.w&&this.x==t.x&&this.y==t.y&&this.z==t.z},Jmat.Quaternion.eqr=function(t,a){return t&&a?t.w==a&&0==t.x&&0==t.y&&0==t.z:t==a},Jmat.Quaternion.prototype.eqr=function(t){return this.w==t&&0==this.x&&0==this.y&&0==this.z},Jmat.Quaternion.near=function(t,a,r){return t.w-r<=a.w&&t.w+r>=a.w&&t.x-r<=a.x&&t.x+r>=a.x&&t.y-r<=a.y&&t.x+r>=a.y&&t.z-r<=a.z&&t.x+r>=a.z},Jmat.Quaternion.relnear=function(t,a,r){return t.eq(a)?!0:t.sub(a).abs()<Math.max(t.abs(),a.abs())*r},Jmat.Quaternion.ONE=new Jmat.Quaternion(1,0,0,0),Jmat.Quaternion.I=new Jmat.Quaternion(0,1,0,0),Jmat.Quaternion.J=new Jmat.Quaternion(0,0,1,0),Jmat.Quaternion.K=new Jmat.Quaternion(0,0,0,1),Jmat.Quaternion.sin=function(t){var a=t.absv(),r=Math.sin(t.w)*Jmat.Real.cosh(a),e=Math.cos(t.w)*Jmat.Real.sinh(a);return new Jmat.Quaternion(r,e*t.x/a,e*t.y/a,e*t.z/a)},Jmat.Quaternion.cos=function(t){var a=t.absv();if(0==a)return Jmat.Quaternion(Math.cos(t.w),0,0,0);var r=Math.cos(t.w)*Jmat.Real.cosh(a),e=Math.sin(t.w)*Jmat.Real.sinh(a);return new Jmat.Quaternion(r,-e*t.x/a,-e*t.y/a,-e*t.z/a)},Jmat.Quaternion.tan=function(t){var a=Jmat.Quaternion;return a.sin(t).div(a.cos(t))},Jmat.Quaternion.asin=function(t){var a=0==t.absvsq()?Jmat.Quaternion.I:t.qvector().divr(t.absv());return a.mul(Jmat.Quaternion.asinh(t.mul(a))).neg()},Jmat.Quaternion.acos=function(t){var a=0==t.absvsq()?Jmat.Quaternion.I:t.qvector().divr(t.absv());return a.mul(Jmat.Quaternion.acosh(t)).neg()},Jmat.Quaternion.atan=function(t){var a=0==t.absvsq()?Jmat.Quaternion.I:t.qvector().divr(t.absv());return a.conj().mul(Jmat.Quaternion.atanh(t.mul(a)))},Jmat.Quaternion.sinh=function(t){var a=Jmat.Quaternion.exp(t),r=Jmat.Quaternion.inv(a);return a.sub(r).divr(2)},Jmat.Quaternion.cosh=function(t){var a=Jmat.Quaternion.exp(t),r=Jmat.Quaternion.inv(a);return a.add(r).divr(2)},Jmat.Quaternion.tanh=function(t){var a=Jmat.Quaternion.exp(t),r=Jmat.Quaternion.inv(a);return a.sub(r).div(a.add(r))},Jmat.Quaternion.asinh=function(t){return Jmat.Quaternion.log(t.add(Jmat.Quaternion.sqrt(t.mul(t).addr(1))))},Jmat.Quaternion.acosh=function(t){return Jmat.Quaternion.log(t.add(Jmat.Quaternion.sqrt(t.subr(1)).mul(Jmat.Quaternion.sqrt(t.addr(1)))))},Jmat.Quaternion.atanh=function(t){return Jmat.Quaternion.log(t.addr(1).div(t.rsub(1))).mulr(.5)},Jmat.Quaternion.isReal=function(t){return 0==t.x&&0==t.y&&0==t.z},Jmat.Quaternion.isNaN=function(t){return isNaN(t.w)||isNaN(t.x)||isNaN(t.y)||isNaN(t.z)},Jmat.Quaternion.isInf=function(t){return Math.abs(t.w)==1/0||Math.abs(t.x)==1/0||Math.abs(t.y)==1/0||Math.abs(t.z)==1/0},Jmat.Quaternion.isInfOrNaN=function(t){return!t||Jmat.Quaternion.isNaN(t)||Jmat.Quaternion.isInf(t)},Jmat.Quaternion.lambertwb=function(t,a){return Jmat.Complex.lambertwb_generic_(Jmat.Quaternion,t,a)},Jmat.Quaternion.lambertw=function(t){return Jmat.Quaternion.lambertwb(0,t)},Jmat.Quaternion.lambertwm=function(t){return Jmat.Quaternion.lambertwb(-1,t)},Jmat.Real.tetration=function(t,a){if(0==a)return 1;if(1==a)return t;if(2==a)return Math.pow(t,t);if(t>=2&&a>5)return 1/0;if(0==t&&Jmat.Real.isPositiveInt(a))return Jmat.Complex.isEven(a)?1:0;if(a==1/0&&t>0){var r=Math.log(t);return Jmat.Real.lambertw(-r)/-r}var e=function(t,a,r,e){for(var m,n=a,i=0;r>i;i++){if(n=e?Jmat.Real.logy(n,t):Math.pow(t,n),isNaN(n))return n;if(n==1/0)return n;if(n==m)return n;if(m=n,i>1e3)return NaN}return n};if(Jmat.Real.isPositiveInt(a))return e(t,t,a-1,!1);if(a>-1&&0>=a)return 1+a;if(a>0){var m=a-Math.floor(a);return e(t,m,Math.ceil(a),!1)}if(-1>=a){var m=a-Math.floor(a);return e(t,m,-Math.ceil(a),!0)}return NaN},Jmat.Real.minkowski=function(t){if(t!=t)return NaN;var a,r,e=Math.floor(t),m=1,n=e+1,i=1,o=1,l=e;if(e>t||0>e!=0>=n)return t;for(;(o/=2,l+o!=l)&&(a=e+n,0>a==0>e)&&(r=m+i,!(0>r));)a/r>t?(n=a,i=r):(l+=o,e=a,m=r);return l+o},Jmat.Complex.loggamma=function(t){if(t.re<0){if(0==t.im&&t.re==Math.floor(t.re))return Jmat.Complex(NaN);var a=Jmat.Complex.log(Jmat.Complex.PI.div(Jmat.Complex.sin(Jmat.Complex.PI.mul(t))));return Jmat.Complex.isInfOrNaN(a)&&(a=Jmat.Complex.log(Jmat.Complex.newi(2*Math.PI)).sub(Jmat.Complex.newi(-Math.PI).mul(t.im>0?t:t.neg()))),a.sub(Jmat.Complex.loggamma(Jmat.Complex.ONE.sub(t)))}if(t.im<1&&t.im>-1&&t.re<1&&t.re>=0)return Jmat.Complex.log(Jmat.Complex.gamma(t));var r=Jmat.Complex(.918938533205);return r=r.add(Jmat.Complex.subr(t,.5).mul(Jmat.Complex.log(t))),r=r.sub(t),r=r.add(t.mulr(12).inv()),r=r.sub(Jmat.Complex.powr(t,3).mulr(360).inv()),r=r.add(Jmat.Complex.powr(t,5).mulr(1260).inv()),r=r.sub(Jmat.Complex.powr(t,7).mulr(1680).inv()),r=r.add(Jmat.Complex.powr(t,9).mulr(1188).inv())},Jmat.Complex.gamma_inv=function(t){if(Jmat.Complex.isPositive(t)&&a>.85){var a=t.re,r=.036533814484900416,e=Math.log((a+r)/Math.sqrt(2*Math.PI));return Jmat.Complex(e/Jmat.Real.lambertw(e/Math.E)+.5)}var m=Jmat.Complex.finvert_newton(t,Jmat.Complex.gamma,function(t){return Jmat.Complex.gamma(t).mul(Jmat.Complex.digamma(t))});return Jmat.Complex.near(Jmat.Complex.gamma(m),t,.01)?m:Jmat.Complex(NaN)},Jmat.Complex.digamma=function(t){var a=Jmat.Real.frac(t.re);if(.001>a||a>.999||a>.499&&.501>a){if(t.re<-98)return Jmat.Complex.loggamma(t.addr(3e-4)).sub(Jmat.Complex.loggamma(t.addr(1e-4))).divr(2e-4);var r=Jmat.Complex.gamma(t.addr(1e-4)).sub(Jmat.Complex.gamma(t.subr(1e-4))).divr(2e-4).div(Jmat.Complex.gamma(t));return Jmat.Complex.isInfOrNaN(r)&&!Jmat.Complex.isInf(t)&&0!=t.im?Jmat.Complex.loggamma(t.addr(3e-4)).sub(Jmat.Complex.loggamma(t.addr(1e-4))).divr(2e-4):r}return Jmat.Complex.loggamma(t.addr(1e-4)).sub(Jmat.Complex.loggamma(t.subr(1e-4))).divr(2e-4)},Jmat.Complex.trigamma=function(t){var a=Jmat.Real.frac(t.re);if(.001>a||a>.999||a>.499&&.501>a){var r=Jmat.Complex.gamma(t.addr(-2e-4)),e=Jmat.Complex.gamma(t.addr(-1e-4)),m=Jmat.Complex.gamma(t),n=Jmat.Complex.gamma(t.addr(1e-4)),i=Jmat.Complex.gamma(t.addr(2e-4)),o=r.sub(m).divr(2e-4).div(e),l=m.sub(i).divr(2e-4).div(n);return o.sub(l).divr(2e-4)}var r=Jmat.Complex.loggamma(t.addr(-2e-4)),e=Jmat.Complex.loggamma(t),m=Jmat.Complex.loggamma(t.addr(2e-4)),o=r.sub(e).divr(2e-4),l=e.sub(m).divr(2e-4);return o.sub(l).divr(2e-4)},Jmat.Complex.polygamma=function(t,a){if(t.eqr(0))return Jmat.Complex.digamma(a);if(t.eqr(1))return Jmat.Complex.trigamma(a);var r=Jmat.Complex.hurwitzzeta(t.inc(),a);return Jmat.Complex(-1).pow(t.inc()).mul(Jmat.Complex.factorial(t)).mul(r)},Jmat.Complex.incgamma_lower=function(t,a){if(a.re>0){var r=a.pow(t).div(t).mul(Jmat.Complex.hypergeometric1F1(t,t.inc(),a.neg()));if(!Jmat.Complex.isNaN(r))return r}for(var r=Jmat.Complex(0),e=Jmat.Complex(1),m=a.pow(t),n=1,i=a.abs()>5?50:30,o=0;i>o;o++)o>0&&(e/=o,n=-n,m=m.mul(a)),r=r.add(Jmat.Complex(n*e).mul(m).div(t.addr(o)));return r},Jmat.Complex.incgamma_upper=function(t,a){return Jmat.Complex.isNegativeIntOrZero(t)&&(t=t.addr(1e-7)),Jmat.Complex.gamma(t).sub(Jmat.Complex.incgamma_lower(t,a))},Jmat.Complex.gamma_p_cache_=[],Jmat.Complex.gamma_p=function(t,a){if(Jmat.Complex.isNegativeIntOrZero(t))return Jmat.Complex(1);var r=Jmat.Complex.calcCache_(t,Jmat.Complex.gamma,Jmat.Complex.gamma_p_cache_);return Jmat.Complex.incgamma_lower(t,a).div(r)},Jmat.Complex.gamma_q=function(t,a){return Jmat.Complex.isNegativeIntOrZero(t)?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.gamma_p(t,a))},Jmat.Complex.gamma_p_inv_series_1_=function(t,a){var r=t.inc(),e=r.mul(r),m=t.addr(2),n=m.mul(m),i=t.mul(t),o=i.mul(t),l=o.mul(t),u=t.addr(3),J=t.addr(4),s=[0,1];s[2]=t.inc().inv(),s[3]=t.mulr(3).addr(5).div(e.mul(m).mulr(2)),s[4]=i.mulr(8).add(t.mulr(33)).addr(31).div(e.mul(r).mul(m).mul(u).mulr(3)),s[5]=l.mulr(125).add(o.mulr(1179)).add(i.mulr(3971)).add(t.mulr(5661)).addr(2888).div(e.mul(e).mul(n).mul(u).mul(J).mulr(24));var p=a.mul(Jmat.Complex.gamma(r)).pow(t.inv());return Jmat.Complex.powerSeries(s,s.length,Jmat.Complex.ZERO,p)},Jmat.Complex.gamma_p_inv=function(t,a){return!Jmat.Complex.isReal(a)||!Jmat.Complex.isReal(t)||a.re<0||a.re>1||t.re<0?Jmat.Complex(NaN):Jmat.Complex.gamma_p_inv_series_1_(t,a)},Jmat.Complex.gamma_q_inva=function(t,a){return Jmat.Complex.rootfind_bisection(Jmat.Complex(0),Jmat.Complex(100),function(r){return Jmat.Complex.gamma_q(r,a).sub(t)})},Jmat.Complex.gammaDiv_=function(t,a){if(t.eq(a))return Jmat.Complex.ONE;if(Jmat.Complex.isInfOrNaN(t)||Jmat.Complex.isInfOrNaN(a))return Jmat.Complex(NaN);if(Jmat.Complex.isNegativeIntOrZero(a)&&(t.re>0||!Jmat.Complex.isInt(t)))return Jmat.Complex.ZERO;if(Jmat.Complex.isInt(t)&&Jmat.Complex.isInt(a)){if(t.re<=0&&a.re<=0){var r=Jmat.Real.isOdd(t.re-a.re)?-1:1;return Jmat.Complex.gammaDiv_(a.rsub(1),t.rsub(1)).mulr(r)}if(t.re>0&&a.re>0&&Jmat.Real.dist(t.re,a.re)<16){if(t.re>a.re){for(var e=a.re,m=a.re+1;m<t.re;m++)e*=m;return Jmat.Complex(e)}for(var e=1/t.re,m=t.re+1;m<a.re;m++)e/=m;return Jmat.Complex(e)}}return Jmat.Complex.gamma(t).div(Jmat.Complex.gamma(a))},Jmat.Complex.gammaDiv12_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex.isNegativeIntOrZero(r)&&(t.re>0||!Jmat.Complex.isInt(t))?Jmat.Complex.ZERO:Jmat.Complex.gammaDiv_(t,a).div(Jmat.Complex.gamma(r)):Jmat.Complex.gammaDiv_(t,r).div(Jmat.Complex.gamma(a))},Jmat.Complex.gammaDiv21_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(t)?Jmat.Complex.gammaDiv_(t,r).mul(Jmat.Complex.gamma(a)):Jmat.Complex.gammaDiv_(a,r).mul(Jmat.Complex.gamma(t))},Jmat.Complex.gammaDiv22_=function(t,a,r,e){return Jmat.Complex.isNegativeIntOrZero(t)==Jmat.Complex.isNegativeIntOrZero(r)?Jmat.Complex.gammaDiv_(t,r).mul(Jmat.Complex.gammaDiv_(a,e)):Jmat.Complex.gammaDiv_(t,e).mul(Jmat.Complex.gammaDiv_(a,r))},Jmat.Complex.loggammaDiv_=function(t,a){if(t.eq(a))return Jmat.Complex.ZERO;if(Jmat.Complex.isInfOrNaN(t)||Jmat.Complex.isInfOrNaN(a))return Jmat.Complex(NaN);if(Jmat.Complex.isNegativeIntOrZero(a)&&(t.re>0||!Jmat.Complex.isInt(t)))return Jmat.Complex(-(1/0));if(Jmat.Complex.isInt(t)&&Jmat.Complex.isInt(a)&&t.re<=0&&a.re<=0){var r=Jmat.Real.isOdd(t.re-a.re)?-1:1,e=Jmat.Complex.loggammaDiv_(a.rsub(1),t.rsub(1));return-1==r&&(e=e.add(Jmat.Complex.newi(Math.PI))),e}return Jmat.Complex.loggamma(t).sub(Jmat.Complex.loggamma(a))},Jmat.Complex.loggammaDiv12_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex.isNegativeIntOrZero(r)&&(t.re>0||!Jmat.Complex.isInt(t))?Jmat.Complex(-(1/0)):Jmat.Complex.loggammaDiv_(t,a).sub(Jmat.Complex.loggamma(r)):Jmat.Complex.loggammaDiv_(t,r).sub(Jmat.Complex.loggamma(a))},Jmat.Complex.loggammaDiv21_=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(t)?Jmat.Complex.loggammaDiv_(t,r).add(Jmat.Complex.loggamma(a)):Jmat.Complex.loggammaDiv_(a,r).add(Jmat.Complex.loggamma(t))},Jmat.Complex.loggammaDiv2_=function(t,a,r,e){return Jmat.Complex.isNegativeIntOrZero(t)==Jmat.Complex.isNegativeIntOrZero(r)?Jmat.Complex.loggammaDiv_(t,r).add(Jmat.Complex.loggammaDiv_(a,e)):Jmat.Complex.loggammaDiv_(t,e).add(Jmat.Complex.loggammaDiv_(a,r))},Jmat.Complex.agmMulSqrt_=function(t,a){return Jmat.Complex.isPositive(t)&&Jmat.Complex.isPositive(a)?Jmat.Complex.sqrt(t.mul(a)):Jmat.Complex(Math.sqrt(t.mul(a).abs())).mul(Jmat.Complex.exp(Jmat.Complex.I.mulr((t.arg()+a.arg())/2)))},Jmat.Complex.agm=function(t,a){if(t.eq(a.neg())||t.eq(Jmat.Complex.ZERO)||a.eq(Jmat.Complex.ZERO))return Jmat.Complex(0);for(var r,e,m=Jmat.Complex.isReal(t)&&Jmat.Complex.isReal(a)&&t.re<0==a.re<0,n=0;60>n&&!t.eq(a);n++)r=t.add(a).divr(2),e=Jmat.Complex.agmMulSqrt_(t,a),t=r,a=e;return m&&(t.im=0),t},Jmat.Complex.ghm=function(t,a){for(var r,e,m=0;60>m&&!t.eq(a);m++)r=Jmat.Complex.agmMulSqrt_(t,a),e=Jmat.Complex.TWO.div(t.inv().add(a.inv())),t=r,a=e;return t},Jmat.Complex.bessel0big_=function(t){for(var a=Jmat.Complex,r=[-.0703125,.112152099609375,-.5725014209747314,.6074042001273483,-110.0171402692467,303.8090510922384,-118838.4262567832,625295.1493434797,-425939216.5047669,3646840080.706556,-3833534661393.944,48540146868529.01],e=[.0732421875,-.2271080017089844,1.727727502584457,-24.38052969955606,551.3358961220206,-18257.75547429318,832859.3040162893,-50069589.53198893,3836255180.230433,-364901081884.9833,42189715702840.96,-5827244631566907],m=t.abs(),n=m>=50?8:m>=35?10:12,i=a.ONE,o=a(-.125).div(t),l=t.inv(),u=l.mul(l),J=a.ONE,s=0;n>s;s++)J=J.mul(u),i=i.add(J.mulr(r[s])),o=o.add(J.mul(l).mulr(e[s]));var p=a.sqrt(t.mulr(Math.PI/2).inv()),x=t.subr(.25*Math.PI),f=p.mul(i.mul(a.cos(x)).sub(o.mul(a.sin(x)))),c=p.mul(i.mul(a.sin(x)).add(o.mul(a.cos(x))));return[f,c]},Jmat.Complex.besselj0_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(1);if(t.re<0&&(t=t.neg()),t.abs()<12){for(var r=a.ONE,e=a.ONE,m=t.mul(t),n=1;40>=n&&(e=e.mul(m).mulr(-.25/(n*n)),r=r.add(e),!(e.abssq()<1e-30*r.abssq()));n++);return r}return Jmat.Complex.bessel0big_(t)[0]},Jmat.Complex.bessely0_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(-(1/0));var r,e,m=t.re<0;if(m&&(t=t.neg()),t.abs()<12){r=a.besselj0_(t);for(var n=0,i=a.ONE,o=a.ZERO,l=t.mul(t),u=1;40>=u;u++){n+=1/u,i=i.mulr(-.25/(u*u)).mul(l);var J=i.mulr(n);if(o=o.add(J),J.abssq()<1e-30*o.abssq())break}var s=a(2/Math.PI);e=s.mul(a.log(t.divr(2)).add(a.EM)).mul(r).sub(s.mul(o))}else{var p=Jmat.Complex.bessel0big_(t);r=p[0],e=p[1]}return m&&(e=t.im<=0?e.add(a(0,2).mul(r)):e.sub(a(0,2).mul(r))),e},Jmat.Complex.bessel1big_=function(t){for(var a=Jmat.Complex,r=[.1171875,-.144195556640625,.6765925884246826,-6.883914268109947,121.5978918765359,-3302.272294480852,127641.2726461746,-6656367.718817688,450278600.3050393,-38338575207.4279,4011838599133.198,-506056850331472.7],e=[-.1025390625,.2775764465332031,-1.993531733751297,27.24882731126854,-603.8440767050702,19718.37591223663,-890297.8767070678,53104110.10968522,-4043620325.107754,382701134659.8605,-44064814178522.78,6065091351222699],m=t.abs(),n=m>=50?8:m>=35?10:12,i=a.ONE,o=a(.375).div(t),l=t.inv(),u=l.mul(l),J=a.ONE,s=0;n>s;s++)J=J.mul(u),i=i.add(J.mulr(r[s])),o=o.add(J.mul(l).mulr(e[s]));var p=a.sqrt(t.mulr(Math.PI/2).inv()),x=t.subr(.75*Math.PI),f=p.mul(i.mul(a.cos(x)).sub(o.mul(a.sin(x)))),c=p.mul(i.mul(a.sin(x)).add(o.mul(a.cos(x))));return[f,c]},Jmat.Complex.besselj1_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(0);var r,e=t.re<0;if(e&&(t=t.neg()),t.abs()<12){r=a.ONE;for(var m=a.ONE,n=t.mul(t),i=1;40>=i&&(m=m.mul(n).mulr(-.25/(i*(i+1))),r=r.add(m),!(m.abssq()<1e-30*r.abssq()));i++);r=r.mul(t).mulr(.5)}else r=Jmat.Complex.bessel1big_(t)[0];return e&&(r=r.neg()),r},Jmat.Complex.bessely1_=function(t){var a=Jmat.Complex;if(t.eqr(0))return a(-(1/0));var r,e,m=t.re<0;if(m&&(t=t.neg()),t.abs()<12){r=a.besselj1_(t);for(var n=0,i=a.ONE,o=a.ONE,l=t.mul(t),u=1;40>=u;u++){n+=1/u,i=i.mulr(-.25/(u*(u+1))).mul(l);var J=i.mulr(2*n+1/(u+1));if(o=o.add(J),J.abssq()<1e-30*o.abssq())break}var s=a(2/Math.PI);e=s.mul(a.log(t.divr(2)).add(a.EM).mul(r).sub(t.inv()).sub(t.mul(o).mulr(.25)))}else{var p=Jmat.Complex.bessel1big_(t);r=p[0],e=p[1]}return m&&(e=t.im<=0?e.add(a(0,2).mul(r)).neg():e.sub(a(0,2).mul(r)).neg()),e},Jmat.Complex.bessel_sqrt_=function(t){return Jmat.Complex.isNegative(t)?Jmat.Complex.sqrt(t).neg():Jmat.Complex.sqrt(t)},Jmat.Complex.bessel_sqrt2piz_=function(t){return Jmat.Complex.bessel_sqrt_(t.rdiv(2/Math.PI))},Jmat.Complex.besselj_miller_=function(t,a){if(a.eqr(0))return Jmat.Complex(0);if(t.eqr(1))return Jmat.Complex.besselj1_(a);if(t.re<a.abs()/4){for(var r=Jmat.Complex.besselj0_(a),e=Jmat.Complex.besselj1_(a),m=1;m<t.re;m++){var n=e.mulr(2*m).div(a).sub(r);r=e,e=n}return e}for(var i,r=Jmat.Complex.besselj0_(a),o=Jmat.Complex(1),l=Jmat.Complex.ZERO,u=Math.ceil(Math.max(a.abs(),t.abs())),m=t.re+u;m>0;m--){var n=o.mulr(2*m).div(a).sub(l);l=o,o=n,m-1==t.re&&(i=n)}var J=r.div(o);return i.mul(J)},Jmat.Complex.besselj_series_=function(t,a){var r=Jmat.Complex,e=r.isNegativeInt(t);e&&(t=t.neg());for(var m=r(0),n=1,i=r.gamma(t.inc()),o=0;50>o;o++){var l=r(o+1),u=r.gamma(l).mul(i),J=r(n).div(u).mul(a.divr(2).pow(r(2*o).add(t)));n=-n,m=m.add(J),i=i.mul(t.add(l))}return e&&Jmat.Real.isOdd(t.re)&&(m=m.neg()),m},Jmat.Complex.besselj_hankelexpansion_=function(t,a){var r,e=Jmat.Complex,m=Math.PI,n=Math.abs(a.arg())>3;n&&(a=a.neg());for(var i,o=Jmat.Complex.ONE,l=e.ONE,u=a.sub(t.mulr(m/2)).subr(m/4),J=e.ZERO,s=e.ZERO,p=t.mul(t).mulr(4),x=Math.max(4,Math.min(60,Math.abs(t.re))),f=0;x>f;f++){if(f>0){var c=p.subr((2*f-1)*(2*f-1));o=o.mul(c).divr(8*f),l=l.mul(a),i=d}var C=2>f%4?1:-1,d=o.div(l).mulr(C);if(d.abssq()<1e-28)break;f%2==0?s=s.add(d):J=J.add(d)}return d.abssq()>.01?e(NaN):(s=e.cos(u).mul(s),J=e.sin(u).mul(J),r=e.bessel_sqrt2piz_(a).mul(s.sub(J)),n&&(r=r.mul(e.exp(t.muli(m)))),r)},Jmat.Complex.besselj_hypergeom_=function(t,a){var r=Jmat.Complex,e=1;r.isNegativeInt(t)&&(r.isOdd(t)&&(e=-1),t=t.neg()),r.isNegativeInt(t.addr(.5))&&(t=t.abssq()<5?t.addr(1e-12):t.addr(1e-5));var m=r.hypergeometric1F1(t.addr(.5),t.mulr(2).inc(),a.muli(2)),n=r.log(a.mulr(.5)).mul(t).sub(r.loggamma(t.inc())).add(a.muli(-1));return r.exp(n.add(r.log(m))).mulr(e)},Jmat.Complex.besselj_large_nu_=function(t,a){var r=Jmat.Complex,e=r.bessel_sqrt2piz_(t).divr(2),m=r.E.mul(a).div(t).divr(2);return e.mul(m.pow(t))},Jmat.Complex.besselj=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r(0);if(r.isInf(a))return r(0);if(a.eqr(0))return 0==t.re?r(0==t.im?1:NaN):t.re<0?r(1/0,1/0):r(0);if(t.eqr(0))return r.besselj0_(a);if(t.eqr(1))return r.besselj1_(a);if(t.eqr(.5))return r.bessel_sqrt2piz_(a).mul(r.sin(a));if(t.eqr(-.5))return r.bessel_sqrt2piz_(a).mul(r.cos(a));if(t.re>300&&Math.abs(t.im)<t.re&&a.abssq()<2500)return r(0);if(t.re<-300&&r.isInt(t)&&a.abssq()<2500)return r(0);if(t.re>50&&r.isReal(a)&&t.re>16*a.abs())return Jmat.Complex.besselj_large_nu_(t,a);if(r.isInt(t)&&Math.abs(t.re)<50){var e;return e=t.re<0?r.besselj_miller_(t.neg(),a).mulr(r.isOdd(t)?-1:1):r.besselj_miller_(t,a)}return a.abs()<25?r.besselj_series_(t,a):a.abssq()>t.abssq()?r.besselj_hankelexpansion_(t,a):t.re>2*a.abs()?Jmat.Complex.besselj_large_nu_(t,a):r.besselj_hypergeom_(t,a)},Jmat.Complex.bessely_miller_=function(t,a){for(var r=Jmat.Complex.bessely0_(a),e=Jmat.Complex.bessely1_(a),m=1;m<t.re;m++){var n=e.mulr(2*m).div(a).sub(r);r=e,e=n}return e},Jmat.Complex.bessely_with_besselj_=function(t,a){var r=Jmat.Complex;if(r.isInt(t.addr(.5)))return r.besselj(t.neg(),a).mulr(r.isOdd(t.addr(.5))?-1:1);var e=r.besselj(t,a),m=r.cos(t.mulr(Math.PI));r.isInt(m.addr(.5))&&(m=r(0));var n=r.besselj(t.neg(),a),i=r.sin(t.mulr(Math.PI));return e.mul(m).sub(n).div(i)},Jmat.Complex.bessely_hankelexpansion_=function(t,a){var r=Jmat.Complex,e=Math.PI,m=Math.abs(a.arg())>3;m&&(a=a.neg());for(var n,i=Jmat.Complex.ONE,o=r.ONE,l=a.sub(t.mulr(e/2)).subr(e/4),u=r.ZERO,J=r.ZERO,s=t.mul(t).mulr(4),p=Math.max(4,Math.min(60,Math.abs(t.re))),x=0;p>x;x++){
if(x>0){var f=s.subr((2*x-1)*(2*x-1));i=i.mul(f).divr(8*x),o=o.mul(a),n=C}var c=2>x%4?1:-1,C=i.div(o).mulr(c);if(C.abssq()<1e-28)break;x%2==0?J=J.add(C):u=u.add(C)}if(C.abssq()>.01)return r(NaN);J=r.sin(l).mul(J),u=r.cos(l).mul(u);var d=r.bessel_sqrt2piz_(a).mul(J.add(u));if(m){var v=r.besselj(t,a);d=d.mul(r.exp(t.muli(-e))).add(r.cos(t.mulr(e)).mul(v).muli(2))}return d},Jmat.Complex.bessely=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r.isInf(a)?r(NaN):r.isPositive(a)?r(-(1/0)):r(1/0,1/0);if(r.isInf(a))return r(0);if(a.eqr(0))return 0==t.re?r(0==t.im?-(1/0):NaN):r(1/0,1/0);if(t.eqr(0))return r.bessely0_(a);if(t.eqr(1))return r.bessely1_(a);if(r.isInt(t)){var e=a.re<0;e&&(a=a.neg());var m;if(m=t.re<0?r.bessely_miller_(t.neg(),a).mulr(r.isOdd(t)?-1:1):r.bessely_miller_(t,a),e){var n=r.besselj(t,a);m=a.im<=0?m.add(r(0,2).mul(n)):m.sub(r(0,2).mul(n)),r.isOdd(t)&&(m=m.neg())}return m}return a.abs()<20?r.bessely_with_besselj_(t,a):a.abssq()>t.abssq()?r.bessely_hankelexpansion_(t,a):r(NaN)},Jmat.Complex.hankelh1=function(t,a){var r=Jmat.Complex;return r.isInf(t)?r(1/0,1/0):r.isInf(a)?r(0):a.eqr(0)?0==t.re&&0!=t.im?r(NaN):r(1/0,1/0):t.im<0?r.exp(t.mul(r.newi(-Math.PI))).mul(r.hankelh1(t.neg(),a)):r.besselj(t,a).add(r.bessely(t,a).mul(r.I))},Jmat.Complex.hankelh2=function(t,a){var r=Jmat.Complex;return r.isInf(t)?r(1/0,1/0):r.isInf(a)?r(0):a.eqr(0)?0==t.re&&0!=t.im?r(NaN):r(1/0,1/0):t.im>0?r.exp(t.mul(r.newi(Math.PI))).mul(r.hankelh2(t.neg(),a)):r.besselj(t,a).sub(r.bessely(t,a).mul(r.I))},Jmat.Complex.besseli=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r(r.isInf(a)?NaN:0);if(a.eqr(1/0))return r(1/0);if(r.isInf(a))return r(1/0,1/0);if(a.eqr(0))return 0==t.re?r(0==t.im?1:NaN):t.re<0?r(1/0,1/0):r(0);var e=r.I.pow(t.neg()).mul(r.besselj(t,a.mul(r.I)));return 0==a.im&&0==t.im&&Jmat.Real.near(e.im,0,1e-10)&&(e.im=0),e},Jmat.Complex.besselk=function(t,a){var r=Jmat.Complex;if(r.isInf(t))return r.isInf(a)?r(NaN):r.isPositive(a)?r(1/0):r(1/0,1/0);if(a.eqr(1/0))return r(0);if(r.isInf(t))return r(1/0,1/0);if(a.eqr(0))return 0==t.re?r(0==t.im?1/0:NaN):r(1/0,1/0);var e;return e=a.im>=0?r.I.pow(t.inc()).mulr(Math.PI/2).mul(r.hankelh1(t,r.I.mul(a))):r.newi(-1).pow(t.inc()).mulr(Math.PI/2).mul(r.hankelh2(t,r.newi(-1).mul(a))),0==a.im&&0==t.im&&Jmat.Real.near(e.im,0,.001)&&(e.im=0),e},Jmat.Complex.airyloop_=function(t,a,r,e){for(var m=1.3541179394264005,n=.8929795115692493,i=t.mul(t).mul(t),o=Jmat.Complex.ONE,l=t,u=1,J=Jmat.Complex.ZERO,s=0;30>s;s++){s>0&&(u*=s,m*=s+2/3-1,n*=s+4/3-1,a/=9,r/=9,o=o.mul(i),l=l.mul(i));var p=o.mulr(a/u/m),x=l.mulr(r/u/n);if(Jmat.Complex.isNaN(p)||Jmat.Complex.isNaN(x))break;if(p.eqr(0)&&x.eqr(0))break;J=J.add(p).add(x.mulr(e))}return J},Jmat.Complex.airy=function(t){if(t.abs()>8){if(Math.abs(t.arg())<2*Math.PI/3){var a=t.powr(.25).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r.neg()).div(a.mulr(2))}var e=t.neg(),a=e.powr(.25).mul(Jmat.Complex.SQRTPI),r=e.powr(1.5).mulr(2/3);return Jmat.Complex.sin(r.addr(Math.PI/4)).div(a)}var m=Math.pow(3,-2/3),n=Math.pow(3,-4/3);return Jmat.Complex.airyloop_(t,m,n,-1)},Jmat.Complex.bairy=function(t){if(t.abs()>10){if(Math.abs(t.arg())<Math.PI/3){var a=t.powr(.25).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r).div(a)}var e=t.neg(),a=e.powr(.25).mul(Jmat.Complex.SQRTPI),r=e.powr(1.5).mulr(2/3);return Jmat.Complex.cos(r.addr(Math.PI/4)).div(a)}var m=Math.pow(3,-1/6),n=Math.pow(3,-5/6);return Jmat.Complex.airyloop_(t,m,n,1)},Jmat.Complex.airy_deriv_loop_=function(t,a,r,e){for(var m=2.6789385347077475,n=.9027452929509336,i=t.mul(t).mul(t),o=Jmat.Complex.ONE,l=t.mul(t),u=1,J=Jmat.Complex.ZERO,s=0;30>s;s++){s>0&&(u*=s,m*=s+1/3-1,n*=s+5/3-1,a/=9,r/=9,o=o.mul(i),l=l.mul(i));var p=o.mulr(a/u/m),x=l.mulr(r/u/n);if(Jmat.Complex.isNaN(p)||Jmat.Complex.isNaN(x))break;if(p.eqr(0)&&x.eqr(0))break;J=J.add(p.mulr(e)).add(x)}return J},Jmat.Complex.airy_deriv=function(t){if(t.abs()>8){if(Math.abs(t.arg())<2*Math.PI/3){var a=t.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r.neg()).div(a.mulr(2)).neg()}var e=t.neg(),a=e.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=e.powr(1.5).mulr(2/3);return Jmat.Complex.cos(r.addr(Math.PI/4)).div(a).neg()}var m=Math.pow(3,-1/3),n=Math.pow(3,-5/3);return Jmat.Complex.airy_deriv_loop_(t,m,n,-1)},Jmat.Complex.bairy_deriv=function(t){if(t.abs()>10){if(Math.abs(t.arg())<Math.PI/3){var a=t.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=t.powr(1.5).mulr(2/3);return Jmat.Complex.exp(r).div(a)}var e=t.neg(),a=e.powr(-1/4).mul(Jmat.Complex.SQRTPI),r=e.powr(1.5).mulr(2/3);return Jmat.Complex.sin(r.addr(Math.PI/4)).div(a)}var m=Math.pow(3,1/6),n=Math.pow(3,-7/6);return Jmat.Complex.airy_deriv_loop_(t,m,n,1)},Jmat.Complex.zetaint_=function(t){for(var a=function(t,a){var r=Jmat.Complex.sin(t.mul(Jmat.Complex.atan(a))),e=a.mul(a).inc().pow(t.divr(2)),m=Jmat.Complex.exp(a.mulr(2*Math.PI)).dec(),a=e.mul(m);return r.eq(a)?Jmat.Complex.ONE:r.div(a)},r=Jmat.Complex.ONE;;){var e=a(t,r);if(e.abssq()<1e-4&&e.abssq()<1e-4)break;if(r.re>1e3)break;r=r.mulr(2)}for(var m=r.re,n=.01,i=Jmat.Complex.ZERO,o=0;m>o;o+=n){var l=a(t,Jmat.Complex(o)).mulr(n);i=i.add(l),n*=1.01}return i.mulr(2).addr(.5).add(t.dec().inv())},Jmat.Complex.zeta=function(t){if(t.eq(Jmat.Complex.ZERO))return Jmat.Complex(-.5);if(t.eqr(-1))return Jmat.Complex(-1/12);if(t.eqr(1))return Jmat.Complex(+(1/0));if(t.eqr(3))return Jmat.Complex(1.202056903159594);if(t.re==+(1/0))return Jmat.Complex(1);if(Jmat.Complex.isEven(t)&&t.re<0)return Jmat.Complex(0);var a=t.dec().abs();if(10>a){for(var r=t.dec(),e=r.inv(),m=Jmat.Complex.ONE,n=5>a?10:30,i=0;n>i;i++)e=e.add(Jmat.Complex(Jmat.Complex.stieltjes_zeta[i]).mul(m)),m=m.mul(r);return e}if(t.re>=5){for(var e=Jmat.Complex(0),i=1;32>i;i++)e=e.add(Jmat.Complex(i).pow(t).inv());return e}if(t.re>=.5){if(Jmat.Complex.near(t,Jmat.Complex(1,18.125),.1))return Jmat.Complex.zetaint_(t);for(var e=Jmat.Complex(0),o=Jmat.Complex.TWO.pow(Jmat.Complex.ONE.sub(t)),l=Jmat.Complex.ONE.div(Jmat.Complex.ONE.sub(o)),u=1,i=1;128>i;i++){var J=Jmat.Complex(u).div(Jmat.Complex(i).pow(t));e=e.add(J),u=-u}return e.mul(l)}var s=Jmat.Complex.ONE.sub(t),l=Jmat.Complex.TWO.pow(t),p=Jmat.Complex.PI.pow(t.subr(1)),x=Jmat.Complex.sin(t.mulr(Math.PI/2)),f=Jmat.Complex.gamma(s),c=Jmat.Complex.zeta(s);return l.mul(p).mul(x).mul(f).mul(c)},Jmat.Complex.eta=function(t){if(t.re<.5){t=t.neg();var a=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(t.neg().subr(1))),r=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(t.neg())),e=a.div(r).mulr(2).mul(Jmat.Complex.PI.pow(t.neg().subr(1))),m=Jmat.Complex.sin(Jmat.Complex.PI.mul(t).divr(2)),n=Jmat.Complex.gamma(t),i=Jmat.Complex.eta(t.inc());return e.mul(t).mul(m).mul(n).mul(i)}for(var o=50,m=function(t,a){for(var r=0,e=0;t>=e;e++){var m=Jmat.Real.factorial(a+e-1)/Jmat.Real.factorial(a-e),n=Math.pow(4,e)/Jmat.Real.factorial(2*e);r+=m*n}return r*a},l=m(o,o),u=Jmat.Complex(0),J=Jmat.Complex(1),s=0;o>s;s++){var a=J.mulr(m(s,o)-l),r=Jmat.Complex(s+1).pow(t);u=u.add(a.div(r)),J=J.neg()}return u.mulr(-1/l)},Jmat.Complex.lambda=function(t){return Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(t.neg())).mul(Jmat.Complex.zeta(t))},Jmat.Complex.hurwitzzeta_generate_hasse_table_=function(t){for(var a=[],r=0;t>r;r++){a[r]=0;for(var e=1,m=0;r>=m;m++)a[m]+=e*Jmat.Real.pascal_triangle(r,m)/(r+1),e=-e}return a},Jmat.Complex.hurwitzzeta_hasse_tables_=[],Jmat.Complex.hurwitzzeta_hasse_series_=function(t,a){var r=30;Jmat.Complex.hurwitzzeta_hasse_tables_[r]||(Jmat.Complex.hurwitzzeta_hasse_tables_[r]=Jmat.Complex.hurwitzzeta_generate_hasse_table_(r));for(var e=Jmat.Complex.hurwitzzeta_hasse_tables_[r],m=Jmat.Complex.ZERO,n=0;r>n;n++)m=m.add(a.addr(n).pow(Jmat.Complex.ONE.sub(t)).mulr(e[n]));return m=m.mul(t.dec().inv())},Jmat.Complex.hurwitzzeta_cos_series_=function(t,a){for(var r=t.rsub(1),e=Jmat.Complex.gamma(r).mulr(2).div(Jmat.Complex(2*Math.PI).pow(r)),m=Jmat.Complex.ZERO,n=1;30>n;n++){var i=Jmat.Complex.cos(r.mulr(Math.PI/2).sub(a.mulr(2*Math.PI*n)));m=m.add(i.div(Jmat.Complex(n).pow(r)))}return m.mul(e)},Jmat.Complex.hurwitzzeta_simple_series_=function(t,a){if(Jmat.Complex.isNegativeIntOrZero(a))return Jmat.Complex(1/0);for(var r=Jmat.Complex.ZERO,e=0;30>e;e++){var m=a.addr(e).pow(t).inv();r=r.add(m)}return r},Jmat.Complex.hurwitzzeta_euler_=function(t,a){for(var r=25,e=15,m=a.addr(r).pow(t).inv(),n=t.dec().inv().mul(a.addr(r).pow(t.dec()).inv()),i=Jmat.Complex.ZERO,o=0;r>o;o++){var l=a.addr(o).pow(t).inv();i=i.add(l)}for(var u=t,J=1,s=Jmat.Complex.ZERO,o=1;e>=o;o++){J*=2*(2*o-1)*o,u=u.mul(t.addr(2*o-1)).mul(t.addr(2*o));var p=u.div(a.addr(r).pow(t.addr(2*o+1))).neg();s=s.add(p.mulr(Jmat.Complex.bernoulli[2*o]/J))}return i.sub(s).add(m.divr(2)).add(n)},Jmat.Complex.hurwitzzeta=function(t,a){if(t.eqr(0))return Jmat.Complex(.5).sub(a);if(t.eqr(-1))return Jmat.Complex(-1/12).add(a.mulr(.5)).add(a.mul(a).mulr(-.5));if(a.eqr(1))return Jmat.Complex.zeta(t);if(t.re>2&&a.re>0)return Jmat.Complex.hurwitzzeta_simple_series_(t,a);if(t.re>=0&&a.re>-10)return Jmat.Complex.hurwitzzeta_euler_(t,a);if(t.re<0&&0==a.im&&a.re>0&&a.re<=1)return Jmat.Complex.hurwitzzeta_cos_series_(t,a);if(a.re>2)return Jmat.Complex.hurwitzzeta_hasse_series_(t,a);if(a.re>-40&&!a.eqr(0)){var r=t.re<0&&0==a.im?Math.ceil(-a.re):Math.ceil(2-a.re+.5),e=Jmat.Complex.ZERO;if(r>0)for(var m=0;r>m;m++){var n=a.addr(m).pow(t).inv();Jmat.Complex.isNaN(n)||(e=e.add(n))}else for(var m=0;-r>m;m++){var n=a.addr(m).addr(r).pow(t).inv();Jmat.Complex.isNaN(n)||(e=e.add(n))}var i=Jmat.Complex.hurwitzzeta(t,a.addr(r));return r>0?i.add(e):i.sub(e)}return Jmat.Complex(NaN)},Jmat.Complex.beta=function(t,a){return t.re<50&&t.re>-50&&a.re<50&&a.re>-50?Jmat.Complex.gammaDiv21_(t,a,t.add(a)):Jmat.Complex.exp(Jmat.Complex.loggammaDiv21_(t,a,t.add(a)))},Jmat.Complex.incbeta=function(t,a,r){if(t.eqr(1))return Jmat.Complex.beta(a,r);if(Jmat.Complex.isPositive(t)&&t.re<.75&&Jmat.Complex.isPositive(a)&&Jmat.Complex.isPositive(r)){for(var e,m,n=Jmat.Complex.ONE.sub(r),i=0;30>i&&(0==i?(e=Jmat.Complex(1),m=Jmat.Complex(0)):(e=e.mul(n.addr(i-1)),e=e.mul(t),e=e.divr(i)),!e.eqr(0));i++)m=m.add(e.div(a.addr(i)));return t.pow(a).mul(m)}return t.pow(a).div(a).mul(Jmat.Complex.hypergeometric2F1(a,Jmat.Complex.ONE.sub(r),a.inc(),t))},Jmat.Complex.beta_i=function(t,a,r){return Jmat.Complex.isNegativeIntOrZero(a)&&!Jmat.Complex.isNegativeIntOrZero(r)?Jmat.Complex(1):Jmat.Complex.isNegativeIntOrZero(r)&&!Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex(0):Jmat.Complex.isNegativeIntOrZero(r.add(a))&&t.eqr(1)?Jmat.Complex(1):Jmat.Complex.incbeta(t,a,r).div(Jmat.Complex.beta(a,r))},Jmat.Complex.beta_i_inv=function(t,a,r){if(!(Jmat.Complex.isPositiveOrZero(t)&&Jmat.Complex.isPositiveOrZero(a)&&Jmat.Complex.isPositiveOrZero(r)))return Jmat.Complex(NaN);for(var e=Jmat.Complex.beta(a,r),m=Jmat.Complex.ZERO,n=Jmat.Complex.ZERO,i=Jmat.Complex.ONE;!Jmat.Complex.near(n,i,1e-6);)m=n.add(i).divr(2),Jmat.Complex.incbeta(m,a,r).div(e).re>t.re?i=m:n=m;return m},Jmat.Complex.hypergeometric0F1=function(t,a){var r=Jmat.Complex;if(r.isNegativeInt(t))return r(1/0,1/0);if(a.re<-80&&t.abssq()<a.abssq()/3){var e=r.gamma(t).divr(2*r.SQRTPI.re),m=r.sqrt(a.neg()),n=r.exp(m.muli(-2)).mul(m.muli(-1).pow(t.rsub(.5))),i=r.hypergeometric([t.subr(.5),t.rsub(1.5)],[],m.muli(4).inv().neg()),o=r.exp(m.muli(2)).mul(m.muli(1).pow(t.rsub(.5))),l=r.hypergeometric([t.subr(.5),t.rsub(1.5)],[],m.muli(4).inv());return e.mul(n.mul(i).add(o.mul(l)))}for(var u=r.ONE,J=r.ZERO,s=0;30>s&&(s>0&&(u.eqr(0)||(u=u.div(t.addr(s-1))),u=u.mul(a).divr(s)),!u.eqr(0));s++)J=J.add(u);return J},Jmat.Complex.hypergeometric1F1_series_=function(t,a,r){for(var e=Jmat.Complex,m=t.div(a).mul(r).divr(1),n=e(1),i=1;200>i&&(i>1&&(m=m.mul(t.addr(i-1)),m.eqr(0)||(m=m.div(a.addr(i-1))),m=m.mul(r),m=m.divr(i)),!(m.eqr(0)||m.abssq()/n.abssq()<1e-28));i++)n=n.add(m);return n},Jmat.Complex.hypergeometric1F1_asymp_=function(t,a,r){var e=Jmat.Complex;if(e.isNegativeInt(a))return e(NaN);for(var m=e.ONE,n=e.ONE,i=e.ONE,o=e.ONE,l=1;30>l&&(i=i.mul(t.addr(l-1)).mul(t.sub(a).addr(l)).divr(l).div(r.neg()),o=o.mul(a.sub(t).addr(l-1)).mul(t.rsub(l)).divr(l).div(r),m=m.add(i),n=n.add(o),!(i.abssq()<1e-28&&o.abssq()<1e-28));l++);if(i.abssq()>1e-10||o.abssq()>1e-10)return e(NaN);var u=r.arg()<=0?-1:1;if(r.abs()<100){var J=e.gammaDiv_(a,a.sub(t)).mul(e.exp(t.muli(u*Math.PI))).div(r.pow(t)),s=e.gammaDiv_(a,t).mul(e.exp(r)).mul(r.pow(t.sub(a)));return J.mul(m).add(s.mul(n))}var J=e.loggammaDiv_(a,a.sub(t)).add(t.muli(u*Math.PI)).sub(e.log(r).mul(t)),s=e.loggammaDiv_(a,t).add(r).add(e.log(r).mul(t.sub(a)));return e.exp(J.add(e.log(m))).add(e.exp(s.add(e.log(n))))},Jmat.Complex.hypergeometric1F1_rational_=function(t,a,r){var e=Jmat.Complex,m=function(t,a,r){for(var m,n,i=r.mul(r),o=i.mul(r),l=a.mul(a.inc()),u=e(1),J=e(1).add(t.inc().mul(r).div(a).divr(2)),s=e(1).add(t.addr(2).mul(r).div(a.inc()).divr(2)).add(t.inc().mul(t.addr(2)).mul(i).div(l).divr(12)),p=t.mul(r).div(a),x=e(1),f=J.sub(p),c=t.addr(2).mul(r).div(a.inc()).divr(2).inc(),C=t.mul(t.inc()).mul(i).div(l).divr(2),d=s.sub(p.mul(c)).add(C),v=3;50>v;v++){var g=2*v,h=t.rsub(v-2).div(a.addr(v-1).mulr(2*(g-3))),I=t.addr(v).mul(t.addr(v-1)).div(a.addr(v-1).mul(a.addr(v-2)).mulr(4*(g-3)*(g-1))),_=t.addr(v-2).mul(t.addr(v-1)).mul(t.rsub(v-2)).div(a.addr(v-3).mul(a.addr(v-2)).mul(a.addr(v-1)).mulr(8*(g-3)*(g-3)*(g-5))).neg(),b=t.addr(v-1).mul(a.rsub(v-1)).div(a.addr(v-2).mul(a.addr(v-1)).mulr(2*(g-3))).neg(),M=h.mul(r).inc(),w=I.mul(r).add(b).mul(r),B=_.mul(o);m=d.mul(M).add(f.mul(w)).add(x.mul(B)),n=s.mul(M).add(J.mul(w)).add(u.mul(B)),x=f,f=d,d=m,u=J,J=s,s=n}var R=f.div(J),N=m.div(n);return R.sub(N).abs()>1e-10?e(NaN):N};return m(t,a,r.neg())},Jmat.Complex.hypergeometric1F1=function(t,a,r){var e=Jmat.Complex;if(a.sub(t).abssq()<t.abssq())return e.hypergeometric1F1(a.sub(t),a,r.neg()).mul(e.exp(r));if(t.eq(a))return e.exp(r);if(e.isNegativeInt(a)&&!(e.isNegativeInt(t)&&t.re>=a.re))return e(1/0);if(t.eqr(0))return e(1);if(r.eqr(0))return e(1);if(r.eqr(1/0))return e(1/0,1/0);var m=r.mul(t).div(a).abs();if(8>m)return e.hypergeometric1F1_series_(t,a,r);var n=e.hypergeometric1F1_asymp_(t,a,r);return e.isNaN(n)&&(n=e.hypergeometric1F1_rational_(t,a,r)),n},Jmat.Complex.hypergeometric2F1=function(t,a,r,e){if(e.abs()>1.0001){var m=e.div(e.dec());if(m.abs()<.75)return Jmat.Complex.ONE.sub(e).pow(t.neg()).mul(Jmat.Complex.hypergeometric2F1(t,r.sub(a),r,m));var n=function(t){return Jmat.Complex.isNegativeIntOrZero(t)?t.addr(1e-5):t},i=e.inv(),o=e.neg().pow(t.neg()),l=e.neg().pow(a.neg()),u=Jmat.Complex.gammaDiv22_(n(r),n(a.sub(t)),n(a),n(r.sub(t))),J=Jmat.Complex.gammaDiv22_(n(r),n(t.sub(a)),n(t),n(r.sub(a))),s=Jmat.Complex.hypergeometric2F1(t,Jmat.Complex.ONE.sub(r).add(t),n(Jmat.Complex.ONE.sub(a).add(t)),i),p=Jmat.Complex.hypergeometric2F1(a,Jmat.Complex.ONE.sub(r).add(a),n(Jmat.Complex.ONE.sub(t).add(a)),i),x=u.mul(o).mul(s),f=J.mul(l).mul(p);return x.add(f)}var m=e.div(e.dec());if(m.abs()<e.abs())return Jmat.Complex.ONE.sub(e).pow(t.neg()).mul(Jmat.Complex.hypergeometric2F1(t,r.sub(a),r,m));var c=30;e.abs()>.5&&(c=60),e.abs()>.75&&(c=100);for(var C=t.mul(a).div(r).mul(e).divr(1),d=Jmat.Complex(1),v=1;c>v&&(v>1&&(C=C.mul(t.addr(v-1)),C=C.mul(a.addr(v-1)),C.eqr(0)||(C=C.div(r.addr(v-1))),C=C.mul(e),C=C.divr(v)),!C.eqr(0))&&!Jmat.Complex.near(C,Jmat.Complex.ZERO,1e-15);v++)d=d.add(C);return d},Jmat.Complex.hypergeometric=function(t,a,r){if(r.eqr(0))return Jmat.Complex(1);if(0==t.length&&0==a.length)return Jmat.Complex.exp(r);if(1==t.length&&0==a.length)return Jmat.Complex.pow(r.rsub(1),t[0].neg());if(0==t.length&&1==a.length)return Jmat.Complex.hypergeometric0F1(a[0],r);if(1==t.length&&1==a.length)return Jmat.Complex.hypergeometric1F1(t[0],a[0],r);if(2==t.length&&1==a.length)return Jmat.Complex.hypergeometric2F1(t[0],t[1],a[0],r);for(var e=r,m=0;m<t.length;m++)e=e.mul(t[m]);for(var m=0;m<a.length;m++)e=e.div(a[m]);for(var n=Jmat.Complex(1),i=1;40>i;i++){if(i>1){for(var m=0;m<t.length;m++)e=e.mul(t[m].addr(i-1));for(var m=0;m<a.length;m++)e=e.eqr(0)?e:e.div(a[m].addr(i-1));e=e.mul(r),e=e.divr(i)}if(e.eqr(0))break;n=n.add(e)}return n},Jmat.Complex.PIPI6_=Jmat.Complex(Math.PI*Math.PI/6),Jmat.Complex.dilog=function(t){if(t.eqr(0))return Jmat.Complex.ZERO;if(t.eqr(1))return Jmat.Complex.PIPI6_;if(t.eqr(+(1/0)))return Jmat.Complex(-(1/0));if(t.eqr(-(1/0)))return Jmat.Complex(-(1/0));var a=function(t){for(var a=Jmat.Complex.ZERO,e=t,m=.5>=r?30:50,n=1;m>n;n++){var i=e.divr(n*n);if(a=a.add(i),Jmat.Complex.near(i,Jmat.Complex.ZERO,1e-15))break;e=e.mul(t)}return a},r=t.abs();if(.5>r)return a(t);if(.5>1/r){var e=a(t.inv()).neg(),m=Jmat.Complex.log(t.neg());return e.sub(m.mul(m).divr(2)).sub(Jmat.Complex.PIPI6_)}var n=Jmat.Complex.ONE.sub(t),i=n.abs(),o=Jmat.Complex.ONE.sub(t).inv(),l=o.abs(),u=t.div(t.dec()),J=u.abs(),s=r,p=0;if(s>1/r&&(s=1/r,p=1),s>i&&(s=i,p=2),s>l&&(s=l,p=3),s>J&&(s=J,p=4),.8>s){if(0==p)return a(t);if(1==p){var e=a(t.inv()).neg(),m=Jmat.Complex.log(t.neg());return e.sub(m.mul(m).divr(2)).sub(Jmat.Complex.PIPI6_)}if(2==p){var e=a(n).neg(),x=Jmat.Complex.log(n),f=Jmat.Complex.log(t);return e.sub(x.mul(f)).add(Jmat.Complex.PIPI6_)}if(3==p){var e=a(o),x=Jmat.Complex.log(Jmat.Complex.ONE.sub(t)),f=Jmat.Complex.log(t.neg());return e.add(x.mul(x).divr(2)).sub(f.mul(x)).sub(Jmat.Complex.PIPI6_)}if(4==p){var e=a(u).neg(),m=Jmat.Complex.log(Jmat.Complex.ONE.sub(t));return e.sub(m.mul(m).divr(2))}}return Jmat.Complex.dilog(t.mul(t)).divr(2).sub(Jmat.Complex.dilog(t.neg()))},Jmat.Complex.trilog=function(t){if(t.eqr(0))return Jmat.Complex.ZERO;if(t.eqr(1))return Jmat.Complex.APERY;if(t.eqr(+(1/0)))return Jmat.Complex(-(1/0));if(t.eqr(-(1/0)))return Jmat.Complex(-(1/0));var a=function(t){for(var a=Jmat.Complex.ZERO,e=t,m=.5>r?30:50,n=1;m>n;n++){var i=e.divr(n*n*n);if(a=a.add(i),Jmat.Complex.near(i,Jmat.Complex.ZERO,1e-15))break;e=e.mul(t)}return a},r=t.abs();if(.75>r)return a(t);if(.75>1/r){var e=a(t.inv()),m=Jmat.Complex.log(t.neg());return e.sub(m.mul(m).mul(m).divr(6)).sub(Jmat.Complex.PIPI6_.mul(m))}return Jmat.Complex.polylog_integral_(Jmat.Complex(3),t)},Jmat.Complex.bernoulli=[1,-0.5,1/6,0,-1/30,0,1/42,0,-1/30,0,5/66,0,-691/2730,0,7/6,0,-3617/510,0,43867/798,0,-174611/330,0,854513/138,0,-23749461029/2730,0,8615841276005/6,0,-8861288553.122988,0,179980998.3498813,0],Jmat.Complex.stieltjes=[.5772156649015329,-.07281584548367673,-.00969036319287232,.002053834420303346,.0023253700654673,.0007933238173010627,-.0002387693454301996,-.000527289567057751,-.0003521233538030395,-3439477441808805e-20,.0002053328149090648,.0002701844395439035,.0001672729121051402,-27463806603760158e-21,-.00020920926205929996,-.0002834686553202414,-.00019969685830896976,26277037109918338e-21,.0003073684081492528,.0005036054530473557,.00046634356151155945,.00010443776975600011,-.0005415995822039977,-.0012439620904082457,-.0015885112789035616,-.0010745919527384888,.0006568035186371545,.0034778369136185382,.00640006853170063,.007371151770472239,.003557728855573161,-.007513325997815229],Jmat.Complex.stieltjes_zeta=[.5772156649015329,.07281584548367673,-.00484518159643616,-.00034230573671722433,9689041939447084e-20,-66110318108421895e-22,-3.316240908752772e-7,1.0462094584479188e-7,-8.733218100273798e-9,9.47827778276236e-11,5.658421927608708e-11,-6.768689863513697e-12,3.4921159366720317e-13,4.4104247417577536e-15,-2.3997862217709992e-15,2.1677312200726828e-16,-9.544466076366965e-18,-7.387676660538637e-20,4.800850782488065e-20,-4.139956737713306e-21,1.9168201593991233e-22,-2.0441543122262165e-24,-4.818498501107353e-25,4.8118570515125666e-26,-2.560263310318815e-27,6.927840895304667e-29,1.6286075504855866e-30,-3.1939375611532554e-31,2.0991515893634255e-32,-8.33674529544144e-34,1.3412593772192187e-35,9.137143891298173e-37],Jmat.Complex.polylog_integral_=function(t,a){if(t.re>1&&Math.abs(t.im)<t.re&&Math.abs(a.arg())>.1){var r=Jmat.Complex.gamma(t),e=Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(20),function(r){var e=r.pow(t.dec()).div(Jmat.Complex.exp(r).sub(a));return Jmat.Complex.isNaN(e)&&(e=Jmat.Complex.ZERO),e},100);return a.div(r).mul(e)}if(Jmat.Complex.isNegative(t)&&Math.abs(a.arg())>.1){var m=Jmat.Complex.log(a.neg()),e=Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(20),function(a){var r=a.pow(t.neg()),e=Jmat.Complex.sin(t.mulr(Math.PI/2).sub(a.mul(m))),n=Jmat.Complex.sinh(a.mulr(Math.PI)),i=r.mul(e).div(n);return Jmat.Complex.isNaN(i)&&(i=Jmat.Complex.ZERO),i},100);return e}if(a.im<=0||t.re>0&&Math.abs(t.im)<t.re){var m=Jmat.Complex.log(a.neg()),n=function(a){var r=Jmat.Complex.sin(t.mul(Jmat.Complex.atan(a)).sub(a.mul(m))),e=Jmat.Complex.ONE.add(a.mul(a)).pow(t.divr(2)),n=Jmat.Complex.sinh(a.mulr(Math.PI)),i=r.div(e).div(n);return Jmat.Complex.isNaN(i)&&(i=Jmat.Complex.ZERO),i},e=Jmat.Complex.ZERO;return e=e.add(Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(5),n,50)),e=e.add(Jmat.Complex.integrate(Jmat.Complex(5),Jmat.Complex(20),n,20)),e=e.add(Jmat.Complex.integrate(Jmat.Complex(20),Jmat.Complex(100),n,10)),a.mulr(.5).add(a.mul(e))}if(a.im>0){var i=Jmat.Complex.log(a),n=function(a){var r=Jmat.Complex.sin(t.mul(Jmat.Complex.atan(a)).sub(a.mul(i))),e=Jmat.Complex.ONE.add(a.mul(a)).pow(t.divr(2)),m=Jmat.Complex.exp(a.mulr(2*Math.PI)).sub(1),n=r.div(e).div(m);return Jmat.Complex.isNaN(n)&&(n=Jmat.Complex.ZERO),n},e=Jmat.Complex.ZERO;e=e.add(Jmat.Complex.integrate(Jmat.Complex(0),Jmat.Complex(5),n,50)),e=e.add(Jmat.Complex.integrate(Jmat.Complex(5),Jmat.Complex(20),n,20)),e=e.add(Jmat.Complex.integrate(Jmat.Complex(20),Jmat.Complex(100),n,10));var r=Jmat.Complex.incgamma_upper(Jmat.Complex.ONE.sub(t),i.neg()),o=i.neg().pow(Jmat.Complex.ONE.sub(t));return a.mulr(.5).add(r.div(o)).add(a.mulr(2).mul(e))}return Jmat.Complex(NaN)},Jmat.Complex.polylog_borwein_=function(t,a){var r=a.mul(a).div(a.dec()).abs();if(r>=3.7)return Jmat.Complex(NaN);var e=Math.floor(Math.min(31,16/r)),m=[];m[0]=Jmat.Complex.ONE;for(var n=Jmat.Complex.ONE,i=Jmat.Complex.ONE,o=Jmat.Complex.ZERO,l=1;e>=l;l++){i=i.mul(a);var u=i.div(Jmat.Complex(l).pow(t));o=o.add(u);var J=Jmat.Complex.binomial(Jmat.Complex(e),Jmat.Complex(l)),s=J.mul(i);l%2&&(s=s.neg()),n=n.add(s),m[l]=n}var p=Jmat.Complex.ZERO;for(l=e+1;2*e>=l;l++){i=i.mul(a);var u=i.div(Jmat.Complex(l).pow(t));n=m[2*e-l],u=u.mul(n),p=p.add(u)}var x=a.dec().inv().powr(e);p=p.mul(x);var f;return f=e%2?o.sub(p):o.add(p)},Jmat.Complex.polylog_borwein_ok_=function(t,a){var r=a.mul(a).div(a.dec()).abs();return t.re>=-5&&0==a.im&&1.5>=r||t.re>=0&&Math.abs(t.im)<t.re&&2>=r||a.abs()<=.5},Jmat.Complex.polylog_residue_=function(t,a){var r=!1,e=a;0==t.im&&0==a.im&&(a=a.add(Jmat.Complex.newi(-1e-4)),(Jmat.Complex.isNegativeInt(t)||a.re<0)&&(r=!0));for(var m=Jmat.Complex.log(a),n=Jmat.Complex.gamma(Jmat.Complex.ONE.sub(t)),i=Jmat.Complex.ZERO,o=0;30>o;o++)i=e.im>0?i.add(Jmat.Complex.newi(2*o*Math.PI).sub(m).pow(t.dec())):i.add(Jmat.Complex.newi(-2*o*Math.PI).sub(m).pow(t.dec()));var l=n.mul(i);return r&&0!=l.im&&(l=Jmat.Complex(l.re)),l},Jmat.Complex.polylog=function(t,a){if(Jmat.Complex.isInt(t)){if(t.eqr(0))return a.div(Jmat.Complex.ONE.sub(a));if(t.eqr(1))return Jmat.Complex.log(Jmat.Complex.ONE.sub(a)).neg();if(t.eqr(2))return Jmat.Complex.dilog(a);if(t.eqr(3))return Jmat.Complex.trilog(a);if(t.eqr(-1)){var r=Jmat.Complex.ONE.sub(a);return a.div(r).div(r)}if(t.eqr(-2)){var r=Jmat.Complex.ONE.sub(a);return a.mul(a.inc()).div(r).div(r).div(r)}if(t.eqr(-3)){var r=Jmat.Complex.ONE.sub(a),e=r.mul(r);return a.mul(Jmat.Complex.ONE.add(a.mulr(4)).add(a.mul(a))).div(e).div(e)}if(t.eqr(-4)){var r=Jmat.Complex.ONE.sub(a),e=r.mul(r);return a.mul(a.inc()).mul(Jmat.Complex.ONE.add(a.mulr(10)).add(a.mul(a))).div(e).div(e).div(r)}}if(t.re>1&&a.eqr(0))return Jmat.Complex(0);if(t.re>1&&a.eqr(1))return Jmat.Complex.zeta(t);var m=a.abs();if(.5>=m&&t.re>=-10||.75>m&&t.re>=-2||.9>m&&t.re>-1){for(var n=Jmat.Complex.ZERO,i=a,o=.5>=m?30:50,l=1;o>l;l++){var u=i.div(Jmat.Complex(l).pow(t));if(n=n.add(u),Jmat.Complex.near(u,Jmat.Complex.ZERO,1e-15))break;i=i.mul(a)}return n}if(Jmat.Complex.polylog_borwein_ok_(t,a))return Jmat.Complex.polylog_borwein_(t,a);if(t.re<0)return Jmat.Complex.polylog_residue_(t,a);if(Jmat.Complex.isNegativeInt(t)&&m>1){var J=Jmat.Complex.isOdd(t)?1:-1;return Jmat.Complex.polylog(t,a.inv()).mulr(J)}return Jmat.Complex.polylog_integral_(t,a)},Jmat.Complex.theta1=function(t,a){if(t.im>1)return Jmat.Complex.theta1(t.neg(),a).neg();for(var r=Jmat.Complex(0),e=Jmat.Complex(1),m=0;20>m;m++){var n=a.powr((m+.5)*(m+.5)),i=Jmat.Complex.sin(t.mulr(2*m+1));r=r.add(e.mul(n).mul(i)),e=e.neg()}return r.mulr(2)},Jmat.Complex.theta2=function(t,a){if(t.im>1)return Jmat.Complex.theta2(t.neg(),a);for(var r=Jmat.Complex(0),e=0;20>e;e++){var m=a.powr((e+.5)*(e+.5)),n=Jmat.Complex.cos(t.mulr(2*e+1));r=r.add(m.mul(n))}return r.mulr(2)},Jmat.Complex.theta3=function(t,a){if(t.im>1)return Jmat.Complex.theta3(t.neg(),a);for(var r=Jmat.Complex(0),e=0;20>e;e++){var m=a.powr(e*e),n=Jmat.Complex.cos(t.mulr(2*e));r=r.add(m.mul(n))}return r.mulr(2).addr(1)},Jmat.Complex.theta4=function(t,a){if(t.im>1)return Jmat.Complex.theta4(t.neg(),a);for(var r=Jmat.Complex(0),e=Jmat.Complex(1),m=0;20>m;m++){var n=a.powr(m*m),i=Jmat.Complex.cos(t.mulr(2*m));r=r.add(e.mul(n).mul(i)),e=e.neg()}return r.mulr(2).addr(1)},Jmat.Complex.tetration=function(t,a){if(Jmat.Complex.isPositive(t)&&Jmat.Complex.isPositiveInt(a)&&a.re!=1/0)return Jmat.Complex(Jmat.Real.tetration(t.re,a.re));if(a.eqr(0))return Jmat.Complex(1);if(a.eqr(1))return t;if(a.eqr(2))return t.pow(t);if(Jmat.Complex.isReal(t)&&t.re>=2&&a>5)return Jmat.Complex(1/0);if(t.eqr(0)&&Jmat.Complex.isPositiveInt(a))return Jmat.Complex.isEven(a)?Jmat.Complex(1):Jmat.Complex(0);if(a.eqr(1/0)){if(t.eqr(1))return Jmat.Complex(1);var r=Jmat.Complex.log(t);return Jmat.Complex.lambertw(r.neg()).div(r.neg())}var e=function(t,a,r,e){for(var m,n=a,i=0;r>i;i++){if(n=e?Jmat.Complex.logy(n,t):t.pow(n),Jmat.Complex.isNaN(n))return n;if(n.eq(m))return n;if(m=n,i>1e3)return Jmat.Complex(NaN)}return n};if(Jmat.Complex.isPositiveInt(a))return e(t,t,a.re-1,!1);if(Jmat.Complex.isReal(a)){if(a.eqr(-1))return Jmat.Complex(0);if(a.re>-1&&a.re<=0)return a.inc();if(a.re>0){var m=a.sub(Jmat.Complex.floor(a));return e(t,m,Math.ceil(a.re),!1)}if(a.re<=-1){var m=a.sub(Jmat.Complex.floor(a));return e(t,m,-Math.ceil(a.re),!0)}}if(Jmat.Complex.near(t,Jmat.Complex.E,1e-15)){var m,n=[.30685281944005,.59176735125832,.3964832129017,.17078658150959,.08516537613999,.03804195209047,.01734090876306,.00755271038865,.00328476064839,.0013936174017,.00058758348148,.00024379186661,.00024379186661,.00010043966462,1654344436e-14,663102846e-14,264145664e-14,104446533e-14,4.1068839e-7,1.6048059e-7,6.239367e-8,2.412797e-8,9.28797e-9,3.5585e-9,1.35774e-9,5.1587e-10],i=[Jmat.Complex(.37090658903229,1.33682167078891),Jmat.Complex(.01830048268799,.06961107694975),Jmat.Complex(-.0422210796016,.02429633404907),Jmat.Complex(-.01585164381085,-.01478953595879),Jmat.Complex(.00264738081895,-.0065755813052),Jmat.Complex(.00182759574799,-.00025319516391),Jmat.Complex(.0003656299477,.0002824651581),Jmat.Complex(2689538943e-14,.00014180498091),Jmat.Complex(-3139436775e-14,3583704949e-14),Jmat.Complex(-1376358453e-14,-183512708e-14),Jmat.Complex(-18029098e-13,-314787679e-14),Jmat.Complex(2.639887e-7,-9.2613311e-7),Jmat.Complex(2.4961828e-7,-1.3664223e-7),Jmat.Complex(6.37479e-9,2.270476e-8),Jmat.Complex(-3.41142e-9,5.12289e-9),Jmat.Complex(-1.62203e-9,3.1619e-10),Jmat.Complex(-3.8743e-10,-2.7282e-10),Jmat.Complex(-1.201e-11,-1.344e-10),Jmat.Complex(2.57e-11,-2.543e-11),Jmat.Complex(9.35e-12,4.5e-13),Jmat.Complex(1.7e-12,1.86e-12),Jmat.Complex(-5e-14,7.1e-13),Jmat.Complex(-1.6e-13,1.2e-13),Jmat.Complex(-5e-14,-1e-14),Jmat.Complex(-1e-14,-1e-14)],o=[Jmat.Complex(.31813150520476413,1.3372357014306895),Jmat.Complex(1),Jmat.Complex(-.15131489715565175,-.2967488367322413),Jmat.Complex(-.03697630940906762,.09873054431149697),Jmat.Complex(.02581159797314014,-.017386962126530753),Jmat.Complex(-.0079444196,.00057925018)],l=function(t){var a=Jmat.Complex(1.077961437528,-.94654096394782),r=Jmat.Complex(.12233176,-.02366108),e=o[0],m=Jmat.Complex.exp(e.mul(t).add(a)),n=r.mul(m).mul(Jmat.Complex.exp(t.mul(Jmat.Complex.newi(2*Math.PI))));return Jmat.Complex.powerSeries(o,o.length,Jmat.Complex.ZERO,m).add(n)},u=Jmat.Complex(Jmat.Real.fracn(a.re),a.im);return m=a.im<-4.5?l(u.conj()).conj():a.im<-1.5?Jmat.Complex.powerSeries(i,i.length,Jmat.Complex.newi(3),u.conj()).conj():a.im<1.5?Jmat.Complex.log(u.addr(2)).add(Jmat.Complex.powerSeries(n,n.length,Jmat.Complex.ZERO,u)):a.im<4.5?Jmat.Complex.powerSeries(i,i.length,Jmat.Complex.newi(3),u):l(u),a.re>0?e(t,m,Math.floor(a.re),!1):e(t,m,-Math.ceil(a.re),!0)}return Jmat.Complex(NaN)},Jmat.Complex.erf_inv=function(t){if(0!=t.im&&Math.abs(t.re)>1){var a=function(t){return Jmat.Complex.TWO.divr(Jmat.Real.SQRTPI).mul(Jmat.Complex.exp(t.mul(t).neg()))},r=t.re<0;r&&(t=t.neg());var e=Jmat.Complex.sqrt(Jmat.Complex.log(t.mulr(Jmat.Real.SQRTPI).mul(Jmat.Complex.ONE.sub(t))).neg()),m=Jmat.Complex.finvert_newton(t,Jmat.Complex.erf,a,e);return r&&(m=m.neg()),m}if(0==t.im){if(0==t.re)return Jmat.Complex(0);if(1==t.re)return Jmat.Complex(1/0);if(-1==t.re)return Jmat.Complex(-(1/0))}var n=[.886226899,-1.645349621,.914624893,-.140543331],i=[1,-2.118377725,1.442710462,-.329097515,.012229801],o=[-1.970840454,-1.62490649,3.429567803,1.641345311],l=[1,3.5438892,1.6370678],u=t.abs();if(.7>=u){var J=t.mul(t),s=t.mul(J.mulr(n[3]).addr(n[2]).mul(J).addr(n[1]).mul(J).addr(n[0]));s=s.div(J.mulr(i[4]).addr(i[3]).mul(J).addr(i[2]).mul(J).addr(i[1]).mul(J).addr(i[0]))}else{var p=Jmat.Complex.sqrt(Jmat.Complex.log(Jmat.Complex.ONE.sub(t).divr(2)).neg()),s=p.mulr(o[3]).addr(o[2]).mul(p).addr(o[1]).mul(p).addr(o[0]);s=s.div(p.mulr(l[2]).addr(l[1]).mul(p).addr(l[0]))}return s},Jmat.Complex.erfc_inv=function(t){return Jmat.Complex.erf_inv(Jmat.Complex.ONE.sub(t))},Jmat.Complex.minkowski=function(t){return Jmat.Complex(Jmat.Real.minkowski(t.re),Jmat.Real.minkowski(t.im))},Jmat.Complex.rootfind_bisection=function(t,a,r,e,m){var n=void 0==e?256:e,i=void 0==m?1e-9:m,o=t.re,l=a.re;if(o>l){var u=o;o=l,l=u}if(l-o==1/0)return Jmat.Complex(NaN);for(var J=NaN,s=NaN,p=0,x=0,f=0;n>f;f++){var c=o+f*(l-o)/n,C=r(Jmat.Complex(c)).re;if(Jmat.Real.near(C,0,i))return Jmat.Complex(c);C>p&&(J=c,p=C),x>C&&(s=c,x=C)}if(s!=s||J!=J)return Jmat.Complex(NaN);for(;;){var c=(s+J)/2,C=r(Jmat.Complex(c)).re;if(Jmat.Real.near(C,0,i))return Jmat.Complex(c);if(C>0&&(J=c),0>C&&(s=c),Jmat.Real.near(s,J,i))return Jmat.Complex(NaN)}},Jmat.Complex.rootfind_secant=function(t,a,r,e,m){e=e||30,m=m||1e-15;for(var n=r(t),i=r(a),o=0;e>o;o++){var l=t.mul(i).sub(a.mul(n)).div(i.sub(n));Jmat.Complex.isInfOrNaN(l);var u=r(l);if(Jmat.Real.near(u,0,m))return l;t=a,n=i,a=l,i=u}return a},Jmat.Complex.rootfind=function(t,a){a||(a={});var r=a.z0||Jmat.Complex.ZERO,e=a.maxit||30,m=void 0==a.prec?1e-9:a.prec;return a.real&&void 0!=a.z1?Jmat.Complex.rootfind_bisection(r,a.z1,t,e,m):a.df?Jmat.Complex.rootfind_newton(t,a.df,r,e):Jmat.Complex.rootfind_newton_noderiv(t,r,e)},Jmat.Complex.newtonStartValues_=[Jmat.Complex(0),Jmat.Complex(.1),Jmat.Complex(-.1),Jmat.Complex.newi(.1),Jmat.Complex.newi(-.1),Jmat.Complex(.1,.1),Jmat.Complex(.1,-.1),Jmat.Complex(-.1,.1),Jmat.Complex(-.1,-.1),Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)],Jmat.Complex.newtonStartValue_=function(t){for(var a=Jmat.Complex.newtonStartValues_,r=1/0,e=Jmat.Complex(NaN),m=0;m<a.length;m++){var n=a[m],i=t(n),o=Jmat.Complex.manhattan(i,Jmat.Complex.ZERO);r>o&&(r=o,e=n)}return e},Jmat.Complex.newtonStartValuesAround_=[Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)],Jmat.Complex.newtonStartValueAround_=function(t,a,r){for(var e=Jmat.Complex.newtonStartValuesAround_,m=1/0,n=Jmat.Complex(NaN),i=0;i<e.length;i++){var o=a.add(e[i].mulr(r)),l=t(o),u=Jmat.Complex.manhattan(l,Jmat.Complex.ZERO);m>u&&(m=u,n=o)}return n},Jmat.Complex.rootfind_newton=function(t,a,r,e){r||(r=Jmat.Complex.ZERO),e||(e=30);for(var m=r,n=m,i=1/0,o=Jmat.Complex(NaN),l=0;e>l;l++){
var u=t(m),J=Jmat.Complex.manhattan(u,Jmat.Complex.ZERO);if(Jmat.Real.near(J,0,1e-15))return m;i>J&&(i=J,o=m);var s=m.sub(u.div(a(m)));if(Jmat.Complex.isInfOrNaN(s)){var J=Jmat.Complex.manhattan(m,n);s=Jmat.Complex.newtonStartValueAround_(t,m,J?J:.1)}m=s,n=m}return o},Jmat.Complex.rootfind_newton_noderiv=function(t,a,r){return Jmat.Complex.rootfind_newton(t,function(a){return Jmat.Complex.differentiate_stencil5(a,t)},a,r)},Jmat.Complex.finvert_newton=function(t,a,r,e,m){return Jmat.Complex.rootfind_newton(function(r){return a(r).sub(t)},r,e,m)},Jmat.Complex.finvert_newton_noderiv=function(t,a,r,e){return Jmat.Complex.rootfind_newton_noderiv(function(r){return a(r).sub(t)},r,e)},Jmat.Real.integrate_simpson=function(t,a,r,e,m){for(var n=(a-t)/r,i=0,o=0,l=0;r>=l;l++){var u=t+(l-1)*n,J=t+l*n,s=e((u+J)/2),p=e(J);if(l>0&&(i+=(J-u)/6*(o+4*s+p)),o=p,m&&l%50==49&&m())return NaN}return i},Jmat.Real.integrate=function(t,a,r,e){return e||(e=30),Jmat.Real.integrate_simpson(t,a,e,r)},Jmat.Complex.integrate_simpson=function(t,a,r,e,m){for(var n,i,o=a.sub(t).divr(r),l=Jmat.Complex(0),u=null,J=0;r>=J;J++){a.eqr(1/0)?(n=i?i:t,i=i?i.mulr(2):t.addr(.1)):(n=t.add(o.mulr(J-1)),i=t.add(o.mulr(J)));var s=e(n.add(i).divr(2)),p=e(i);if(J>0){var x=i.sub(n).divr(6).mul(u.add(s.mulr(4)).add(p));l=l.add(x)}if(u=p,m&&J%50==49&&m())return Jmat.Complex(NaN)}return l},Jmat.Complex.integrate=function(t,a,r,e){return e||(e=30),Jmat.Complex.integrate_simpson(t,a,e,r)},Jmat.Complex.differentiate_newton_noderiv=function(t,a){var r=Math.max(.01,Math.abs(t.re))/1e3,e=a(t.addr(r/2)),m=a(t.subr(r/2));return e.sub(m).divr(r)},Jmat.Complex.differentiate_stencil5=function(t,a){var r=Math.max(.01,Math.abs(t.re))/1e3,e=a(t.addr(2*r)).neg(),m=a(t.addr(r)).mulr(8),n=a(t.subr(r)).mulr(-8),i=a(t.subr(2*r));return e.add(m).add(n).add(i).divr(12*r)},Jmat.Complex.differentiate2nd_stencil5=function(t,a){var r=Jmat.Complex(Math.max(.01,Math.abs(t.re))/1e3),e=a(t.add(r.mulr(2))).neg(),m=a(t.add(r)).mulr(16),n=a(t).mulr(-30),i=a(t.sub(r)).mulr(16),o=a(t.sub(r.mulr(2))).neg();return e.add(m).add(n).add(i).add(o).div(r.mul(r).mulr(12))},Jmat.Complex.differentiate=function(t,a){return Jmat.Complex.differentiate_stencil5(t,a)},Jmat.Complex.doSummation=function(t,a,r,e,m){if(0==r)return Jmat.Complex(NaN);if(0>r)return Jmat.Complex(NaN);if(!Jmat.Complex.isReal(t)||!Jmat.Complex.isReal(a))return Jmat.Complex(NaN);for(var n=t.re,o=a.re,l=Jmat.Complex(0),u=n;o+r/4>=u;u+=r){var J=e(Jmat.Complex(u));if(l=l.add(J),m&&i%50==49&&m())return Jmat.Complex(NaN)}return l},Jmat.Complex.doProduct=function(t,a,r,e,m){if(0==r)return Jmat.Complex(NaN);if(0>r)return Jmat.Complex(NaN);if(!Jmat.Complex.isReal(t)||!Jmat.Complex.isReal(a))return Jmat.Complex(NaN);for(var n=t.re,o=a.re,l=Jmat.Complex.ONE,u=n;o+r/4>=u;u+=r){var J=e(Jmat.Complex(u));if(l=l.mul(J),m&&i%50==49&&m())return Jmat.Complex(NaN)}return l},Jmat.Complex.powerSeries=function(t,a,r,e){for(var m=void 0==t[0].re,n=Jmat.Complex.ZERO,i=Jmat.Complex.ONE,o=0;a>o;o++)n=m?n.add(i.mulr(t[o])):n.add(i.mul(t[o])),i=i.mul(e.sub(r));return n},Jmat.Complex.pdf_uniform=function(t,a,r){return t.re>=a.re&&t.re<=r.re?r.sub(a).inv():Jmat.Complex(0)},Jmat.Complex.cdf_uniform=function(t,a,r){return t.re<a.re?Jmat.Complex(0):t.re<r.re?t.sub(a).div(r.sub(a)):Jmat.Complex(1)},Jmat.Complex.qf_uniform=function(t,a,r){var e=a.add(t.mul(r.sub(a)));return e.re>=a.re&&e.re<=r.re?e:Jmat.Complex(NaN)},Jmat.Complex.pdf_standardnormal=function(t){return Jmat.Complex.exp(t.mul(t).mulr(-.5)).mul(Jmat.Complex.INVSQRT2PI)},Jmat.Complex.cdf_standardnormal=function(t){return Jmat.Complex.erf(t.div(Jmat.Complex.SQRT2)).addr(1).mulr(.5)},Jmat.Complex.qf_standardnormal=function(t){return Jmat.Complex.erf_inv(t.mulr(2).subr(1)).mul(Jmat.Complex.SQRT2)},Jmat.Complex.pdf_normal=function(t,a,r){var e=Jmat.Complex.INVSQRT2PI.div(r),m=t.sub(a).mul(t.sub(a)).div(r.mul(r).mulr(2));return e.mul(Jmat.Complex.exp(m.neg()))},Jmat.Complex.cdf_normal=function(t,a,r){var e=t.sub(a).divr(r.abs()).div(Jmat.Complex.SQRT2);return Jmat.Complex.erf(e).addr(1).mulr(.5)},Jmat.Complex.qf_normal=function(t,a,r){return Jmat.Complex.exp(a.add(r.mul(Jmat.Complex.qf_standardnormal(t))))},Jmat.Complex.pdf_lognormal=function(t,a,r){var e=Jmat.Complex.INVSQRT2PI.div(r).div(t),m=Jmat.Complex.log(t).sub(a);return e.mul(Jmat.Complex.exp(m.mul(m).div(r.mul(r).mulr(2)).neg()))},Jmat.Complex.cdf_lognormal=function(t,a,r){var e=Jmat.Complex.log(t).sub(a).div(Jmat.Complex.SQRT2.mul(r));return Jmat.Complex.erf(e).addr(1).mulr(.5)},Jmat.Complex.qf_lognormal=function(t,a,r){var e=Jmat.Complex.log(t).sub(a).div(Jmat.Complex.SQRT2.mul(r));return Jmat.Complex.erf(e).addr(1).mulr(.5)},Jmat.Complex.pdf_cauchy=function(t,a,r){var e=t.sub(a),m=e.mul(e).add(r.mul(r)).mulr(Math.PI);return r.div(m)},Jmat.Complex.cdf_cauchy=function(t,a,r){return Jmat.Complex.atan(t.sub(a).div(r)).divr(Math.PI).addr(.5)},Jmat.Complex.qf_cauchy=function(t,a,r){return a.add(r.mul(Jmat.Complex.tan(t.subr(.5).divr(Math.PI))))},Jmat.Complex.pdf_studentt_cache_=[],Jmat.Complex.pdf_studentt_cachefun_=function(t){var a=t.inc().divr(2);return Jmat.Complex.gammaDiv_(a,t.divr(2))},Jmat.Complex.pdf_studentt=function(t,a){if(a.eqr(1))return t.mul(t).addr(1).mulr(Math.PI).inv();if(a.eqr(2))return t.mul(t).addr(2).powr(1.5).inv();if(a.eqr(3)){var r=10.392304845413264,e=t.mul(t).addr(3);return Jmat.Complex(r).div(e.mul(e).mulr(Math.PI))}if(a.eqr(1/0))return Jmat.Complex.pdf_standardnormal(t);var m=a.inc().divr(2),n=Jmat.Complex.calcCache_(a,Jmat.Complex.pdf_studentt_cachefun_,Jmat.Complex.pdf_studentt_cache_),i=Jmat.Complex.sqrt(Jmat.Complex.PI.mul(a)).inv(),o=n.mul(i);Jmat.Complex.isNaN(o)&&a.re>100&&(o=Jmat.Complex(Jmat.Complex.INVSQRT2PI));var l=t.mul(t).div(a).inc();return o.mul(l.pow(m.neg()))},Jmat.Complex.cdf_studentt=function(t,a){if(a.eqr(1))return Jmat.Complex.atan(t).divr(Math.PI).addr(.5);if(a.eqr(2))return t.div(Jmat.Complex.sqrt(t.mul(t).addr(2)).mulr(2)).addr(.5);if(a.eqr(1/0))return Jmat.Complex.cdf_standardnormal(t);if(t.eqr(0))return Jmat.Complex(.5);var r=Jmat.Complex.calcCache_(a,Jmat.Complex.pdf_studentt_cachefun_,Jmat.Complex.pdf_studentt_cache_),e=Jmat.Complex.incbeta(t.mul(t).div(a).neg(),Jmat.Complex(.5),Jmat.Complex.ONE.sub(a).mulr(.5)),m=Jmat.Complex.I.mul(t).mul(e),n=Jmat.Complex(t.abs()).mulr(2).mul(Jmat.Complex.SQRTPI);return Jmat.Complex(.5).sub(r.mul(m).div(n))},Jmat.Complex.qf_studentt=function(t,a){if(a.eqr(1))return Jmat.Complex.tan(Jmat.Complex.PI.mul(t.subr(.5)));if(a.eqr(2)){var r=t.mulr(4).mul(Jmat.Complex.ONE.sub(t));return t.subr(.5).mulr(2).mul(Jmat.Complex.sqrt(Jmat.Complex(2).div(r)))}if(a.eqr(4)&&Jmat.Complex.isReal(t)){var r=t.mulr(4).mul(Jmat.Complex.ONE.sub(t)),e=Jmat.Complex.sqrt(r),m=Jmat.Complex.cos(Jmat.Complex(1/3).mul(Jmat.Complex.acos(e))).div(e);return Jmat.Complex.sign(t.subr(.5)).mulr(2).mul(Jmat.Complex.sqrt(m.dec()))}if(a.eqr(1/0))return Jmat.Complex.qf_standardnormal(t);if(Jmat.Real.near(t.im,0,1e-15)&&(t=Jmat.Complex(t.re)),Jmat.Real.near(a.im,0,1e-15)&&(a=Jmat.Complex(a.re)),Jmat.Complex.isPositive(a)&&Jmat.Complex.isPositive(t)&&t.re<1){if(t.re<.5){var n=Jmat.Complex.beta_i_inv(t.mulr(2),a.divr(2),Jmat.Complex(.5));return Jmat.Complex.sqrt(a.mul(n.inv().subr(1))).neg()}var n=Jmat.Complex.beta_i_inv(Jmat.Complex.ONE.sub(t).mulr(2),a.divr(2),Jmat.Complex(.5));return Jmat.Complex.sqrt(a.mul(n.inv().subr(1)))}return Jmat.Complex(NaN)},Jmat.Complex.pdf_chi_square=function(t,a){var r=a.divr(2),e=r.eqr(1)?Jmat.Complex(2):Jmat.Complex(2).pow(r),m=Jmat.Complex.isNegativeInt(r)?Jmat.Complex(1/0):Jmat.Complex.gamma(r),n=t.pow(r.dec()).mul(Jmat.Complex.exp(t.divr(-2)));return e.mul(m).inv().mul(n)},Jmat.Complex.cdf_chi_square=function(t,a){return Jmat.Complex.gamma_p(a.divr(2),t.divr(2))},Jmat.Complex.qf_chi_square=function(t,a){return Jmat.Complex.gamma_p_inv(a.divr(2),t).mulr(2)},Jmat.Complex.pdf_logistic=function(t,a,r){var e=Jmat.Complex.exp(t.sub(a).div(r).neg()),m=e.inc();return e.div(r.mul(m).mul(m))},Jmat.Complex.cdf_logistic=function(t,a,r){return Jmat.Complex.tanh(t.sub(a).div(r).divr(2)).mulr(.5).addr(.5)},Jmat.Complex.qf_logistic=function(t,a,r){var e=t.div(Jmat.Complex.ONE.sub(t));return a.add(r.mul(Jmat.Complex.log(e)))},Jmat.Complex.pdf_gamma_cache_=[],Jmat.Complex.pdf_gamma=function(t,a,r){var e=t.pow(a.dec()),m=Jmat.Complex.exp(t.div(r).neg()),n=r.pow(a),i=Jmat.Complex.calcCache_(a,Jmat.Complex.gamma,Jmat.Complex.pdf_gamma_cache_);return e.mul(m).div(n).div(i)},Jmat.Complex.cdf_gamma=function(t,a,r){return Jmat.Complex.gamma_p(a,t.div(r))},Jmat.Complex.qf_gamma=function(t,a,r){return Jmat.Complex.gamma_p_inv(a,t).mul(r)},Jmat.Complex.pdf_beta=function(t,a,r){var e=t.pow(a.dec()),m=t.rsub(1).pow(r.dec()),n=Jmat.Complex.beta(a,r);return e.mul(m).div(n)},Jmat.Complex.cdf_beta=function(t,a,r){return Jmat.Complex.beta_i(t,a,r)},Jmat.Complex.qf_beta=function(t,a,r){return Jmat.Complex.beta_i_inv(t,a,r)},Jmat.Complex.pdf_fisher=function(t,a,r){var e=a.mul(t).pow(a).mul(r.pow(r)),m=a.mul(t).add(r).pow(a.add(r)),n=t.mul(Jmat.Complex.beta(a.divr(2),r.divr(2)));return Jmat.Complex.sqrt(e.div(m)).div(n)},Jmat.Complex.cdf_fisher=function(t,a,r){var e=a.mul(t).div(a.mul(t).add(r));return Jmat.Complex.beta_i(e,a.divr(2),r.divr(2))},Jmat.Complex.qf_fisher=function(t,a,r){var e=Jmat.Complex.beta_i_inv(t,a.divr(2),r.divr(2)),m=Jmat.Complex.ONE.sub(e);return r.mul(e).div(a.mul(m))},Jmat.Complex.pdf_weibull=function(t,a,r){var e=r.div(a),m=t.div(a).pow(r.dec()),n=t.div(a).pow(r).neg();return e.mul(m).mul(Jmat.Complex.exp(n))},Jmat.Complex.cdf_weibull=function(t,a,r){var e=t.div(a).pow(r).neg();return Jmat.Complex.ONE.sub(Jmat.Complex.exp(e))},Jmat.Complex.qf_weibull=function(t,a,r){var e=Jmat.Complex.ONE.sub(t),m=Jmat.Complex.log(e).neg().pow(r.inv());return a.mul(m)},Jmat.Complex.pdf_exponential=function(t,a){return t.re<0?Jmat.Complex(0):a.mul(Jmat.Complex.exp(t.mul(a).neg()))},Jmat.Complex.cdf_exponential=function(t,a){return t.re<0?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.exp(t.mul(a).neg()))},Jmat.Complex.qf_exponential=function(t,a){return Jmat.Complex.log(t.rsub(1)).neg().div(a)},Jmat.Complex.pdf_laplace=function(t,a,r){var e=Jmat.Complex.exp(Jmat.Complex(t.sub(a).abs()).neg().div(r));return r.mulr(2).inv().mul(e)},Jmat.Complex.cdf_laplace=function(t,a,r){var e=Jmat.Complex.exp(Jmat.Complex(t.sub(a).abs()).neg().div(r)),m=Jmat.Complex.sign(t.sub(a));return e.rsub(1).mul(m).mulr(.5).addr(.5)},Jmat.Complex.qf_laplace=function(t,a,r){var e=Jmat.Complex.log(Jmat.Complex(t.subr(.5).abs()).mulr(2).rsub(1)),m=Jmat.Complex.sign(t.subr(.5));return a.sub(r.mul(m).mul(e))},Jmat.Complex.pmf_bernoulli=function(t,a){return t.eqr(0)?a.rsub(1):t.eqr(1)?a:a.pow(t).mul(a.rsub(1).pow(t.rsub(1)))},Jmat.Complex.cdf_bernoulli=function(t,a){return t.re<0?Jmat.Complex.ZERO:t.re>=1?Jmat.Complex.ONE:a.rsub(1)},Jmat.Complex.qf_bernoulli=function(t,a){return t.re<1-a.re?Jmat.Complex.ZERO:Jmat.Complex.ONE},Jmat.Complex.pmf_binomial=function(t,a,r){var e=Jmat.Complex.binomial(a,t);return e.mul(r.pow(t)).mul(r.rsub(1).pow(a.sub(t)))},Jmat.Complex.cdf_binomial=function(t,a,r){return Jmat.Complex.beta_i(r,a.sub(t),t.addr(1))},Jmat.Complex.qf_binomial=function(t,a,r){if(r.eqr(0))return Jmat.Complex.ZERO;if(r.eqr(1))return a;var e=Jmat.Complex,m=Jmat.Complex.rootfind_bisection(e(0),a,function(e){return Jmat.Complex.cdf_binomial(e,a,r).sub(t)},100,1e-14);return Jmat.Complex.round(m)},Jmat.Complex.pmf_poisson=function(t,a){var r=a.pow(t),e=Jmat.Complex.factorial(t),m=Jmat.Complex.exp(a.neg());return r.mul(m).div(e)},Jmat.Complex.cdf_poisson=function(t,a){return Jmat.Complex.gamma_q(t.addr(1),a)},Jmat.Complex.qf_poisson=function(t,a){return Jmat.Complex.gamma_q_inva(a,t).subr(1)},Jmat.BigInt=function(t,a,r){return this instanceof Jmat.BigInt?(this.a=t||[],this.radix=a||Jmat.BigInt.ARRAYBASE_,this.minus=r||!1,void 0):Jmat.BigInt.make(t,a,r)},Jmat.BigInt.ARRAYBASE_=32768,Jmat.BigInt.ARRAYBASE_BITS_=15,Jmat.BigInt.STRINGBASE_=10,Jmat.BigInt.make=function(t,a,r){return void 0==t?new Jmat.Bigum(t,a,r):"number"==typeof t?Jmat.BigInt.fromInt(t,a):"string"==typeof t?Jmat.BigInt.parse(t,Jmat.BigInt.STRINGBASE_,a):void 0!=t.length?new Jmat.BigInt(t,a,r):void 0!=t.re?Jmat.BigInt.fromInt(t.re,a):void 0!=t.w?Jmat.BigInt.fromInt(t.w,a):a&&t.radix!=a?Jmat.BigInt.convertBase(t,a):Jmat.BigInt.copy(t)},Jmat.BigInt.cast=function(t,a,r){return void 0==t?new Jmat.BigInt(void 0,a,r):void 0==t.a||a&&t.radix!=a?t.radix&&a?Jmat.BigInt.convertBase(t,a):Jmat.BigInt(t,a,r):t},Jmat.BigInt.copy=function(t){return new Jmat.BigInt(t.a.slice(0),t.radix,t.minus)},Jmat.BigInt.parse=function(t,a,r){var e=a||Jmat.BigInt.STRINGBASE_,m=r||Jmat.BigInt.ARRAYBASE_,n=!1;"-"==t[0]&&(n=!0,t=t.substr(1));var i=Jmat.BigInt.stringToArray(t,m,e);return new Jmat.BigInt(i,m,n)},Jmat.BigInt.toString=function(t,a){if(!t||!t.a)return"invalid";var r=t.minus?"-":"";return r+Jmat.BigInt.arrayToString(t.a,t.radix,a)},Jmat.BigInt.prototype.toString=function(t){return Jmat.BigInt.toString(this,t)},Jmat.BigInt.stringToArray=function(t,a,r){for(var e=a||Jmat.BigInt.ARRAYBASE_,m=r||Jmat.BigInt.STRINGBASE_,n=[],i=0;i<t.length;i++){var o=Jmat.BigInt.di_(t[i]);n[i]=o}return Jmat.BigInt.convertArrayBase(n,m,e)},Jmat.BigInt.arrayToString=function(t,a,r){var e=a||Jmat.BigInt.ARRAYBASE_,m=r||Jmat.BigInt.STRINGBASE_;t=Jmat.BigInt.convertArrayBase(t,e,m);for(var n="",i=0;i<t.length;i++)n+=Jmat.BigInt.d_[t[i]];return 0==t.length&&(n="0"),n},Jmat.BigInt.getInBaseTwoWithoutConvert_=function(t){for(var a=[];t>0;)a.push(1&t),t>>=1;return Jmat.BigInt.mirror_(a),new Jmat.BigInt(a,2)},Jmat.BigInt.convertArrayBase=function(t,a,r,e){if(t.length>8&&10==r&&Jmat.Real.isPOT(a)){var m=Jmat.BigInt.convertArrayBase(t,a,1e6);return Jmat.BigInt.convertArrayBase(m,1e6,10)}var n=Jmat.Real,i=Jmat.BigInt;if(a==r)return t;var o=[];if(t=i.maybecopystrip_(t),2147483648>=a&&2147483648>=r&&n.isPOT(a)&&n.isPOT(r)){for(var l=n.ilog2(a),u=n.ilog2(r),J=Math.ceil(t.length*l/u),s=0;J>s;s++)o[s]=0;if(r>a)for(var p=J-1,x=0,s=t.length-1;s>=0;s--)if(x+l>u){var m=u-x;0!=m&&(o[p]|=(t[s]&(1<<m)-1)<<x),p--,o[p]=t[s]>>m,x=l-m}else o[p]|=t[s]<<x,x+=l;else for(var f=r-1,p=t.length-1,x=0,s=J-1;s>=0;s--)if(x+u>l){var m=l-x;o[s]=t[p]>>x,p--,o[s]|=(t[p]&f)<<m,x=u-m}else o[s]|=t[p]>>x&f,x+=u;return i.stripInPlace_(o),o}var c=n.isPowerOf(a,r);if(c){for(var s=0;s<t.length;s++){for(var C=t[s],d=0;c>d;d++)o.push(Math.floor(C/(c-d-1))%r);for(var d=c-1;d>=0;d--)o[s*c+d]=C%r,C=Math.floor(C/r)}return i.stripInPlace_(o),o}if(c=n.isPowerOf(r,a)){for(var v=Math.ceil(t.length/c),s=0;v>s;s++){var g=1;o[v-1-s]=0;for(var d=0;c>d;d++){var h=t.length-1-s*c-d;if(0>h)break;o[v-1-s]+=t[h]*g,g*=a}}return i.stripInPlace_(o),o}if(t.length>8){for(var I=n.idiv(t.length,2),_=[],b=[],s=0;I>s;s++)_[s]=t[s];for(var s=I;s<t.length;s++)b[s-I]=t[s];var M=e||[],w=i.convertArrayBase(_,a,r,M),B=i.convertArrayBase(b,a,r,M),R=t.length-I,c=M[R];if(!c){var N=n.idiv(R,2),C=R-N,y=M[N],q=M[C];c=y&&q?y.mul(q):y?y.mul(i.pow(i(a,r),i.getInBaseTwoWithoutConvert_(C))):q?q.mul(i.pow(i(a,r),i.getInBaseTwoWithoutConvert_(N))):i.pow(i(a,r),i.getInBaseTwoWithoutConvert_(R))}return M[R]=c,i(B,r).add(i(w,r).mul(c)).a}for(var s=0;s<t.length;s++)o=i.baseloop_(o,0,a,[],0,1,t[s],r,!1);return 0==o.length&&(o=[0]),o},Jmat.BigInt.convertStringBase=function(t,a,r){if(a==r)return t;var e=Jmat.BigInt.stringToArray(t,r,a);return Jmat.BigInt.arrayToString(e,r,r)},Jmat.BigInt.baseloop_=function(t,a,r,e,m,n,i,o,l){var u=[],J=Math.max(t.length+a,e.length+m),s=t.length;if(e.length||a)if(0==a&&0==m&&1==r&&1==n)for(var p=0;J>p;p++)p<t.length&&(i+=t[t.length-p-1]),p<e.length&&(i+=e[e.length-p-1]),u[p]=(i+o)%o,i=Math.floor(i/o);else for(var p=0;J>p;p++)p>=a&&p<t.length+a&&(i+=r*t[t.length-p-1+a]),p>=m&&p<e.length+m&&(i+=n*e[e.length-p-1+m]),u[p]=(i+o)%o,i=Math.floor(i/o);else for(var p=0;J>p;p++)i+=r*t[t.length-p-1],u[p]=(i+o)%o,i=Math.floor(i/o);if(i==1/0)throw"infinite overflow";for(;i>0;)u.push((i+o)%o),i=Math.floor(i/o);if(l){for(;u.length>s&&0==u[u.length-1];)u.length--;for(;u.length<s;)u.push(0)}else for(;u.length>1&&0==u[u.length-1];)u.length--;return Jmat.BigInt.mirror_(u),u},Jmat.BigInt.intToArray=function(t,a){if(t>Jmat.Real.BIGGESTJSINT)throw"too large integer literal for JS";for(var r=a||Jmat.BigInt.ARRAYBASE_,e=[];t>0;)e.push(t%r),t=Math.floor(t/r);return 0==e.length&&(e=[0]),e.length>1&&Jmat.BigInt.mirror_(e),e},Jmat.BigInt.arrayToInt=function(t,a){for(var r=a||Jmat.BigInt.ARRAYBASE_,e=0,m=1,n=0;n<t.length;n++)if(e+=m*t[t.length-1-n],m*=r,e==1/0||m==1/0)return 1/0;return e},Jmat.BigInt.fromInt=function(t,a){var r=a||Jmat.BigInt.ARRAYBASE_,e=!1;return 0>t&&(e=!0,t=-t),new Jmat.BigInt(Jmat.BigInt.intToArray(t,r),r,e)},Jmat.BigInt.toInt=function(t){return Jmat.BigInt.arrayToInt(t.a,t.radix)*(t.minus?-1:1)},Jmat.BigInt.prototype.toInt=function(){return Jmat.BigInt.arrayToInt(this.a,this.radix)*(this.minus?-1:1)},Jmat.BigInt.ZERO=Jmat.BigInt(0),Jmat.BigInt.ONE=Jmat.BigInt(1),Jmat.BigInt.TWO=Jmat.BigInt(2),Jmat.BigInt.convertBase=function(t,a){return t.radix==a?t:new Jmat.BigInt(Jmat.BigInt.convertArrayBase(t.a,t.radix,a),a,t.minus)},Jmat.BigInt.cloneArray=function(t){return t.slice(0)},Jmat.BigInt.cloneArrayTo=function(t,a){a.length=t.length;for(var r=0;r<t.length;r++)a[r]=t[r]},Jmat.BigInt.lshift_radix=function(t,a){if(0==a)return t;if(0>a)return Jmat.BigInt.rshift_radix(t,-a);for(var r=Jmat.BigInt.copy(t),e=0;a>e;e++)r.a.push(0);return r},Jmat.BigInt.prototype.lshift_radix=function(t){return Jmat.BigInt.lshift_radix(this,t)},Jmat.BigInt.rshift_radix=function(t,a){if(0==a)return t;if(0>a)return Jmat.BigInt.lshift_radix(t,-a);var r=Jmat.BigInt.copy(t);return r.a=r.a.slice(0,-a),r},Jmat.BigInt.prototype.rshift_radix=function(t){return Jmat.BigInt.rshift_radix(this,t)},Jmat.BigInt.lshift=function(t,a){var r=Jmat.BigInt;if(0==a)return t;if(0>a)return r.rshift(t,-a);t=r.cast(t,Jmat.BigInt.ARRAYBASE_);var e=new r([],t.radix),m=Math.floor(a/r.ARRAYBASE_BITS_),n=a%r.ARRAYBASE_BITS_;if(0==n){for(var i=0;i<t.a.length;i++)e.a[i]=t.a[i];for(var i=0;m>i;i++)e.a.push(0)}else{e.a=[];for(var o=(1<<r.ARRAYBASE_BITS_-n)-1<<n,l=(1<<n)-1,i=0;i<=t.a.length;i++){var u=i>0?t.a[i-1]:0,J=i<t.a.length?t.a[i]:0,s=J<<n>>r.ARRAYBASE_BITS_&l,p=u<<n&o,x=p|s;(x||e.a.length)&&e.a.push(x)}for(var i=0;m>i;i++)e.a.push(0);0==e.a.length&&(e.a=[0])}return t.minus&&(e=e.neg()),e},Jmat.BigInt.prototype.lshift=function(t){return Jmat.BigInt.lshift(this,t)},Jmat.BigInt.rshift=function(t,a){var r=Jmat.BigInt;if(0==a)return t;if(0>a)return r.lshift(t,-a);t=r.cast(t,Jmat.BigInt.ARRAYBASE_);var e=new r([],t.radix),m=Math.floor(a/r.ARRAYBASE_BITS_),n=a%r.ARRAYBASE_BITS_;if(0==n){e.a=[];for(var i=0;i<t.a.length-m;i++)e.a.push(t.a[i]);0==e.a.length&&(e.a=[0])}else{e.a=[];for(var o=(1<<n)-1<<r.ARRAYBASE_BITS_-n,l=(1<<r.ARRAYBASE_BITS_-n)-1,i=0;i<t.a.length-m;i++){var u=i>0?t.a[i-1]:0,J=i<t.a.length?t.a[i]:0,s=u<<r.ARRAYBASE_BITS_>>n&o,p=J>>n&l;e.a.push(s|p)}0==e.a.length&&(e.a=[0])}return t.minus&&(e=e.neg()),r.stripInPlace_(e.a),e},Jmat.BigInt.prototype.rshift=function(t){return Jmat.BigInt.rshift(this,t)},Jmat.BigInt.bitand=function(t,a){var r=Jmat.BigInt;if(t=r.cast(t,r.ARRAYBASE_),a=r.cast(a,r.ARRAYBASE_),t.minus||a.minus){var e=Math.max(r.getNumBits(t),r.getNumBits(a));t.minus&&(t=t.addr(1).bitnot(e)),a.minus&&(a=a.addr(1).bitnot(e))}for(var m=new r([],r.ARRAYBASE_),n=Math.min(t.a.length,a.a.length),i=0;n>i;i++){var o=t.a[t.a.length-1-i]||0,l=a.a[a.a.length-1-i]||0;m.a[n-1-i]=o&l}return m},Jmat.BigInt.prototype.bitand=function(t){return Jmat.BigInt.bitand(this,t)},Jmat.BigInt.bitandr=function(t,a){var r=Jmat.BigInt;return t.minus?r.bitand(t,r(a)).toInt():(t=r.cast(t,a<r.ARRAYBASE_?r.ARRAYBASE_:2147483648),t.a[t.a.length-1]&a)},Jmat.BigInt.bitor=function(t,a){var r=Jmat.BigInt;if(t=r.cast(t,r.ARRAYBASE_),a=r.cast(a,r.ARRAYBASE_),t.minus||a.minus){var e=Math.max(r.getNumBits(t),r.getNumBits(a));t.minus&&(t=t.addr(1).bitnot(e)),a.minus&&(a=a.addr(1).bitnot(e))}for(var m=new r([],r.ARRAYBASE_),n=Math.max(t.a.length,a.a.length),i=0;n>i;i++){var o=t.a[t.a.length-1-i]||0,l=a.a[a.a.length-1-i]||0;m.a[n-1-i]=o|l}return m},Jmat.BigInt.prototype.bitor=function(t){return Jmat.BigInt.bitor(this,t)},Jmat.BigInt.bitxor=function(t,a){var r=Jmat.BigInt;if(t=r.cast(t,r.ARRAYBASE_),a=r.cast(a,r.ARRAYBASE_),t.minus||a.minus){var e=Math.max(r.getNumBits(t),r.getNumBits(a));t.minus&&(t=t.addr(1).bitnot(e)),a.minus&&(a=a.addr(1).bitnot(e))}for(var m=new r([],r.ARRAYBASE_),n=Math.max(t.a.length,a.a.length),i=0;n>i;i++){var o=t.a[t.a.length-1-i]||0,l=a.a[a.a.length-1-i]||0;m.a[n-1-i]=o^l}return m},Jmat.BigInt.prototype.bitxor=function(t){return Jmat.BigInt.bitxor(this,t)},Jmat.BigInt.bitneg=function(t){var a=Jmat.BigInt;return t=a.cast(t,Jmat.BigInt.ARRAYBASE_),t=t.addr(1),t=t.neg()},Jmat.BigInt.prototype.bitneg=function(){return Jmat.BigInt.bitneg(this)},Jmat.BigInt.bitnot=function(t,a){if(0>=a)return t;var r=Jmat.BigInt;t=r.cast(t,r.ARRAYBASE_);var e,m=r.maybecopystrip_(t.a),n=r.ARRAYBASE_-1;if(void 0!=a){e=r(0);for(var i=a%r.ARRAYBASE_BITS_,o=Math.ceil(a/r.ARRAYBASE_BITS_),l=(1<<i)-1,u=0;o>u;u++){var J=m[m.length-o+u]||0;e.a[u]=J^n,0==u&&0!=i&&(e.a[u]&=l)}}else{if(!m.length)return t;var i=Jmat.Real.ilog2(m[0])+1;if(0==i){e=r(1);for(var u=0;u<m.length;u++)e.a.push(m[u]^n)}else{var l=(2<<i)-1;e=r(0),e.a[0]=(m[0]^n)&l;for(var u=1;u<m.length;u++)e.a[u]=m[u]^n}}return e.minus=t.minus,e},Jmat.BigInt.prototype.bitnot=function(t){return Jmat.BigInt.bitnot(this,t)},Jmat.BigInt.abs=function(t){return t.abs()},Jmat.BigInt.prototype.abs=function(){return this.minus?new Jmat.BigInt(this.a,this.radix,!1):this},Jmat.BigInt.neg=function(t){return t.neg()},Jmat.BigInt.prototype.neg=function(){return new Jmat.BigInt(this.a,this.radix,!this.minus)},Jmat.BigInt.getSign=function(t){return t.getSign()},Jmat.BigInt.prototype.getSign=function(){return this.minus?-1:1},Jmat.BigInt.nonZero=function(t){return t.nonZero()},Jmat.BigInt.prototype.nonZero=function(){for(var t=0;t<this.a.length;t++)if(this.a[t])return!0;return!1},Jmat.BigInt.sign=function(t){return t.sign()},Jmat.BigInt.prototype.sign=function(){return this.nonZero()?this.getSign():0},Jmat.BigInt.add=function(t,a){return t.add(a)},Jmat.BigInt.prototype.add=function(t){return this.minus!=t.minus?this.sub(t.neg()):(t=Jmat.BigInt.cast(t,this.radix),new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,t.a,0,1,0,this.radix,!1),this.radix,this.minus))},Jmat.BigInt.addr=function(t,a){return t.addr(a)},Jmat.BigInt.prototype.addr=function(t){return this.add(Jmat.BigInt.fromInt(t))},Jmat.BigInt.sub=function(t,a){return t.sub(a)},Jmat.BigInt.prototype.sub=function(t){return this.minus!=t.minus?this.add(t.neg()):(t=Jmat.BigInt.cast(t,this.radix),this.abs().gte(t.abs())?new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,t.a,0,-1,0,this.radix,!1),this.radix,this.minus):new Jmat.BigInt(Jmat.BigInt.baseloop_(t.a,0,1,this.a,0,-1,0,this.radix,!1),this.radix,!this.minus))},Jmat.BigInt.subr=function(t,a){return t.subr(a)},Jmat.BigInt.prototype.subr=function(t){return this.sub(Jmat.BigInt.fromInt(t))},Jmat.BigInt.mul=function(t,a){return t.mul(a)},Jmat.BigInt.prototype.mul=function(t){t=Jmat.BigInt.cast(t,this.radix);var a=Jmat.BigInt.karatsuba_(this.strip().a,t.strip().a,this.radix);return new Jmat.BigInt(a,this.radix,this.minus!=t.minus)},Jmat.BigInt.mulr=function(t,a){var r=new Jmat.BigInt([],t.radix,t.minus!=0>a);return r.a=Jmat.BigInt.baseloop_(t.a,0,a,[],0,1,0,r.radix,!1),r},Jmat.BigInt.prototype.mulr=function(t){var a=new Jmat.BigInt([],this.radix,this.minus!=0>t);return a.a=Jmat.BigInt.baseloop_(this.a,0,t,[],0,1,0,a.radix,!1),a},Jmat.BigInt.karatsuba_=function(t,a,r){if(t.length<=1||a.length<=1)return Jmat.BigInt.schoolmul_(t,a,r);if(t.length<a.length)return Jmat.BigInt.karatsuba_(a,t,r);if(t.length<=20)return Jmat.BigInt.schoolmul_(t,a,r);var e=Math.floor(t.length/2),m=a.length-(t.length-e),n=t.slice(0,e),i=t.slice(e,t.length),o=0>=m?[0]:a.slice(0,m),l=0>=m?a:a.slice(m,a.length);if(0>=m){var u=Jmat.BigInt.karatsuba_(n,l,r),J=Jmat.BigInt.karatsuba_(i,l,r);return Jmat.BigInt.baseloop_(u,t.length-e,1,J,0,1,0,r,!1)}var s=Jmat.BigInt.baseloop_(n,0,1,i,0,1,0,r,!1),p=Jmat.BigInt.baseloop_(o,0,1,l,0,1,0,r,!1),u=Jmat.BigInt.karatsuba_(n,o,r),J=Jmat.BigInt.karatsuba_(i,l,r),x=Jmat.BigInt.karatsuba_(s,p,r),f=Jmat.BigInt.baseloop_(u,0,1,J,0,1,0,r,!1),c=Jmat.BigInt.baseloop_(x,0,1,f,0,-1,0,r,!1),C=t.length-e,d=2*C,v=Jmat.BigInt.baseloop_(c,C,1,J,0,1,0,r,!1);return Jmat.BigInt.baseloop_(u,d,1,v,0,1,0,r,!1)},Jmat.BigInt.schoolmul_=function(t,a,r){if(1==t.length&&0==t[0])return[0];if(1==t.length&&1==t[0])return a;if(1==a.length&&0==a[0])return[0];if(1==a.length&&1==a[0])return t;if(t.length<a.length)return Jmat.BigInt.schoolmul_(a,t,r);for(var e=[0],m=0,n=0;n<a.length;n++){var i=a[a.length-n-1];e=Jmat.BigInt.baseloop_(t,m,i,e,0,1,0,r,!1),m++}return e},Jmat.BigInt.compare=function(t,a){return t.compare(a)},Jmat.BigInt.prototype.compare=function(t){if(t.minus!=this.minus){var a=this.sign(),r=t.sign();return a==r?0:r>a?-1:1}t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix));for(var e=Math.max(this.a.length,t.a.length),m=0;e>m;m++){var n=m-e+this.a.length,i=m-e+t.a.length,o=this.a[n]||0,l=t.a[i]||0;if(l>o)return-1*this.getSign();if(o>l)return 1*this.getSign()}return 0},Jmat.BigInt.comparer=function(t,a){return t.comparer(a)},Jmat.BigInt.prototype.comparer=function(t){if(0>t!=this.minus){var a=this.sign(),r=Math.sign(t);return a==r?0:r>a?-1:1}var e=this.getSign();t=Math.abs(t);for(var m=0,n=0;n<this.a.length&&t>=m;n++)m*=this.radix,m+=this.a[n];return(t>m?-1:m==t?0:1)*e},Jmat.BigInt.eq=function(t,a){return 0==Jmat.BigInt.compare(t,a)},Jmat.BigInt.prototype.eq=function(t){return 0==Jmat.BigInt.compare(this,t)},Jmat.BigInt.eqr=function(t,a){return 0==Jmat.BigInt.comparer(t,a)},Jmat.BigInt.prototype.eqr=function(t){return 0==Jmat.BigInt.comparer(this,t)},Jmat.BigInt.neq=function(t,a){return 0!=Jmat.BigInt.compare(t,a)},Jmat.BigInt.prototype.neq=function(t){return 0!=Jmat.BigInt.compare(this,t)},Jmat.BigInt.neqr=function(t,a){return 0!=Jmat.BigInt.comparer(t,a)},Jmat.BigInt.prototype.neqr=function(t){return 0!=Jmat.BigInt.comparer(this,t)},Jmat.BigInt.gt=function(t,a){return Jmat.BigInt.compare(t,a)>0},Jmat.BigInt.prototype.gt=function(t){return Jmat.BigInt.compare(this,t)>0},Jmat.BigInt.gtr=function(t,a){return Jmat.BigInt.comparer(t,a)>0},Jmat.BigInt.prototype.gtr=function(t){return Jmat.BigInt.comparer(this,t)>0},Jmat.BigInt.lt=function(t,a){return Jmat.BigInt.compare(t,a)<0},Jmat.BigInt.prototype.lt=function(t){return Jmat.BigInt.compare(this,t)<0},Jmat.BigInt.ltr=function(t,a){return Jmat.BigInt.comparer(t,a)<0},Jmat.BigInt.prototype.ltr=function(t){return Jmat.BigInt.comparer(this,t)<0},Jmat.BigInt.gte=function(t,a){return Jmat.BigInt.compare(t,a)>=0},Jmat.BigInt.prototype.gte=function(t){return Jmat.BigInt.compare(this,t)>=0},Jmat.BigInt.gter=function(t,a){return Jmat.BigInt.comparer(t,a)>=0},Jmat.BigInt.prototype.gter=function(t){return Jmat.BigInt.comparer(this,t)>=0},Jmat.BigInt.lte=function(t,a){return Jmat.BigInt.compare(t,a)<=0},Jmat.BigInt.prototype.lte=function(t){return Jmat.BigInt.compare(this,t)<=0},Jmat.BigInt.lter=function(t,a){return Jmat.BigInt.comparer(t,a)<=0},Jmat.BigInt.prototype.lter=function(t){return Jmat.BigInt.comparer(this,t)<=0},Jmat.BigInt.sqrt=function(t){var a=Jmat.BigInt;if(t.eqr(0))return a(0);if(t.minus)return void 0;var r=a([0],t.radix),e=Jmat.BigInt.copystrip_(t);1==e.a.length&&1==e.a[0]&&(r=a([1],t.radix)),e.a=e.a.slice(0,Math.ceil(e.a.length/2)+1),t.radix>16&&(e.a[0]=Math.min(e.a[0],Math.ceil(Math.sqrt(e.a[0]+1))));for(var m,n=a([1],t.radix);;){var i=r.add(e).divr(2),o=i.mul(i),l=a.compare(o,t);if(0==l){m=i;break}if(0>l?r=i:e=i,a.compare(e.sub(r),n)<=0){m=r;break}}return m},Jmat.BigInt.isOdd=function(t){return t.bitand(Jmat.BigInt.ONE).eqr(1)},Jmat.BigInt.isEven=function(t){return t.bitand(Jmat.BigInt.ONE).eqr(0)},Jmat.BigInt.root=function(t,a){var r=a.toInt();return 0>=r?void 0:r>Jmat.Real.BIGGESTJSINT?t.eqr(0)?B(0):B.isEven(a)&&t.minus?void 0:B(t.minus?-1:1):Jmat.BigInt.rootr(t,r)},Jmat.BigInt.rootr=function(t,a){var r=Jmat.BigInt;if(0>=a)return void 0;if(t.eqr(0))return r(0);if(1==a)return t;if(2==a)return r.sqrt(t);if(Jmat.Real.isEven(a)&&t.minus)return void 0;if(a>r.log2(t.abs()).toInt())return r(t.minus?-1:1);var e=r([0],t.radix),m=Jmat.BigInt.copystrip_(t);1==m.a.length&&1==m.a[0]&&(e=r([1],t.radix)),m.a=m.a.slice(0,Math.ceil(m.a.length/a)+1),t.radix>16&&(m.a[0]=Math.min(m.a[0],Math.ceil(Jmat.Real.root(m.a[0]+1,a))));for(var n,i=r([1],t.radix);;){var o=e.add(m).divr(2),l=r.powr(o,a),u=r.compare(l,t);if(0==u){n=o;break}if(0>u?e=o:m=o,r.compare(m.sub(e),i)<=0){n=e;break}}return n},Jmat.BigInt.perfectsquare=function(t){var a=Jmat.BigInt;if(t.minus)return null;var r=a.bitandr(t,15);if(0!=r&&1!=r&&4!=r&&9!=r)return null;var e=a.sqrt(t);return e.mul(e).eq(t)?e:null},Jmat.BigInt.perfectpow=function(t,a,r,e){var m=Jmat.BigInt,n=e?m.cast(e):void 0,i=r?m.cast(r):void 0;if(t.minus)return void 0;if(r&&e)return[i.pow(n),i,n];if(r){if(t.lter(1)&&a)return[i.mul(i),i,m(2)];var o="number"!=typeof r?r:i.toInt(),l=m.logr(t,o);a&&(l=l.addr(1));var u=i.pow(l);return[u,i,l]}if(e){var o="number"!=typeof e?e:n.toInt(),J=m.rootr(t,o);a&&(J=J.addr(1));var u=J.powr(o);return[u,J,n]}if(t.ltr(5)){var o=t.toInt();return a?0==o?[m(1),m(1),m(2)]:4==o?[m(8),m(2),m(3)]:[m(4),m(2),m(2)]:0==o?void 0:4==t?[m(4),m(2),m(2)]:[m(1),m(1),m(2)]}var l=m.log2(t).toInt();a&&l++;for(var s=t,p=0,x=m(0),f=m(0),c=2;l>=c;c++)if(c>5&&c%5==0)c++;else if(c>3&&c%3==0)c++;else{var J=m.rootr(t,c);J.eqr(2)&&(c=l),a&&(J=J.addr(1));var u=J.powr(c),C=t.sub(u).abs();if(C.lt(s)&&(s=C,p=c,x=J,f=u,C.eqr(0)))break;c>2&&c++}if(2==p||3==p||5==p){var d=Jmat.BigInt.perfectpow(x);d[0].eq(x)&&(x=d[1],p*=d[2].toInt())}return[f,x,m(p)]},Jmat.BigInt.mulmany_=function(t){if(0==t.length)return Jmat.BigInt.ONE;for(;t.length>1;){for(var a=Math.floor(t.length/2),r=[],e=0;a>e;e++)r.push(t[e].mul(t[t.length-e-1]));t.length%2==1&&r.push(t[a]),t=r}return t[0]},Jmat.BigInt.factorial=function(t){var a=Jmat.BigInt,r=t.toInt();if(r==1/0)return void 0;if(20>r)return a(Jmat.Real.factorial(r));for(var e=Jmat.Real.eratosthenes(r),m=[],n=0;n<e.length;n++){for(var i=e[n],o=Math.floor(r/i),l=0;o>0;)l+=o,o=Math.floor(o/i);m[n]=a.powr(a(i),l)}return a.mulmany_(m)},Jmat.BigInt.primorial=function(t){var a=Jmat.BigInt,r=t.toInt();if(r==1/0)return void 0;var e=Jmat.Real.eratosthenes(r);return a.mulmany_(e)},Jmat.BigInt.nearestPrime=function(t){var a=Jmat.BigInt;if(t.lter(2))return a(2);if(t.lter(4))return a(3);var r=a.previousPrime(t),e=t.sub(r);return a.previousPrime(t.add(e).subr(1))},Jmat.BigInt.nextPrime=function(t){var a=Jmat.BigInt;if(t.ltr(2))return a(2);if(t.ltr(3))return a(3);var r=t.modr(6).toInt(),e=2;for(0==r||5==r?(t=t.addr(0==r?1:2),e=4):t=t.addr(5-r);;){if(a.isPrime(t))return t;t=t.addr(e),e^=6}},Jmat.BigInt.previousPrime=function(t){var a=Jmat.BigInt;if(t.lter(7))return t.lter(2)?void 0:a(t.lter(3)?2:t.lter(5)?3:5);var r=t.modr(6).toInt(),e=2;for(0==r||1==r?(t=t.subr(r+1),e=4):t=t.subr(r-1);;){if(a.isPrime(t))return t;t=t.subr(e),e^=6}},Jmat.BigInt.min=function(t,a){return t.lt(a)?t:a},Jmat.BigInt.max=function(t,a){return t.gt(a)?t:a},Jmat.BigInt.primeCache_=[],Jmat.BigInt.factorize=function(t){var a=Jmat.BigInt,r=[];if(t.minus&&(t=a.neg(t),r.push(a(-1))),t.lter(2))return 0!=r.length&&t.eqr(1)||r.push(t),r;if(t.ltr(Jmat.Real.BIGGESTJSINT)){for(var e=Jmat.Real.factorize(t),m=0;m<e.length;m++)r.push(a(e[m]));return r}for(var n=function(t){if(a.isPrime(t))return t;for(var r=Math.min(1e6,a.sqrt(t).toInt()),e=1,m=0;m>=a.primeCache_.length&&(a.primeCache_[m]=Jmat.Real.nextPrime(e)),e=a.primeCache_[m],m++,!(e!=e||e>r);)if(t.modr(e).eqr(0))return a(e);var i=a.perfectpow(t);return i[0].eq(t)&&i[1].lt(t)?n(i[1]):a(0)};;){var i=n(t);if(i.eqr(0))return r.push(a(0)),r;if(r.push(i),i.eqr(t))return r;t=t.div(i)}},Jmat.BigInt.logy=function(t,a){return Jmat.BigInt.logr(t,a.toInt())},Jmat.BigInt.logr=function(t,a){if(t.eqr(a))return Jmat.BigInt(1);if(t.minus||0>a)return void 0;if(t.eqr(0))return void 0;
if(1==a)return t;if(2==a)return Jmat.BigInt.log2(t);var r=Jmat.BigInt.convertBase(t,a),e=Jmat.BigInt.fromInt(Jmat.BigInt.getNumDigits(r)-1,t.radix);return e},Jmat.BigInt.log2=function(t){if(t.minus)return void 0;var a=Jmat.BigInt.getNumBits(t);return 0==a?void 0:Jmat.BigInt.fromInt(a-1)},Jmat.BigInt.log10=function(t){return Jmat.BigInt.logr(t,10)},Jmat.BigInt.rlog2=function(t){var a=Jmat.BigInt.getNumBits(t);return a>128?(t=Jmat.BigInt.rshift(t,a-128),Jmat.Real.log2(t.toInt())+a-128):Jmat.Real.log2(t.toInt())},Jmat.BigInt.rlog=function(t){return Jmat.BigInt.rlog2(t)*Math.LN2},Jmat.BigInt.rlog10=function(t){return Jmat.BigInt.rlog2(t)/3.321928094887362},Jmat.BigInt.div=function(t,a){return t.div(a)},Jmat.BigInt.prototype.div=function(t){return t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix)),Jmat.BigInt.divmod_(this,t)[0]},Jmat.BigInt.mod=function(t,a){return t.mod(a)},Jmat.BigInt.prototype.mod=function(t){return t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix)),Jmat.BigInt.divmod_(this,t)[1]},Jmat.BigInt.divmod=function(t,a){return t.divmod(a)},Jmat.BigInt.prototype.divmod=function(t){return t.radix!=this.radix&&(t=Jmat.BigInt.convertBase(t,this.radix)),t.abs().ltr(65536)?Jmat.BigInt.divsmall_(this,t.toInt()):Jmat.BigInt.divmod_(this,t)},Jmat.BigInt.divr=function(t,a){return 0==a?void 0:1==a?t:-1==a?t.neg():t.abs().ltr(Math.abs(a))?Jmat.BigInt(0):t.eqr(a)?Jmat.BigInt(1):Math.abs(a)<65536?Jmat.BigInt.divsmall_(t,a)[0]:Jmat.BigInt.div(t,Jmat.BigInt(a))},Jmat.BigInt.prototype.divr=function(t){return Jmat.BigInt.divr(this,t)},Jmat.BigInt.half_=function(t){if(Jmat.Real.isPOT(t.radix)){var a=t.a[t.a.length-1]%2;return[Jmat.BigInt.rshift(t,1),Jmat.BigInt(a)]}for(var r=[],e=t.radix,m=0,n=0;n<t.a.length;n++){var i=t.a[n]+m;m=Jmat.Real.isOdd(i)?e:0;var o=Math.floor(i/2);(o>0||r.length>0)&&r.push(o)}return[new Jmat.BigInt(r,e,t.minus),0==m?Jmat.BigInt(0,e):Jmat.BigInt(1,e)]},Jmat.BigInt.divsmall_=function(t,a){if(a==t.radix)return[t.rshift_radix(t),Jmat.BigInt(0)];if(2==a)return Jmat.BigInt.half_(t);if(-2==a){var r=Jmat.BigInt.half_(t);return[r[0].neg(),r[1].neg()]}var e=t.minus,m=0>a,n=t.minus!=0>a;a=Math.abs(a);for(var i=[],o=t.radix,l=0,u=0;u<t.a.length;u++){var J=t.a[u]+l*o;l=J%a;var s=Math.floor(J/a);(s>0||i.length>0)&&i.push(s)}var p=Jmat.BigInt(l,o);return l&&(e&&m?p=p.neg():m?p=p.subr(a):e&&(p=p.subr(a).neg())),[new Jmat.BigInt(i,o,n),p]},Jmat.BigInt.modr=function(t,a){return 0==a?void 0:1==a||-1==a?Jmat.BigInt(0):Math.abs(a)<t.radix&&t.radix%a==0?Jmat.BigInt(Jmat.Real.mod(t.a[t.a.length-1],a)):Math.abs(a)<65536?Jmat.BigInt.divsmall_(t,a)[1]:Jmat.BigInt.mod(t,Jmat.BigInt(a))},Jmat.BigInt.prototype.modr=function(t){return Jmat.BigInt.modr(this,t)},Jmat.BigInt.leemondiv_=function(t,a,r){var e,m,n,i,o,l,u,J,s=Jmat.BigInt,p=t.radix,x=t.radix-1,f=s.copy(t);for(t=t.strip(),a=s.copystrip_(a),m=a.a.length,J=a.a[a.a.length-1-m+1],u=0;J;u++)J>>=1;for(u=r-u,a=a.lshift(u),f=f.lshift(u),a.a.splice(0,0,0),e=Math.max(m,f.a.length);f.a.length<t.a.length+1;)f.a.splice(0,0,0);for(var c=s(0,p),n=0;n<t.a.length;n++)c.a[n]=0;for(c.a.splice(0,0,0);;){var C=a.lshift_radix(e-m);if(C.gt(f))break;f=f.sub(C),c.a[c.a.length-e+m-1]++}for(n=e-1;n>=m;n--){var d=f.a.length-1,v=c.a.length-1,g=a.a.length-1;for(f.a[d-n]==a.a[g-(m-1)]?c.a[v-(n-m)]=x:c.a[v-(n-m)]=Math.floor((f.a[d-n]*p+f.a[d-(n-1)])/a.a[g-(m-1)]);o=(m>1?a.a[g-(m-2)]:0)*c.a[v-(n-m)],l=o>>r,o&=x,i=l+c.a[v-(n-m)]*a.a[g-(m-1)],l=i>>r,i&=x,l==f.a[d-n]?i==f.a[d-(n-1)]?o>(n>1?f.a[d-(n-2)]:0):i>f.a[d-(n-1)]:l>f.a[d-n];)c.a[v-(n-m)]--;var h=a.lshift_radix(n-m),I=h.mulr(c.a[v-(n-m)]);f.lt(I)?(f.a=Jmat.BigInt.baseloop_(f.a,0,1,h.a,0,1,0,p,!0),f.a=Jmat.BigInt.baseloop_(f.a,0,1,I.a,0,-1,0,p,!0),c.a[v-(n-m)]--):f.a=Jmat.BigInt.baseloop_(f.a,0,1,I.a,0,-1,0,p,!0)}return f=f.rshift(u),[c,f]},Jmat.BigInt.divmod_=function(t,a,r){var e=Jmat.BigInt;if(a.eqr(0))return void 0;if(a.eqr(1))return[t,e(0)];if(a.eqr(-1))return[t.neg(),e(0)];if(a.abs().ltr(65536))return Jmat.BigInt.divsmall_(t,a.toInt());if(a.abs().gt(t.abs()))return[e(0),t];if(a.eq(t))return[e(1),e(0)];var m=t.minus!=a.minus;t=t.abs(),a=a.abs(),r||(t=e.cast(t,e.ARRAYBASE_),a=e.cast(a,e.ARRAYBASE_));var n=e.leemondiv_(t,a,r||e.ARRAYBASE_BITS_),i=n[0],o=n[1];return i=i.strip(),o=o.strip(),m&&(i=i.neg(),o=o.add(a),o.minus&&o.eqr(0)&&(o.minus=!1)),[i,o]},Jmat.BigInt.pow=function(t,a){var r=a;a=Jmat.BigInt.cast(a,2);var e=t.radix;if(a.minus)return Jmat.BigInt(0,e);var m=!1;t.minus&&a.modr(2).eqr(1)&&(m=!0),t=t.abs();for(var n=Jmat.BigInt.maybecopystrip_(a.a,a!=r),i=Jmat.BigInt(1,e),o=t,l=n.length,u=0;l>u;u++)0==n[u]?(o=i.mul(o),i=i.mul(i)):(i=i.mul(o),o=o.mul(o));return m&&(i=i.neg()),i},Jmat.BigInt.prototype.pow=function(t){return Jmat.BigInt.pow(this,t)},Jmat.BigInt.powr=function(t,a){return Jmat.BigInt.pow(t,Jmat.BigInt.fromInt(a))},Jmat.BigInt.prototype.powr=function(t){return Jmat.BigInt.pow(this,Jmat.BigInt.fromInt(t))},Jmat.BigInt.gcd=function(t,a){var r=Jmat.BigInt;for(t=t.abs(),a=a.abs();;){if(a.eqr(0))return t;var e=r.mod(t,a);t=a,a=e}},Jmat.BigInt.egcd=function(t,a){for(var r,e=Jmat.BigInt,m=e(0),n=e(1),i=e(1),o=e(0),l=t,u=a;!l.eqr(0);){var J=u.div(l);r=l,l=u.sub(J.mul(l)),u=r,r=m,m=n.sub(J.mul(m)),n=r,r=i,i=o.sub(J.mul(i)),o=r}return(i.sign()!=t.sign()||m.sign()!=a.sign())&&(r=i,i=m,m=r,r=o,o=n,n=r,i.sign()!=t.sign()&&(i=i.neg()),m.sign()!=a.sign()&&(m=m.neg())),[u,n,o,i,m]},Jmat.BigInt.invmod=function(t,a){for(var r,e=Jmat.BigInt,m=a,n=e(1),i=e(0);;){if(t.eqr(1)){r=n;break}if(t.eqr(0)){r=e(0);break}var o=a.divmod(t);if(i=i.sub(n.mul(o[0])),a=o[1],a.eqr(1)){r=i;break}if(a.eqr(0)){r=e(0);break}o=t.divmod(a),n=n.sub(i.mul(o[0])),t=o[1]}return r.minus&&(r=m.add(r)),r},Jmat.BigInt.monred_=function(t,a,r,e,m){var n=t.mul(m).bitand(r),i=t.add(n.mul(e)).rshift(a);return i.gte(e)&&(i=i.sub(e)),i},Jmat.BigInt.genmonred_=function(t){var a=Jmat.BigInt.getNumBits(t),r=Jmat.BigInt.lshift(Jmat.BigInt(1),a),e=r.subr(1),m=Jmat.BigInt.invmod(t,r).neg().bitand(e),n=r.lshift(a).mod(t);return function(r,i){return i?Jmat.BigInt.monred_(r.mul(n),a,e,t,m):Jmat.BigInt.monred_(r,a,e,t,m)}},Jmat.BigInt.modpow=function(t,a,r,e){var m=Jmat.BigInt,n=a;a=m.cast(a,2);var i=m.maybecopystrip_(a.a,a!=n),o=m.ONE,l=t,u=i.length;if(r.modr(2).eqr(1)&&u>1){var J=e||m.genmonred_(r);o=J(o,!0),l=J(l,!0);for(var s=0;u>s;s++)0==i[s]?(l=o.mul(l),o=o.mul(o)):(o=o.mul(l),l=l.mul(l)),o=J(o),l=J(l);return o=J(o)}for(var s=0;u>s;s++)0==i[s]?(l=o.mul(l).mod(r),o=o.mul(o).mod(r)):(o=o.mul(l).mod(r),l=l.mul(l).mod(r));return o},Jmat.BigInt.randomBits=function(t){for(var a=Jmat.BigInt([],Jmat.BigInt.ARRAYBASE_),r=Math.ceil(t/Jmat.BigInt.ARRAYBASE_BITS_),e=0;r>e;e++)a.a[e]=Math.floor(Jmat.BigInt.ARRAYBASE_*Math.random());for(var m=t*(Jmat.BigInt.ARRAYBASE_BITS_-1)%Jmat.BigInt.ARRAYBASE_BITS_,n=Jmat.BigInt.ARRAYBASE_-1,e=0;m>e;e++)n=Math.floor(n/2);return n+1<Jmat.BigInt.ARRAYBASE_&&(a.a[0]&=n),a},Jmat.BigInt.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],Jmat.BigInt.isPrimeSimple=function(t){if(t=Jmat.BigInt.cast(t),t.ltr(2))return 0;for(var a=0;a<Jmat.BigInt.firstPrimes_.length;a++){if(t.eqr(Jmat.BigInt.firstPrimes_[a]))return 1;if(0==t.modr(Jmat.BigInt.firstPrimes_[a]).toInt())return 0}return-1},Jmat.BigInt.isPrimeMillerRabin=function(t,a){for(var r=Jmat.BigInt,e=a||r.chooseMillerRabinBase_(t),m=t.divr(2),n=r.ONE;r.bitand(m,r.ONE).eqr(0);)m=m.divr(2),n=n.addr(1);for(var i=r.genmonred_(t),o=function(t,a,e,m){for(var n,o=r.modpow(m,e,t,i);!a.eqr(0);){if(n=o.mul(o).mod(t),n.eqr(1)&&!o.eqr(1)&&!o.eq(t.subr(1)))return!1;o=n,a=a.subr(1)}return n.eqr(1)},l=0;l<e.length;l++)if(!o(t,n,m,r.cast(e[l])))return!1;return!0},Jmat.BigInt.chooseMillerRabinBase_=function(t){var a,r=Jmat.BigInt.getNumBits(t);if(64>=r)a=t.ltr(1373653)?[2,3]:t.ltr(9080191)?[31,73]:t.ltr(4759123141)?[2,7,61]:t.ltr(1122004669633)?[2,13,23,1662803]:t.ltr(2152302898747)?[2,3,5,7,11]:t.ltr(3474749660383)?[2,3,5,7,11,13]:t.ltr(341550071728321)?[2,3,5,7,11,13,17]:t.ltr(0xd655278977733)?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022];else{a=[2,3];for(var e=0;18>e;e++)a.push(Jmat.BigInt.randomBits(r-1))}return a},Jmat.BigInt.isPrime=function(t){if(t.ltr(Jmat.Real.BIGGESTJSPRIME))return Jmat.Real.isPrime(t.toInt());var a=Jmat.BigInt.isPrimeSimple(t);return-1!=a?!!a:Jmat.BigInt.isPrimeMillerRabin(t)},Jmat.BigInt.d_=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Jmat.BigInt.di_=function(t){var a=t.charCodeAt(0);return 57>=a?a-48:(a>90&&(a-=32),a-65+10)},Jmat.BigInt.mirror_=function(t){for(var a=0;a<t.length/2;a++){var r=t[a];t[a]=t[t.length-a-1],t[t.length-a-1]=r}},Jmat.BigInt.getNumBits=function(t){var a=t.radix&&0==(t.radix&t.radix-1);a||(t=Jmat.BigInt.cast(t,Jmat.BigInt.ARRAYBASE_));var r=Jmat.BigInt.maybecopystrip_(t.a);if(0==r.length)return 0;var e=Jmat.Real.ilog2(r[0])+1;if(r.length>0){var m=Jmat.Real.ilog2(t.radix);e+=m*(r.length-1)}return e},Jmat.BigInt.getNumDigits=function(t){for(var a=0;a<t.a.length&&0==t.a[a];)a++;return t.a.length-a},Jmat.BigInt.stripInPlace_=function(t){for(;0==t[0]&&t.length>1;)t.shift()},Jmat.BigInt.copystrip_=function(t){for(var a=0,r=0;r<t.a.length&&0==t.a[r];r++)a++;var e=new Array(t.a.length-a);if(0==e.length)return new Jmat.BigInt([0],t.radix);for(var r=0;r<e.length;r++)e[r]=t.a[r+a];return Jmat.BigInt(e,t.radix)},Jmat.BigInt.maybecopystrip_=function(t,a){return t.length<=1||0!=t[0]?t:(a||(t=Jmat.BigInt.copyarray_(t)),Jmat.BigInt.stripInPlace_(t),t)},Jmat.BigInt.strip=function(t){return t.strip()},Jmat.BigInt.prototype.strip=function(){return this.a.length<=1||0!=this.a[0]?this:Jmat.BigInt.copystrip_(this)},Jmat.BigInt.copyarray_=function(t){return t.slice(0)},Jmat.BigInt.FORMAT_UNKNOWN_=0,Jmat.BigInt.FORMAT_BIGINT_=1,Jmat.BigInt.FORMAT_ARRAY_=2,Jmat.BigInt.FORMAT_STRING_=3,Jmat.BigInt.getFormat=function(t){return"string"==typeof t?Jmat.BigInt.FORMAT_STRING_:"[object Array]"===toString.call(t)?Jmat.BigInt.FORMAT_ARRAY_:t instanceof Jmat.BigInt?Jmat.BigInt.FORMAT_BIGINT_:Jmat.BigInt.FORMAT_UNKNOWN_},Jmat.BigInt.toFormat=function(t,a,r){if(void 0==t)return void 0;if(a==Jmat.BigInt.getFormat(t)){if(void 0==r)return t;if(a==Jmat.BigInt.FORMAT_BIGINT_)return t.minus==r?t:t.neg();if(a==Jmat.BigInt.FORMAT_STRING_)return"-"==t[0]==r?t:r?"-"+t:t.substr(1)}return t=Jmat.BigInt.cast(t),void 0!=r&&t.minus!=r&&(t=t.neg()),a==Jmat.BigInt.FORMAT_BIGINT_?t:a==Jmat.BigInt.FORMAT_ARRAY_?t.a:a==Jmat.BigInt.FORMAT_STRING_?t.toString():a==Jmat.BigInt.FORMAT_UNKNOWN_?t.toString():t},Jmat.BigInt.enrichFunction_=function(t,a,r,e){if(3==e)return Jmat.BigInt.enrichFunction_(a,r,0),void(r>1&&Jmat.BigInt.enrichFunction_(a,r-1,2));if(4==e)return Jmat.BigInt.enrichFunction_(a,r,1),void(r>1&&Jmat.BigInt.enrichFunction_(a,r-1,2));var m=2==e?Jmat.BigInt.prototype[a]:Jmat.BigInt[a],n=function(){for(var t=Jmat.BigInt.getFormat(arguments[0]),a=0;r>a;a++)arguments[a]=Jmat.BigInt.cast(arguments[a]);var n=m.apply(this,arguments);return 1==e?Jmat.BigInt.toFormat(n,t):n};2==m.length&&2==r&&1==e&&(n=function(t,a){var r=m(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a));return Jmat.BigInt.toFormat(r,Jmat.BigInt.getFormat(t))}),1==m.length&&1==r&&2==e&&(n=function(t){return m.call(this,Jmat.BigInt.cast(t))}),2==e?t.prototype[a]=n:t[a]=n},Jmat.BigInt.enrichFunctions_=function(){var t=0,a=!0;if(a){Jmat.BigIntC=function(){return Jmat.BigInt.apply(this,arguments)};for(var r in Jmat.BigInt)Jmat.BigIntC[r]=Jmat.BigInt[r];for(var r in Jmat.BigInt.prototype)Jmat.BigIntC.prototype[r]=Jmat.BigInt.prototype[r]}var e=a?Jmat.BigIntC:Jmat.BigInt;Jmat.BigInt.enrichFunction_(e,"add",2,1+t),Jmat.BigInt.enrichFunction_(e,"addr",1,1+t),Jmat.BigInt.enrichFunction_(e,"sub",2,1+t),Jmat.BigInt.enrichFunction_(e,"subr",1,1+t),Jmat.BigInt.enrichFunction_(e,"mul",2,1+t),Jmat.BigInt.enrichFunction_(e,"mulr",1,1+t),Jmat.BigInt.enrichFunction_(e,"div",2,1+t),Jmat.BigInt.enrichFunction_(e,"divr",1,1+t),Jmat.BigInt.enrichFunction_(e,"mod",2,1+t),Jmat.BigInt.enrichFunction_(e,"modr",1,1+t),Jmat.BigInt.enrichFunction_(e,"divmod",2,0+t),Jmat.BigInt.enrichFunction_(e,"lshift",1,1+t),Jmat.BigInt.enrichFunction_(e,"rshift",1,1+t),Jmat.BigInt.enrichFunction_(e,"bitand",2,1+t),Jmat.BigInt.enrichFunction_(e,"bitor",2,1+t),Jmat.BigInt.enrichFunction_(e,"bitxor",2,1+t),Jmat.BigInt.enrichFunction_(e,"bitneg",1,1+t),Jmat.BigInt.enrichFunction_(e,"bitnot",1,1+t),Jmat.BigInt.enrichFunction_(e,"abs",1,1+t),Jmat.BigInt.enrichFunction_(e,"neg",1,1+t),Jmat.BigInt.enrichFunction_(e,"sign",1,0),Jmat.BigInt.enrichFunction_(e,"getSign",1,0),Jmat.BigInt.enrichFunction_(e,"nonZero",1,0),Jmat.BigInt.enrichFunction_(e,"compare",2,0+t),Jmat.BigInt.enrichFunction_(e,"comparer",1,0+t),Jmat.BigInt.enrichFunction_(e,"sqrt",1,1),Jmat.BigInt.enrichFunction_(e,"root",2,1),Jmat.BigInt.enrichFunction_(e,"rootr",1,1),Jmat.BigInt.enrichFunction_(e,"logy",2,1),Jmat.BigInt.enrichFunction_(e,"logr",1,1),Jmat.BigInt.enrichFunction_(e,"log2",1,1),Jmat.BigInt.enrichFunction_(e,"log10",1,1),Jmat.BigInt.enrichFunction_(e,"rlog2",1,0),Jmat.BigInt.enrichFunction_(e,"rlog",1,0),Jmat.BigInt.enrichFunction_(e,"rlog10",1,0),Jmat.BigInt.enrichFunction_(e,"pow",2,1+t),Jmat.BigInt.enrichFunction_(e,"powr",1,1+t),Jmat.BigInt.enrichFunction_(e,"gcd",2,1),Jmat.BigInt.enrichFunction_(e,"egcd",2,0),Jmat.BigInt.enrichFunction_(e,"invmod",2,1),Jmat.BigInt.enrichFunction_(e,"modpow",3,1),Jmat.BigInt.enrichFunction_(e,"isPrimeSimple",1,0),Jmat.BigInt.enrichFunction_(e,"isPrimeMillerRabin",1,0),Jmat.BigInt.enrichFunction_(e,"isPrime",1,0),Jmat.BigInt.enrichFunction_(e,"perfectpow",1,0),Jmat.BigInt.enrichFunction_(e,"nextPrime",1,1),Jmat.BigInt.enrichFunction_(e,"factorize",1,0),Jmat.BigInt.enrichFunction_(e,"factorial",1,1),Jmat.BigInt.enrichFunction_(e,"primorial",1,1)},Jmat.BigInt.enrichFunctions_(),/*
@license
Jmat.js

Copyright (c) 2011-2015, Lode Vandevenne
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
Jmat.add=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.add(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.add(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.add(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.add(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.sub=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.sub(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.sub(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.sub(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.sub(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.mul=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.mul(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.matrixIn_(t)?Jmat.Matrix.mulc(Jmat.Matrix.cast(t),Jmat.Complex.cast(a)):Jmat.matrixIn_(a)?Jmat.Matrix.mulc(Jmat.Matrix.cast(a),Jmat.Complex.cast(t)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.mul(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.mul(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.mul(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.div=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.div(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.matrixIn_(t)?Jmat.Matrix.divc(Jmat.Matrix.cast(t),Jmat.Complex.cast(a)):Jmat.matrixIn_(a)?Jmat.Matrix.divc(Jmat.Matrix.cast(a),Jmat.Complex.cast(t)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.div(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.div(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.div(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.eq=function(t,a){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.eq(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a)):Jmat.matrixIn_(t)||Jmat.matrixIn_(a)?!1:Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.eq(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.eq(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.eq(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.near=function(t,a,r){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.near(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a),Jmat.Real.caststrict(r)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.near(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a),Jmat.Real.caststrict(r)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.eq(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.near(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Real.caststrict(r))},Jmat.relnear=function(t,a,r){return Jmat.matrixIn_(t)&&Jmat.matrixIn_(a)?Jmat.Matrix.relnear(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a),Jmat.Real.caststrict(r)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.relnear(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a),Jmat.Real.caststrict(r)):Jmat.bigIntIn_(t)||Jmat.bigIntIn_(a)?Jmat.BigInt.eq(Jmat.BigInt.cast(t),Jmat.BigInt.cast(a)):Jmat.Complex.relnear(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Real.caststrict(r))},Jmat.isNaN=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.isNaN(Jmat.Matrix.cast(t)):Jmat.Complex.isNaN(Jmat.Complex.cast(t))},Jmat.pow=function(t,a){return Jmat.matrixIn_(t)?Jmat.Matrix.powc(Jmat.Matrix.cast(t),Jmat.Complex.cast(a)):Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.pow(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.Complex.pow(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.sqrt=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.sqrt(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.sqrt(Jmat.Quaternion.cast(t)):Jmat.bigIntIn_(t)?Jmat.BigInt.sqrt(Jmat.BigInt.cast(t)):Jmat.Complex.sqrt(Jmat.Complex.cast(t))},Jmat.exp=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.exp(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.exp(Jmat.Quaternion.cast(t)):Jmat.Complex.exp(Jmat.Complex.cast(t))},Jmat.log=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.log(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.log(Jmat.Quaternion.cast(t)):Jmat.Complex.log(Jmat.Complex.cast(t))},Jmat.log1p=function(t){return Jmat.Complex.log1p(Jmat.Complex.cast(t))},Jmat.expm1=function(t){return Jmat.Complex.expm1(Jmat.Complex.cast(t))},Jmat.logy=function(t,a){return Jmat.quaternionIn_(t)||Jmat.quaternionIn_(a)?Jmat.Quaternion.logy(Jmat.Quaternion.cast(t),Jmat.Quaternion.cast(a)):Jmat.Complex.logy(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.log2=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.log2(Jmat.Quaternion.cast(t)):Jmat.Complex.log2(Jmat.Complex.cast(t))},Jmat.log10=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.log10(Jmat.Quaternion.cast(t)):Jmat.Complex.log10(Jmat.Complex.cast(t))},Jmat.lambertw=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.lambertw(Jmat.Quaternion.cast(t)):Jmat.Complex.lambertw(Jmat.Complex.cast(t))},Jmat.lambertwm=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.lambertwm(Jmat.Quaternion.cast(t)):Jmat.Complex.lambertwm(Jmat.Complex.cast(t))},Jmat.lambertwb=function(t,a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.lambertwb(t,Jmat.Quaternion.cast(a)):Jmat.Complex.lambertwb(Jmat.Real.caststrict(t),Jmat.Complex.cast(a))},Jmat.tetration=function(t,a){return Jmat.Complex.tetration(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.x=function(t){return Jmat.Complex.cast(t)},Jmat.neg=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.neg(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.neg(Jmat.Quaternion.cast(t)):Jmat.Complex.neg(Jmat.Complex.cast(t))},Jmat.inv=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.inv(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.inv(Jmat.Quaternion.cast(t)):Jmat.Complex.inv(Jmat.Complex.cast(t))},Jmat.conj=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.conj(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.conj(Jmat.Quaternion.cast(t)):Jmat.Complex.conj(Jmat.Complex.cast(t))},Jmat.sin=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.sin(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.zin(Jmat.Quaternion.cast(t)):Jmat.Complex.sin(Jmat.Complex.cast(t))},Jmat.cos=function(t){return Jmat.matrixIn_(t)?Jmat.Matrix.cos(Jmat.Matrix.cast(t)):Jmat.quaternionIn_(t)?Jmat.Quaternion.cos(Jmat.Quaternion.cast(t)):Jmat.Complex.cos(Jmat.Complex.cast(t))},Jmat.tan=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.tan(Jmat.Quaternion.cast(t)):Jmat.Complex.tan(Jmat.Complex.cast(t))},Jmat.asin=function(t){return Jmat.Complex.asin(Jmat.Complex.cast(t))},Jmat.acos=function(t){return Jmat.Complex.acos(Jmat.Complex.cast(t))},Jmat.atan=function(t){return Jmat.Complex.atan(Jmat.Complex.cast(t))},Jmat.atan2=function(t,a){return Jmat.Complex.atan2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.sinc=function(t){return Jmat.Complex.sinc(Jmat.Complex.cast(t))},Jmat.sinh=function(t){return Jmat.Complex.sinh(Jmat.Complex.cast(t))},Jmat.cosh=function(t){return Jmat.Complex.cosh(Jmat.Complex.cast(t))},Jmat.tanh=function(t){return Jmat.Complex.tanh(Jmat.Complex.cast(t))},Jmat.asinh=function(t){return Jmat.Complex.asinh(Jmat.Complex.cast(t))},Jmat.acosh=function(t){return Jmat.Complex.acosh(Jmat.Complex.cast(t))},Jmat.atanh=function(t){return Jmat.Complex.atanh(Jmat.Complex.cast(t))},Jmat.gamma=function(t){return Jmat.Complex.gamma(Jmat.Complex.cast(t))},Jmat.factorial=function(t){return Jmat.Complex.factorial(Jmat.Complex.cast(t))},Jmat.digamma=function(t){return Jmat.Complex.digamma(Jmat.Complex.cast(t))},Jmat.trigamma=function(t){return Jmat.Complex.trigamma(Jmat.Complex.cast(t))},Jmat.polygamma=function(t,a){return Jmat.Complex.polygamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.loggamma=function(t){return Jmat.Complex.loggamma(Jmat.Complex.cast(t))},Jmat.gamma_inv=function(t){return Jmat.Complex.gamma_inv(Jmat.Complex.cast(t))},Jmat.incgamma_lower=function(t,a){return Jmat.Complex.incgamma_lower(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.incgamma_upper=function(t,a){return Jmat.Complex.incgamma_upper(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.gamma_p=function(t,a){return Jmat.Complex.gamma_p(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.gamma_q=function(t,a){return Jmat.Complex.gamma_q(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.gamma_p_inv=function(t,a){return Jmat.Complex.gamma_p_inv(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.beta=function(t,a){return Jmat.Complex.beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.incbeta=function(t,a,r){return Jmat.Complex.incbeta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.beta_i=function(t,a,r){return Jmat.Complex.beta_i(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.beta_i_inv=function(t,a,r){return Jmat.Complex.beta_i_inv(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.re=function(t){return Jmat.Complex(Jmat.Complex.cast(t).re)},Jmat.im=function(t){return Jmat.Complex(Jmat.Complex.cast(t).im)},Jmat.abs=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.abs(Jmat.Quaternion.cast(t)):Jmat.Complex.abs(Jmat.Complex.cast(t))},Jmat.arg=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.qrg(Jmat.Quaternion.cast(t)):Jmat.Complex.arg(Jmat.Complex.cast(t))},Jmat.sign=function(t){return Jmat.quaternionIn_(t)?Jmat.Quaternion.sign(Jmat.Quaternion.cast(t)):Jmat.Complex.sign(Jmat.Complex.cast(t))},Jmat.csgn=function(t){return Jmat.Complex.csgn(Jmat.Complex.cast(t))},Jmat.floor=function(t){return Jmat.Complex.floor(Jmat.Complex.cast(t))},Jmat.ceil=function(t){return Jmat.Complex.ceil(Jmat.Complex.cast(t))},Jmat.round=function(t){return Jmat.Complex.round(Jmat.Complex.cast(t))},Jmat.trunc=function(t){return Jmat.Complex.trunc(Jmat.Complex.cast(t))},Jmat.frac=function(t){return Jmat.Complex.frac(Jmat.Complex.cast(t))},Jmat.fracn=function(t){return Jmat.Complex.fracn(Jmat.Complex.cast(t))},Jmat.rotate=function(t,a){return Jmat.Complex.rotate(Jmat.Complex.cast(t),Jmat.Real.caststrict(a))},Jmat.decompose=function(t,a){return Jmat.Complex.decompose(Jmat.Complex.cast(t),Jmat.Real.cast(a))},Jmat.lerp=function(t,a,r){return Jmat.Complex.lerp(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.besselj=function(t,a){return Jmat.Complex.besselj(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.bessely=function(t,a){return Jmat.Complex.bessely(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.besseli=function(t,a){return Jmat.Complex.besseli(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.besselk=function(t,a){return Jmat.Complex.besselk(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hankelh1=function(t,a){return Jmat.Complex.hankelh1(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hankelh2=function(t,a){return Jmat.Complex.hankelh2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.airy=function(t){return Jmat.Complex.airy(Jmat.Complex.cast(t))},Jmat.bairy=function(t){return Jmat.Complex.bairy(Jmat.Complex.cast(t))},Jmat.airy_deriv=function(t){return Jmat.Complex.airy_deriv(Jmat.Complex.cast(t))},Jmat.bairy_deriv=function(t){return Jmat.Complex.bairy_deriv(Jmat.Complex.cast(t))},Jmat.theta1=function(t,a){return Jmat.Complex.theta1(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.theta2=function(t,a){return Jmat.Complex.theta2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.theta3=function(t,a){return Jmat.Complex.theta3(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.theta4=function(t,a){return Jmat.Complex.theta4(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.zeta=function(t){return Jmat.Complex.zeta(Jmat.Complex.cast(t))},Jmat.eta=function(t){return Jmat.Complex.eta(Jmat.Complex.cast(t))},Jmat.lambda=function(t){return Jmat.Complex.lambda(Jmat.Complex.cast(t))},Jmat.dilog=function(t){return Jmat.Complex.dilog(Jmat.Complex.cast(t))},Jmat.trilog=function(t){return Jmat.Complex.trilog(Jmat.Complex.cast(t))},Jmat.polylog=function(t,a){return Jmat.Complex.polylog(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hurwitzzeta=function(t,a){return Jmat.Complex.hurwitzzeta(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hypergeometric0F1=function(t,a){return Jmat.Complex.hypergeometric0F1(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.hypergeometric1F1=function(t,a,r){return Jmat.Complex.hypergeometric1F1(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.hypergeometric2F1=function(t,a,r,e){return Jmat.Complex.hypergeometric2F1(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r),Jmat.Complex.cast(e))},Jmat.hypergeometric=function(t,a,r){for(var e=[],m=0;m<t.length;m++)e[m]=Jmat.Complex.cast(t[m]);for(var n=[],m=0;m<a.length;m++)n[m]=Jmat.Complex.cast(a[m]);return Jmat.Complex.hypergeometric(e,n,Jmat.Complex.cast(r))},Jmat.erf=function(t){return Jmat.Complex.erf(Jmat.Complex.cast(t))},Jmat.erfc=function(t){return Jmat.Complex.erfc(Jmat.Complex.cast(t))},Jmat.erfcx=function(t){return Jmat.Complex.erfcx(Jmat.Complex.cast(t))},Jmat.erf_inv=function(t){return Jmat.Complex.erf_inv(Jmat.Complex.cast(t))},Jmat.erfc_inv=function(t){return Jmat.Complex.erfc_inv(Jmat.Complex.cast(t))},Jmat.erfi=function(t){return void 0==t.re?Jmat.Complex(Jmat.Real.erfi(t)):Jmat.Complex.erfi(Jmat.Complex.cast(t))},Jmat.dawson=function(t){return void 0==t.re?Jmat.Complex(Jmat.Real.dawson(t)):Jmat.Complex.dawson(Jmat.Complex.cast(t))},Jmat.faddeeva=function(t){return Jmat.Complex.faddeeva(Jmat.Complex.cast(t))},Jmat.pdf_uniform=function(t,a,r){return Jmat.Complex.pdf_uniform(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_uniform=function(t,a,r){return Jmat.Complex.cdf_uniform(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_uniform=function(t,a,r){return Jmat.Complex.qf_uniform(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_standardnormal=function(t){return Jmat.Complex.pdf_standardnormal(Jmat.Complex.cast(t))},Jmat.cdf_standardnormal=function(t){return Jmat.Complex.cdf_standardnormal(Jmat.Complex.cast(t))},Jmat.qf_standardnormal=function(t){return Jmat.Complex.qf_standardnormal(Jmat.Complex.cast(t))},Jmat.pdf_normal=function(t,a,r){return Jmat.Complex.pdf_normal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_normal=function(t,a,r){return Jmat.Complex.cdf_normal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_normal=function(t,a,r){return Jmat.Complex.qf_normal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_lognormal=function(t,a,r){return Jmat.Complex.pdf_lognormal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_lognormal=function(t,a,r){return Jmat.Complex.cdf_lognormal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_lognormal=function(t,a,r){return Jmat.Complex.qf_lognormal(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_cauchy=function(t,a,r){return Jmat.Complex.pdf_cauchy(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_cauchy=function(t,a,r){return Jmat.Complex.cdf_cauchy(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_cauchy=function(t,a,r){return Jmat.Complex.qf_cauchy(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_studentt=function(t,a){return Jmat.Complex.pdf_studentt(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.cdf_studentt=function(t,a){return Jmat.Complex.cdf_studentt(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.qf_studentt=function(t,a){return Jmat.Complex.qf_studentt(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.pdf_chi_square=function(t,a){return Jmat.Complex.pdf_chi_square(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.cdf_chi_square=function(t,a){return Jmat.Complex.cdf_chi_square(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.qf_chi_square=function(t,a){return Jmat.Complex.qf_chi_square(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.pdf_logistic=function(t,a,r){return Jmat.Complex.pdf_logistic(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_logistic=function(t,a,r){return Jmat.Complex.cdf_logistic(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_logistic=function(t,a,r){return Jmat.Complex.qf_logistic(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_gamma=function(t,a,r){return Jmat.Complex.pdf_gamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_gamma=function(t,a,r){return Jmat.Complex.cdf_gamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_gamma=function(t,a,r){return Jmat.Complex.qf_gamma(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_beta=function(t,a,r){return Jmat.Complex.pdf_beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_beta=function(t,a,r){return Jmat.Complex.cdf_beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_beta=function(t,a,r){return Jmat.Complex.qf_beta(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_fisher=function(t,a,r){return Jmat.Complex.pdf_fisher(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_fisher=function(t,a,r){return Jmat.Complex.cdf_fisher(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_fisher=function(t,a,r){return Jmat.Complex.qf_fisher(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_weibull=function(t,a,r){return Jmat.Complex.pdf_weibull(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_weibull=function(t,a,r){return Jmat.Complex.cdf_weibull(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_weibull=function(t,a,r){return Jmat.Complex.qf_weibull(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.pdf_exponential=function(t,a){return Jmat.Complex.pdf_exponential(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.cdf_exponential=function(t,a){return Jmat.Complex.cdf_exponential(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.qf_exponential=function(t,a){return Jmat.Complex.qf_exponential(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.pdf_laplace=function(t,a,r){return Jmat.Complex.pdf_laplace(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.cdf_laplace=function(t,a,r){return Jmat.Complex.cdf_laplace(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.qf_laplace=function(t,a,r){return Jmat.Complex.qf_laplace(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.permutation=function(t,a){return Jmat.Complex.permutation(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.binomial=function(t,a){return Jmat.Complex.binomial(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.stirling2=function(t,a){return Jmat.Complex.stirling2(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.agm=function(t,a){return Jmat.Complex.agm(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.ghm=function(t,a){return Jmat.Complex.ghm(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.isPrime=function(t){return Jmat.Complex.isPrime(Jmat.Complex.cast(t))},Jmat.smallestPrimeFactor=function(t){return Jmat.Complex(Jmat.Real.smallestPrimeFactor(Jmat.Real.cast(t)))},Jmat.factorize=function(t){for(var a=Jmat.Real.factorize(Jmat.Real.caststrict(t)),r=0;r<a.length;r++)a[r]=Jmat.Complex(a[r]);return a},Jmat.eulerTotient=function(t){return Jmat.Complex(Jmat.Real.eulerTotient(Jmat.Real.caststrict(t)))},Jmat.primeCount=function(t){return Jmat.Complex(Jmat.Real.primeCount(Jmat.Real.caststrict(t)))},Jmat.nearestPrime=function(t){return Jmat.Complex(Jmat.Real.nearestPrime(Jmat.Real.cast(t)))},Jmat.nextPrime=function(t){return Jmat.Complex(Jmat.Real.nextPrime(Jmat.Real.cast(t)))},Jmat.previousPrime=function(t){return Jmat.Complex(Jmat.Real.previousPrime(Jmat.Real.cast(t)))},Jmat.gcd=function(t,a){return Jmat.Complex(Jmat.Real.gcd(Jmat.Real.caststrict(t),Jmat.Real.caststrict(a)))},Jmat.lcm=function(t,a){return Jmat.Complex(Jmat.Real.lcm(Jmat.Real.caststrict(t),Jmat.Real.caststrict(a)))},Jmat.dms=function(t){return Jmat.Complex(Jmat.Real.dms(Jmat.Real.caststrict(t)))},Jmat.dd=function(t){return Jmat.Complex(Jmat.Real.dd(Jmat.Real.caststrict(t)))},Jmat.bitneg=function(t){return Jmat.Complex.bitneg(Jmat.Complex.cast(t))},Jmat.bitand=function(t,a){return Jmat.Complex.bitand(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.bitor=function(t,a){return Jmat.Complex.bitor(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.bitxor=function(t,a){return Jmat.Complex.bitxor(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.lshift=function(t,a){return Jmat.Complex.lshift(Jmat.Complex.cast(t),Jmat.Real.caststrict(a))},Jmat.rshift=function(t,a){return Jmat.Complex.rshift(Jmat.Complex.cast(t),Jmat.Real.caststrict(a))},Jmat.mod=function(t,a){return Jmat.Complex.mod(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.rem=function(t,a){return Jmat.Complex.rem(Jmat.Complex.cast(t),Jmat.Complex.cast(a))},Jmat.wrap=function(t,a,r){return Jmat.Complex.wrap(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.clamp=function(t,a,r){return Jmat.Complex.clamp(Jmat.Complex.cast(t),Jmat.Complex.cast(a),Jmat.Complex.cast(r))},Jmat.minkowski=function(t){return Jmat.Complex.minkowski(Jmat.Complex.cast(t))},Jmat.lu=function(t){return Jmat.Matrix.lu(Jmat.Matrix.cast(t))},Jmat.qr=function(t){return Jmat.Matrix.qr(Jmat.Matrix.cast(t))},Jmat.svd=function(t){return Jmat.Matrix.svd(Jmat.Matrix.cast(t))},Jmat.eig=function(t){return Jmat.Matrix.eig(Jmat.Matrix.cast(t))},Jmat.pseudoinverse=function(t){return Jmat.Matrix.pseudoinverse(Jmat.Matrix.cast(t))},Jmat.determinant=function(t){return Jmat.Matrix.determinant(Jmat.Matrix.cast(t))},Jmat.transpose=function(t){return Jmat.Matrix.transpose(Jmat.Matrix.cast(t))},Jmat.transjugate=function(t){return Jmat.Matrix.transjugate(Jmat.Matrix.cast(t))},Jmat.trace=function(t){return Jmat.Matrix.trace(Jmat.Matrix.cast(t))},Jmat.rank=function(t){return Jmat.Matrix.rank(Jmat.Matrix.cast(t))},Jmat.adj=function(t){return Jmat.Matrix.adj(Jmat.Matrix.cast(t))},Jmat.fft=function(t){return Jmat.Matrix.fft(Jmat.Matrix.cast(t))},Jmat.ifft=function(t){return Jmat.Matrix.ifft(Jmat.Matrix.cast(t))},Jmat.solve=function(t,a){return Jmat.Matrix.solve(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a))},Jmat.dot=function(t,a){return Jmat.Matrix.dot(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a))},Jmat.cross=function(t,a){return Jmat.Matrix.cross(Jmat.Matrix.cast(t),Jmat.Matrix.cast(a))},Jmat.minor=function(t,a,r){return Jmat.Matrix.minor(Jmat.Matrix.cast(t),Jmat.Real.caststrict(a),Jmat.Real.caststrict(r))},Jmat.cofactor=function(t,a,r){return Jmat.Matrix.cofactor(Jmat.Matrix.cast(t),Jmat.Real.caststrict(a),Jmat.Real.caststrict(r))},Jmat.submatrix=function(t,a,r,e,m){return Jmat.Matrix.submatrix(Jmat.Matrix.cast(t),Jmat.Real.caststrict(a),Jmat.Real.caststrict(r),Jmat.Real.caststrict(e),Jmat.Real.caststrict(m))},Jmat.svd=function(t){return Jmat.Matrix.svd(Jmat.Matrix.cast(t))},Jmat.evd=function(t){return Jmat.Matrix.evd(Jmat.Matrix.cast(t))},Jmat.qr=function(t){return Jmat.Matrix.qr(Jmat.Matrix.cast(t))},Jmat.norm=function(t){return Jmat.Matrix.norm(Jmat.Matrix.cast(t))},Jmat.norm2=function(t){return Jmat.Matrix.norm2(Jmat.Matrix.cast(t))},Jmat.maxcolnorm=function(t){return Jmat.Matrix.maxcolnorm(Jmat.Matrix.cast(t))},Jmat.maxrownorm=function(t){return Jmat.Matrix.maxrownorm(Jmat.Matrix.cast(t))},Jmat.differentiate=function(t,a){return Jmat.Complex.differentiate(Jmat.Complex.cast(t),a)},Jmat.integrate=function(t,a,r,e){return Jmat.Complex.integrate(Jmat.Complex.cast(t),Jmat.Complex.cast(a),r,Jmat.Real.caststrict(e))},Jmat.rootfind_newton=function(t,a,r,e){return Jmat.Complex.rootfind_newton(t,a,Jmat.Complex.cast(r),Jmat.Real.caststrict(e))},Jmat.rootfind_newton_noderiv=function(t,a,r){return Jmat.Complex.rootfind_newton_noderiv(t,Jmat.Complex.cast(a),Jmat.Real.caststrict(r))},Jmat.matrixIn_=function(t){return t?"string"==typeof t?t.length<2?!1:"["==t[0]?!0:"-"==t[0]?!1:t.charCodeAt(0)>=48&&t.charCodeAt(0)<=57?!1:-1!=t.indexOf("["):t&&(t instanceof Jmat.Matrix||void 0!=t.length):!1},Jmat.quaternionIn_=function(t){return t?"string"==typeof t&&(t.indexOf("j")>=0||t.indexOf("k")>=0)?!0:t&&t instanceof Jmat.Quaternion:!1},Jmat.bigIntIn_=function(t){return t?"string"==typeof t&&t.length>16&&-1==t.indexOf(".")&&-1==t.indexOf("e")&&-1==t.indexOf("E")?!0:t&&t instanceof Jmat.BigInt:!1},Jmat.toString_=function(t,a,r){if(!t)return""+t;var e="";if(a&&t.render)return"\n"+t.render(r);if("object"==typeof t&&Array.isArray(t)){e+="[";for(var m=0;m<t.length;m++)e+=Jmat.toString_(t[m],a,r)+(m+1==t.length?"":", ");return e+="]"}if(t.constructor==Object){e+="{";var n=!1;for(var i in t)i&&t[i]&&(n&&(e+=", "),e+=i+": ",e+=Jmat.toString_(t[i],a,r),n=!0);return e+="}"}return e=a&&t.render?"\n"+t.render(r):t.toString?t.toString(r):""+t},Jmat.toString=function(t){return Jmat.toString_(t,!1)},Jmat.render=function(t,a){return Jmat.toString_(t,!0,a)};var Real=Jmat.Real,Complex=Jmat.Complex,Matrix=Jmat.Matrix,BigInt=Jmat.BigIntC||Jmat.BigInt,Quaternion=Jmat.Quaternion;["gamma","factorial","lambertw","erf","erfc"].map(function(t){Math[t]||(Math[t]=Jmat.Real[t])}),["sinh","cosh","tanh","asinh","acosh","atanh","clz32","log2","log10","log1p","expm1"].map(function(t){Math[t]||(Math[t]=Jmat.Real[t])});
//# sourceMappingURL=jmat.map
